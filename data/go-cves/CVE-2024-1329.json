{
  "schema_version": "1.6.3",
  "id": "CVE-2024-1329",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-04T17:42:30Z",
  "aliases": [
    "GHSA-c866-8gpw-p3mv",
    "GO-2024-2538"
  ],
  "related": [],
  "summary": "Symlink attack in github.com/hashicorp/nomad. HashiCorp Nomad and Nomad Enterprise 1.5.13 up to 1.6.6, and 1.7.3 template renderer is vulnerable to arbitrary file write on the host as the Nomad client user through symlink attacks. Fixed in Nomad 1.7.4, 1.6.7, 1.5.14. HashiCorp Nomad y Nomad Enterprise 1.5.13 hasta 1.6.6 y 1.7.3 el renderizador de plantillas es vulnerable a la escritura de archivos arbitrarios en el host como usuario del cliente Nomad a través de ataques de enlaces simbólicos. Corregido en Nomad 1.7.4, 1.6.7, 1.5.14",
  "details": "Symlink attack in github.com/hashicorp/nomad",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/hashicorp/nomad"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.5.13"
            },
            {
              "fixed": "1.5.14"
            },
            {
              "introduced": "1.6.0"
            },
            {
              "fixed": "1.6.7"
            },
            {
              "introduced": "1.7.3"
            },
            {
              "fixed": "1.7.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/hashicorp/nomad/helper/escapingfs",
            "symbols": [
              "PathEscapesAllocDir",
              "pathEscapesBaseViaSymlink"
            ]
          },
          {
            "path": "github.com/hashicorp/nomad/client/allocwatcher",
            "symbols": [
              "remotePrevAlloc.Migrate",
              "remotePrevAlloc.migrateAllocDir",
              "remotePrevAlloc.streamAllocDir"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-1329"
    },
    {
      "type": "REPORT",
      "url": "https://github.com/hashicorp/nomad/issues/19888"
    },
    {
      "type": "FIX",
      "url": "https://github.com/hashicorp/nomad/commit/b3209cbc6921e703b0e9984ce70c10b378665834"
    },
    {
      "type": "FIX",
      "url": "https://github.com/hashicorp/nomad/commit/d1721c7a6fc1833778086603f818a822a34f445a"
    },
    {
      "type": "FIX",
      "url": "https://github.com/hashicorp/nomad/commit/de55da677a21ac7572c0f4a8cd9abd5473c47a70"
    },
    {
      "type": "WEB",
      "url": "https://discuss.hashicorp.com/t/hcsec-2024-03-nomad-vulnerable-to-arbitrary-write-through-symlink-attack"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security@hashicorp.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.7,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.3,
          "impactScore": 5.8
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-610",
        "url": ""
      },
      {
        "cwe_id": "security@hashicorp.com",
        "name": "Secondary",
        "description": "CWE-610",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/hashicorp/nomad",
        "name": "hashicorp/nomad",
        "description": "Nomad is an easy-to-use, flexible, and performant workload orchestrator that can deploy a mix of microservice, batch, containerized, and non-containerized applications. Nomad is easy to operate and scale and has native Consul and Vault integrations.",
        "date_created": "2015-06-01T10:21:00Z",
        "date_last_push": "2024-06-14T09:37:18Z",
        "owner": "hashicorp",
        "forks_count": "1913",
        "stars_count": "14515",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/hashicorp/nomad",
        "name": "hashicorp/nomad",
        "description": "Nomad is an easy-to-use, flexible, and performant workload orchestrator that can deploy a mix of microservice, batch, containerized, and non-containerized applications. Nomad is easy to operate and scale and has native Consul and Vault integrations.",
        "date_created": "2015-06-01T10:21:00Z",
        "date_last_push": "2024-06-14T09:37:18Z",
        "owner": "hashicorp",
        "forks_count": "1913",
        "stars_count": "14515",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/hashicorp/nomad",
        "name": "hashicorp/nomad",
        "description": "Nomad is an easy-to-use, flexible, and performant workload orchestrator that can deploy a mix of microservice, batch, containerized, and non-containerized applications. Nomad is easy to operate and scale and has native Consul and Vault integrations.",
        "date_created": "2015-06-01T10:21:00Z",
        "date_last_push": "2024-06-14T09:37:18Z",
        "owner": "hashicorp",
        "forks_count": "1913",
        "stars_count": "14515",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:nomad:*:*:*:*:-:*:*:*",
            "matchCriteriaId": "14F75343-9DC2-4C28-A571-7AC0BAEEA00A",
            "versionStartIncluding": "1.5.13",
            "versionEndExcluding": "1.5.14"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:nomad:*:*:*:*:-:*:*:*",
            "matchCriteriaId": "EC3377A1-FBDE-4E23-8F8F-E4520F594A8D",
            "versionStartIncluding": "1.6.6",
            "versionEndExcluding": "1.6.7"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:nomad:*:*:*:*:-:*:*:*",
            "matchCriteriaId": "EF7459A5-A515-478C-AC04-51674B63357B",
            "versionStartIncluding": "1.7.3.",
            "versionEndExcluding": "1.7.4"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:nomad:*:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "AC798750-00B8-446C-8ABC-104F4BCF4C77",
            "versionStartIncluding": "1.5.13",
            "versionEndExcluding": "1.5.14"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:nomad:*:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "34BF7182-EA1A-4C8E-9C90-3F03A177E6DF",
            "versionStartIncluding": "1.6.6",
            "versionEndExcluding": "1.6.7"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:nomad:*:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "E250A18C-5782-45C8-867C-477719DDA393",
            "versionStartIncluding": "1.7.3.",
            "versionEndExcluding": "1.7.4"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2538",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}