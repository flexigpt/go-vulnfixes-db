{
  "schema_version": "1.6.3",
  "id": "CVE-2022-41724",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-02-16T22:24:51Z",
  "aliases": [
    "GO-2023-1570"
  ],
  "related": [],
  "summary": "Panic on large handshake records in crypto/tls. Large handshake records may cause panics in crypto/tls. Both clients and servers may send large TLS handshake records which cause servers and clients, respectively, to panic when attempting to construct responses. This affects all TLS 1.3 clients, TLS 1.2 clients which explicitly enable session resumption (by setting Config.ClientSessionCache to a non-nil value), and TLS 1.3 servers which request client certificates (by setting Config.ClientAuth >= RequestClientCert)",
  "details": "Large handshake records may cause panics in crypto/tls.\n\nBoth clients and servers may send large TLS handshake records which cause servers and clients, respectively, to panic when attempting to construct responses.\n\nThis affects all TLS 1.3 clients, TLS 1.2 clients which explicitly enable session resumption (by setting Config.ClientSessionCache to a non-nil value), and TLS 1.3 servers which request client certificates (by setting Config.ClientAuth >= RequestClientCert)",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "stdlib"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.19.6"
            },
            {
              "introduced": "1.20.0-0"
            },
            {
              "fixed": "1.20.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "crypto/tls",
            "symbols": [
              "Conn.Handshake",
              "Conn.HandshakeContext",
              "Conn.Read",
              "Conn.Write",
              "Conn.clientHandshake",
              "Conn.handleKeyUpdate",
              "Conn.handlePostHandshakeMessage",
              "Conn.handleRenegotiation",
              "Conn.loadSession",
              "Conn.readClientHello",
              "Conn.readHandshake",
              "Conn.writeRecord",
              "ConnectionState.ExportKeyingMaterial",
              "Dial",
              "DialWithDialer",
              "Dialer.Dial",
              "Dialer.DialContext",
              "certificateMsg.marshal",
              "certificateMsgTLS13.marshal",
              "certificateRequestMsg.marshal",
              "certificateRequestMsgTLS13.marshal",
              "certificateStatusMsg.marshal",
              "certificateVerifyMsg.marshal",
              "cipherSuiteTLS13.expandLabel",
              "clientHandshakeState.doFullHandshake",
              "clientHandshakeState.handshake",
              "clientHandshakeState.readFinished",
              "clientHandshakeState.readSessionTicket",
              "clientHandshakeState.sendFinished",
              "clientHandshakeStateTLS13.handshake",
              "clientHandshakeStateTLS13.processHelloRetryRequest",
              "clientHandshakeStateTLS13.readServerCertificate",
              "clientHandshakeStateTLS13.readServerFinished",
              "clientHandshakeStateTLS13.readServerParameters",
              "clientHandshakeStateTLS13.sendClientCertificate",
              "clientHandshakeStateTLS13.sendClientFinished",
              "clientHandshakeStateTLS13.sendDummyChangeCipherSpec",
              "clientHelloMsg.marshal",
              "clientHelloMsg.marshalWithoutBinders",
              "clientHelloMsg.updateBinders",
              "clientKeyExchangeMsg.marshal",
              "encryptedExtensionsMsg.marshal",
              "endOfEarlyDataMsg.marshal",
              "finishedMsg.marshal",
              "handshakeMessage.marshal",
              "helloRequestMsg.marshal",
              "keyUpdateMsg.marshal",
              "newSessionTicketMsg.marshal",
              "newSessionTicketMsgTLS13.marshal",
              "serverHandshakeState.doFullHandshake",
              "serverHandshakeState.doResumeHandshake",
              "serverHandshakeState.readFinished",
              "serverHandshakeState.sendFinished",
              "serverHandshakeState.sendSessionTicket",
              "serverHandshakeStateTLS13.checkForResumption",
              "serverHandshakeStateTLS13.doHelloRetryRequest",
              "serverHandshakeStateTLS13.readClientCertificate",
              "serverHandshakeStateTLS13.readClientFinished",
              "serverHandshakeStateTLS13.sendDummyChangeCipherSpec",
              "serverHandshakeStateTLS13.sendServerCertificate",
              "serverHandshakeStateTLS13.sendServerFinished",
              "serverHandshakeStateTLS13.sendServerParameters",
              "serverHandshakeStateTLS13.sendSessionTickets",
              "serverHelloDoneMsg.marshal",
              "serverHelloMsg.marshal",
              "serverKeyExchangeMsg.marshal",
              "sessionState.marshal",
              "sessionStateTLS13.marshal"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://go.dev/issue/58001"
    },
    {
      "type": "WEB",
      "url": "https://go.dev/cl/468125"
    },
    {
      "type": "WEB",
      "url": "https://groups.google.com/g/golang-announce/c/V0aBFqaFs_E"
    },
    {
      "type": "WEB",
      "url": "https://pkg.go.dev/vuln/GO-2023-1570"
    },
    {
      "type": "WEB",
      "url": "https://security.gentoo.org/glsa/202311-09"
    }
  ],
  "credits": [
    {
      "name": "Marten Seemann"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-400",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "2219CF76-6D17-487E-9B67-BC49E4743528",
            "versionEndExcluding": "1.19.6"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.20.0:-:*:*:*:*:*:*",
            "matchCriteriaId": "B78574DF-045C-4A26-B0F5-8C082B24D9FD"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.20.0:rc1:*:*:*:*:*:*",
            "matchCriteriaId": "1A10A0A9-4C2C-42FF-AB8C-52D023BE1445"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.20.0:rc2:*:*:*:*:*:*",
            "matchCriteriaId": "AE127A27-C103-4F60-AE36-8AF1C92ADEA9"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.20.0:rc3:*:*:*:*:*:*",
            "matchCriteriaId": "E40BF33F-3AE7-4CF3-8E29-E92B94243CFA"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-1570",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}