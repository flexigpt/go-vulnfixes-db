{
  "schema_version": "1.6.3",
  "id": "CVE-2023-32698",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-06-01T21:27:40Z",
  "aliases": [
    "GHSA-w7jw-q4fg-qc4c",
    "GO-2023-1788"
  ],
  "related": [],
  "summary": "Incorrect permissions in github.com/goreleaser/nfpm/v2. nFPM is an alternative to fpm. The file permissions on the checked-in files were not maintained. Hence, when nfpm packaged \nthe files (without extra config for enforcing it’s own permissions) files could go out with bad permissions (chmod 666 or 777). Anyone using nfpm for creating packages without checking/setting file permissions before packaging could result in bad permissions for files/folders. nFPM es una alternativa a fpm. Los permisos de los archivos registrados no se mantenían. Por lo tanto, cuando nfpm empaquetaba los archivos (sin configuración adicional para hacer cumplir sus propios permisos) los archivos podían salir con permisos incorrectos (chmod 666 o 777). Cualquiera que utilice nfpm para crear paquetes sin comprobar/configurar los permisos de los archivos antes de empaquetarlos podría dar lugar a permisos incorrectos para los archivos/carpetas",
  "details": "When nfpm packages files without additional configuration to enforce its own permissions, the files could be packaged with incorrect permissions (chmod 666 or 777). Anyone who uses nfpm to create packages and does not check or set file permissions before packaging could result in files or folders being packaged with incorrect permissions",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.1"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/goreleaser/nfpm/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.0.0"
            },
            {
              "fixed": "2.29.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/goreleaser/nfpm/v2",
            "symbols": [
              "Config.Validate",
              "Info.Validate",
              "Parse",
              "ParseFile",
              "ParseFileWithEnvMapping",
              "ParseWithEnvMapping",
              "PrepareForPackager",
              "Validate",
              "WithDefaults"
            ]
          },
          {
            "path": "github.com/goreleaser/nfpm/v2/files",
            "symbols": [
              "Content.WithFileInfoDefaults",
              "PrepareForPackager",
              "addGlobbedFiles",
              "addTree"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/goreleaser/nfpm/commit/ed9abdf63d5012cc884f2a83b4ab2b42b3680d30"
    },
    {
      "type": "WEB",
      "url": "https://github.com/goreleaser/nfpm/releases/tag/v2.29.0"
    },
    {
      "type": "ADVISORY",
      "url": "https://github.com/advisories/GHSA-w7jw-q4fg-qc4c"
    },
    {
      "type": "WEB",
      "url": "https://github.com/goreleaser/nfpm/security/advisories/GHSA-w7jw-q4fg-qc4c"
    }
  ],
  "credits": [
    {
      "name": "oCHRISo"
    },
    {
      "name": "caarlos0"
    },
    {
      "name": "djgilcrease"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 5.2
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 5.2
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-276",
        "url": ""
      },
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-276",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/goreleaser/nfpm",
        "name": "goreleaser/nfpm",
        "description": "nFPM is Not FPM - a simple deb, rpm, apk and arch linux packager written in Go",
        "date_created": "2018-01-04T12:49:38Z",
        "date_last_push": "2024-06-13T17:35:59Z",
        "owner": "goreleaser",
        "forks_count": "153",
        "stars_count": "2079",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:goreleaser:nfpm:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "325B45DF-6615-4FC7-B712-4A80B0661905",
            "versionStartIncluding": "0.1.0",
            "versionEndExcluding": "2.29.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-1788",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}