{
  "schema_version": "1.6.3",
  "id": "CVE-2024-27918",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-11T19:00:01Z",
  "aliases": [
    "GO-2024-2602",
    "GHSA-7cc2-r658-7xpf"
  ],
  "related": [],
  "summary": "Incorrect email domain verification in github.com/coder/coder. Coder allows oragnizations to provision remote development environments via Terraform. Prior to versions 2.6.1, 2.7.3, and 2.8.4, a vulnerability in Coder's OIDC authentication could allow an attacker to bypass the `CODER_OIDC_EMAIL_DOMAIN` verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider. During OIDC registration, the user's email was improperly validated against the allowed `CODER_OIDC_EMAIL_DOMAIN`s. This could allow a user with a domain that only partially matched an allowed domain to successfully login or register. An attacker could register a domain name that exploited this vulnerability and register on a Coder instance with a public OIDC provider.\n\nCoder instances with OIDC enabled and protected by the `CODER_OIDC_EMAIL_DOMAIN` configuration are affected. Coder instances using a private OIDC provider are not affected, as arbitrary users cannot register through a private OIDC provider without first having an account on the provider. Public OIDC providers are impacted. GitHub authentication and external authentication are not impacted. This vulnerability is remedied in versions 2.8.4, 2.7.3, and 2.6.1 All versions prior to these patches are affected by the vulnerability.*It is recommended that customers upgrade their deployments as soon as possible if they are utilizing OIDC authentication with the `CODER_OIDC_EMAIL_DOMAIN` setting. Coder permite a las organizaciones aprovisionar entornos de desarrollo remotos a través de Terraform. Antes de las versiones 2.6.1, 2.7.3 y 2.8.4, una vulnerabilidad en la autenticación OIDC de Coder podía permitir a un atacante eludir la verificación `CODER_OIDC_EMAIL_DOMAIN` y crear una cuenta con un correo electrónico que no estaba en la lista de permitidos. Las implementaciones solo se ven afectadas si el proveedor de OIDC permite a los usuarios crear cuentas en el proveedor. Durante el registro de OIDC, el correo electrónico del usuario se validó incorrectamente con los `CODER_OIDC_EMAIL_DOMAIN`s permitidos. Esto podría permitir que un usuario con un dominio que solo coincidiera parcialmente con un dominio permitido inicie sesión o se registre exitosamente. Un atacante podría registrar un nombre de dominio que explotara esta vulnerabilidad y registrarse en una instancia de Coder con un proveedor público de OIDC. Las instancias de Coder con OIDC habilitado y protegido por la configuración `CODER_OIDC_EMAIL_DOMAIN` se ven afectadas. Las instancias de Coder que utilizan un proveedor OIDC privado no se ven afectadas, ya que los usuarios arbitrarios no pueden registrarse a través de un proveedor OIDC privado sin tener primero una cuenta en el proveedor. Los proveedores públicos de OIDC se ven afectados. La autenticación de GitHub y la autenticación externa no se ven afectadas. Esta vulnerabilidad se soluciona en las versiones 2.8.4, 2.7.3 y 2.6.1. Todas las versiones anteriores a estos parches se ven afectadas por la vulnerabilidad. *Se recomienda que los clientes actualicen sus implementaciones lo antes posible si utilizan autenticación OIDC con la configuración `CODER_OIDC_EMAIL_DOMAIN`",
  "details": "A vulnerability in Coder's OIDC authentication could allow an attacker to bypass the CODER_OIDC_EMAIL_DOMAIN verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider (such as public providers like google.com). During OIDC registration, the user's email was improperly validated against the allowed CODER_OIDC_EMAIL_DOMAINs",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "8.2"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/coder/coder"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/coder/coder/coderd",
            "symbols": [
              "API.New",
              "Api.userOIDC"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/coder/coder/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.6.1"
            },
            {
              "introduced": "2.7.0"
            },
            {
              "fixed": "2.7.3"
            },
            {
              "introduced": "2.8.0"
            },
            {
              "fixed": "2.8.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/coder/coder/v2/coderd",
            "symbols": [
              "Api.New",
              "Api.userOIDC"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf"
    },
    {
      "type": "WEB",
      "url": "https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0"
    },
    {
      "type": "WEB",
      "url": "https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31"
    },
    {
      "type": "WEB",
      "url": "https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb"
    },
    {
      "type": "WEB",
      "url": "https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c"
    }
  ],
  "credits": [
    {
      "name": "arcz"
    },
    {
      "name": "maxammann"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 8.2,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 4.2
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-20",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/coder/coder",
        "name": "coder/coder",
        "description": "Provision remote development environments via Terraform",
        "date_created": "2021-12-22T06:08:52Z",
        "date_last_push": "2024-06-24T08:12:45Z",
        "owner": "coder",
        "forks_count": "590",
        "stars_count": "7298",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/coder/coder",
        "name": "coder/coder",
        "description": "Provision remote development environments via Terraform",
        "date_created": "2021-12-22T06:08:52Z",
        "date_last_push": "2024-06-24T08:12:45Z",
        "owner": "coder",
        "forks_count": "590",
        "stars_count": "7298",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/coder/coder",
        "name": "coder/coder",
        "description": "Provision remote development environments via Terraform",
        "date_created": "2021-12-22T06:08:52Z",
        "date_last_push": "2024-06-24T08:12:45Z",
        "owner": "coder",
        "forks_count": "590",
        "stars_count": "7298",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/coder/coder",
        "name": "coder/coder",
        "description": "Provision remote development environments via Terraform",
        "date_created": "2021-12-22T06:08:52Z",
        "date_last_push": "2024-06-24T08:12:45Z",
        "owner": "coder",
        "forks_count": "590",
        "stars_count": "7298",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2602",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}