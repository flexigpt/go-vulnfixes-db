{
  "schema_version": "1.6.3",
  "id": "CVE-2018-6558",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-04-14T20:04:52Z",
  "aliases": [
    "GHSA-qj26-7grj-whg3",
    "GO-2020-0027"
  ],
  "related": [],
  "summary": "Privilege escalation in github.com/google/fscrypt. The pam_fscrypt module in fscrypt before 0.2.4 may incorrectly restore primary and supplementary group IDs to the values associated with the root user, which allows attackers to gain privileges via a successful login through certain applications that use Linux-PAM (aka pam). El módulo pam_fscrypt en fscrypt en versiones anteriores a la 0.2.4 podría restaurar incorrectamente los ID de los grupos primarios y suplementarios a los valores asociados con el usuario root, lo que permite que los atacantes obtengan privilegios mediante un inicio de sesión con éxito a través de determinadas aplicaciones que utilicen Linux-PAM (también conocido como pam). NVD-CWE-noinfo",
  "details": "After dropping and then elevating process privileges euid, guid, and groups are not properly restored to their original values, allowing an unprivileged user to gain membership in the root group. The pam_fscrypt module in fscrypt before 0.2.4 may incorrectly restore primary and supplementary group IDs to the values associated with the root user, which allows attackers to gain privileges via a successful login through certain applications that use Linux-PAM (aka pam)",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.9"
    },
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "google/fscrypt",
        "purl": "https://github.com/google/fscrypt"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "fixed": "0.2.4"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/google/fscrypt/commit/3022c1603d968c22f147b4a2c49c4637dd1be91b"
    },
    {
      "type": "WEB",
      "url": "https://github.com/google/fscrypt/issues/77"
    },
    {
      "type": "WEB",
      "url": "https://github.com/google/fscrypt/commit/315f9b042237200174a1fb99427f74027e191d66"
    },
    {
      "type": "WEB",
      "url": "https://launchpad.net/bugs/1787548"
    }
  ],
  "credits": [
    {
      "name": "Joe Richey joerichey@google.com",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV30": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "SINGLE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 4.9
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 6.8,
          "impactScore": 4.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "NVD-CWE-noinfo",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/google/fscrypt",
        "name": "google/fscrypt",
        "description": "Go tool for managing Linux filesystem encryption",
        "date_created": "2017-07-12 17:52:15",
        "date_last_push": "2022-08-27 08:18:20",
        "owner": "google",
        "forks_count": "96.0",
        "stars_count": "689.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:google:fscrypt:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "80891EB5-205B-4BB3-8BEA-589FD0B5CDB3",
            "versionEndExcluding": "0.2.4"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2020-0027",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}