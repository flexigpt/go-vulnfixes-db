{
  "schema_version": "1.6.3",
  "id": "CVE-2019-11939",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-04-14T20:04:52Z",
  "aliases": [
    "GHSA-w3r9-r9w7-8h48",
    "GO-2021-0082"
  ],
  "related": [],
  "summary": "Denial of service via malicious message size declaration in github.com/facebook/fbthrift. Golang Facebook Thrift servers would not error upon receiving messages declaring containers of sizes larger than the payload. As a result, malicious clients could send short messages which would result in a large memory allocation, potentially leading to denial of service. This issue affects Facebook Thrift prior to v2020.03.16.00. Los servidores de Golang Facebook Thrift, no se equivocarían tras recibir mensajes declarando contenedores de tamaños más grandes que la carga útil. Como resultado, unos clientes maliciosos podrían enviar mensajes cortos que resultaría en una asignación de memoria considerable, conllevando potencialmente a una denegación de servicio. Este problema afecta a Facebook Thrift versiones anteriores a v2020.03.16.00. CWE-770",
  "details": "Thrift Servers preallocate memory for the declared size of messages before checking the actual size of the message. This allows a malicious user to send messages that declare that they are significantly larger than they actually are, allowing them to force the server to allocate significant amounts of memory. This can be used as a denial of service vector. Golang Facebook Thrift servers would not error upon receiving messages declaring containers of sizes larger than the payload. As a result, malicious clients could send short messages which would result in a large memory allocation, potentially leading to denial of service. This issue affects Facebook Thrift prior to v2020.03.16.00",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "5.0"
    },
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "facebook/fbthrift",
        "purl": "https://github.com/facebook/fbthrift"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "fixed": "2020.03.16.00"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/facebook/fbthrift/commit/483ed864d69f307e9e3b9dadec048216100c0757"
    },
    {
      "type": "WEB",
      "url": "https://www.facebook.com/security/advisories/cve-2019-11939"
    }
  ],
  "credits": [
    {
      "name": "Alexandre Fiori",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "PARTIAL",
            "baseScore": 5.0
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 10.0,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-770",
        "url": ""
      },
      {
        "cwe_id": "cve-assign@fb.com",
        "name": "Secondary",
        "description": "CWE-770",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/facebook/fbthrift",
        "name": "facebook/fbthrift",
        "description": "Facebook's branch of Apache Thrift, including a new C++ server.",
        "date_created": "2013-07-02 18:15:51",
        "date_last_push": "2022-08-27 07:00:25",
        "owner": "facebook",
        "forks_count": "579.0",
        "stars_count": "2358.0",
        "repo_language": "C++"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:facebook:thrift:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "8F515B67-2776-4C97-BBC3-47DEAEC6ACDC",
            "versionEndExcluding": "2020.03.16.00"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0082",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}