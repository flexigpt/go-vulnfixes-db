{
  "schema_version": "1.6.3",
  "id": "CVE-2023-45128",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-10-24T16:57:01Z",
  "aliases": [
    "GO-2023-2115",
    "GHSA-94w9-97p3-p368"
  ],
  "related": [],
  "summary": "CSRF token reuse vulnerability in github.com/gofiber/fiber/v2. Fiber is an express inspired web framework written in Go. A Cross-Site Request Forgery (CSRF) vulnerability has been identified in the application, which allows an attacker to inject arbitrary values and forge malicious requests on behalf of a user. This vulnerability can allow an attacker to inject arbitrary values without any authentication, or perform various malicious actions on behalf of an authenticated user, potentially compromising the security and integrity of the application. The vulnerability is caused by improper validation and enforcement of CSRF tokens within the application. This issue has been addressed in version 2.50.0 and users are advised to upgrade. Users should take additional security measures like captchas or Two-Factor Authentication (2FA) and set Session cookies with SameSite=Lax or SameSite=Secure, and the Secure and HttpOnly attributes as defense in depth measures. There are no known workarounds for this vulnerability. Fiber es un framework web inspirado en Express escrito en Go. Se ha identificado una vulnerabilidad de Cross-Site Request Forgery (CSRF) en la aplicación, que permite a un atacante inyectar valores arbitrarios y falsificar solicitudes maliciosas en nombre de un usuario. Esta vulnerabilidad puede permitir a un atacante inyectar valores arbitrarios sin ninguna autenticación o realizar diversas acciones maliciosas en nombre de un usuario autenticado, comprometiendo potencialmente la seguridad y la integridad de la aplicación. La vulnerabilidad se debe a una validación y aplicación inadecuadas de los tokens CSRF dentro de la aplicación. Este problema se solucionó en la versión 2.50.0 y se recomienda a los usuarios que actualicen. Los usuarios deben tomar medidas de seguridad adicionales como captchas o autenticación de dos factores (2FA) y configurar cookies de sesión con SameSite=Lax o SameSite=Secure, y los atributos Secure y HttpOnly como medidas de defensa en profundidad. No se conocen workarounds para esta vulnerabilidad",
  "details": "A cross-site request forgery vulnerability in this package can allow an attacker to inject arbitrary values and forge malicious requests on behalf of a user. The attacker may inject arbitrary values without any authentication, or perform various malicious actions on behalf of an authenticated user, potentially compromising the security and integrity of the application.\n\nThe vulnerability is caused by improper validation and enforcement of CSRF tokens within the application. For 'safe' methods, the token is extracted from the cookie and saved to storage without further validation or sanitization. In addition, the CSRF token is validated against tokens in storage but not associated with a session, nor by using a Double Submit Cookie Method, allowing for token reuse",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "8.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/gofiber/fiber/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.50.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/gofiber/fiber/v2/middleware/csrf",
            "symbols": [
              "CsrfFromCookie",
              "CsrfFromForm",
              "CsrfFromHeader",
              "CsrfFromParam",
              "CsrfFromQuery",
              "New",
              "configDefault",
              "manager.getRaw",
              "manager.setRaw",
              "newManager"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/gofiber/fiber/security/advisories/GHSA-94w9-97p3-p368"
    },
    {
      "type": "WEB",
      "url": "https://github.com/gofiber/fiber/commit/8c3916dbf4ad2ed427d02c6eb63ae8b2fa8f019a"
    },
    {
      "type": "FIX",
      "url": "https://github.com/gofiber/fiber/commit/b50d91d58ecdff2a330bf07950244b6c4caf65b1"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.9
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "LOW",
            "baseScore": 10.0,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 6.0
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-20 CWE-352 CWE-565 CWE-807",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/gofiber/fiber",
        "name": "gofiber/fiber",
        "description": "⚡️ Express inspired web framework written in Go",
        "date_created": "2020-01-16T03:59:20Z",
        "date_last_push": "2024-06-13T12:59:27Z",
        "owner": "gofiber",
        "forks_count": "1584",
        "stars_count": "31896",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/gofiber/fiber",
        "name": "gofiber/fiber",
        "description": "⚡️ Express inspired web framework written in Go",
        "date_created": "2020-01-16T03:59:20Z",
        "date_last_push": "2024-06-13T12:59:27Z",
        "owner": "gofiber",
        "forks_count": "1584",
        "stars_count": "31896",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:gofiber:fiber:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "D4CF7CB2-A259-42A1-A42F-26170DCC266D",
            "versionEndExcluding": "2.50.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2115",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}