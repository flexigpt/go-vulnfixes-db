{
  "schema_version": "1.6.3",
  "id": "CVE-2021-22133",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-05-18T18:34:18Z",
  "aliases": [
    "GO-2022-0706",
    "GHSA-qqc5-rgcc-cjqh"
  ],
  "related": [],
  "summary": "Information disclosure in go.elastic.co/apm. The Elastic APM agent for Go versions before 1.11.0 can leak sensitive HTTP header information when logging the details during an application panic. Normally, the APM agent will sanitize sensitive HTTP header details before sending the information to the APM server. During an application panic it is possible the headers will not be sanitized before being sent. El agente de Elastic APM para Go versiones anteriores a 1.11.0, puede filtrar información confidencial del encabezado HTTP al registrar los detalles durante un pánico en la aplicación.&#xa0;Normalmente, el agente de APM se saneará en los detalles del encabezado HTTP confidenciales antes de enviar la información al servidor de APM.&#xa0;Durante un pánico de aplicación, es posible que los encabezados no sean saneados antes de enviarse",
  "details": "Sensitive HTTP headers may not be properly sanitized before being sent to the APM server if the program panics",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "2.7"
    },
    {
      "type": "CVSS_V3",
      "score": "2.4"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "go.elastic.co/apm"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.11.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "go.elastic.co/apm",
            "symbols": [
              "NewTracer",
              "NewTracerOptions",
              "modelWriter.buildModelTransaction"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/elastic/apm-agent-go/pull/888"
    },
    {
      "type": "FIX",
      "url": "https://github.com/elastic/apm-agent-go/commit/dd3e8c593580e7b80a98b57e1cc6e017e56747b4"
    },
    {
      "type": "WEB",
      "url": "https://discuss.elastic.co/t/elastic-apm-agent-for-go-1-11-0-security-update/263252"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N",
            "attackVector": "ADJACENT_NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 2.4,
            "baseSeverity": "LOW"
          },
          "exploitabilityScore": 0.9,
          "impactScore": 1.4
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:A/AC:L/Au:S/C:P/I:N/A:N",
            "accessVector": "ADJACENT_NETWORK",
            "accessComplexity": "LOW",
            "authentication": "SINGLE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 2.7
          },
          "baseSeverity": "LOW",
          "exploitabilityScore": 5.1,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-532",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-532",
        "name": "Secondary",
        "description": "",
        "source": "bressers@elastic.co",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/elastic/apm-agent-go",
        "name": "elastic/apm-agent-go",
        "date_created": "2018-02-16T03:39:33Z",
        "date_last_push": "2024-06-04T16:31:24Z",
        "owner": "elastic",
        "forks_count": "190",
        "stars_count": "413",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:elastic:apm_agent:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "8220CFD2-D742-4E7B-9B2E-26A5FD413453",
            "versionEndExcluding": "1.11.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0706",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}