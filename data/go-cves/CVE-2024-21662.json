{
  "schema_version": "1.6.3",
  "id": "CVE-2024-21662",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-22T17:31:17Z",
  "aliases": [
    "CVE-2024-21652",
    "GHSA-2vgg-9h6w-m454",
    "GHSA-x32m-mvfj-52xv",
    "GO-2024-2652"
  ],
  "related": [],
  "summary": "Brute force protection bypass in github.com/argoproj/argo-cd/v2. Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Prior to versions 2.8.13, 2.9.9, and 2.10.4, an attacker can effectively bypass the rate limit and brute force protections by exploiting the application's weak cache-based mechanism. This loophole in security can be combined with other vulnerabilities to attack the default admin account. This flaw undermines a patch for CVE-2020-8827 intended to protect against brute-force attacks. The application's brute force protection relies on a cache mechanism that tracks login attempts for each user. This cache is limited to a `defaultMaxCacheSize` of 1000 entries. An attacker can overflow this cache by bombarding it with login attempts for different users, thereby pushing out the admin account's failed attempts and effectively resetting the rate limit for that account. This is a severe vulnerability that enables attackers to perform brute force attacks at an accelerated rate, especially targeting the default admin account. Users should upgrade to version 2.8.13, 2.9.9, or 2.10.4 to receive a patch. Argo CD es una herramienta declarativa de entrega continua de GitOps para Kubernetes. Antes de las versiones 2.8.13, 2.9.9 y 2.10.4, un atacante podía eludir eficazmente el límite de velocidad y las protecciones de fuerza bruta explotando el débil mecanismo basado en caché de la aplicación. Esta laguna de seguridad se puede combinar con otras vulnerabilidades para atacar la cuenta de administrador predeterminada. Esta falla socava un parche para CVE-2020-8827 destinado a proteger contra ataques de fuerza bruta. La protección de fuerza bruta de la aplicación se basa en un mecanismo de caché que rastrea los intentos de inicio de sesión de cada usuario. Este caché está limitado a un `defaultMaxCacheSize` de 1000 entradas. Un atacante puede desbordar este caché bombardeándolo con intentos de inicio de sesión para diferentes usuarios, eliminando así los intentos fallidos de la cuenta de administrador y restableciendo efectivamente el límite de velocidad para esa cuenta. Se trata de una vulnerabilidad grave que permite a los atacantes realizar ataques de fuerza bruta a un ritmo acelerado, especialmente dirigidos a la cuenta de administrador predeterminada. Los usuarios deben actualizar a la versión 2.8.13, 2.9.9 o 2.10.4 para recibir un parche",
  "details": "An attacker can effectively bypass the rate limit and brute force protections in Argo CD by exploiting the application's weak cache-based mechanism. The application's brute force protection relies on a cache mechanism that tracks login attempts for each user. An attacker can overflow this cache by bombarding it with login attempts for different users, thereby pushing out the admin account's failed attempts and effectively resetting the rate limit for that account",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.8.13"
            },
            {
              "introduced": "2.9.0"
            },
            {
              "fixed": "2.9.9"
            },
            {
              "introduced": "2.10.0"
            },
            {
              "fixed": "2.10.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/argoproj/argo-cd/v2/util/session",
            "symbols": [
              "SessionManager.VerifyUsernamePassword",
              "SessionManager.updateFailureCount",
              "getMaximumCacheSize"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/17b0df1168a4c535f6f37e95f25ed7cd81e1fa4d"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/6e181d72b31522f886a2afa029d5b26d7912ec7b"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/cebb6538f7944c87ca2fecb5d17f8baacc431456"
    },
    {
      "type": "WEB",
      "url": "https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-2vgg-9h6w-m454"
    }
  ],
  "credits": [
    {
      "name": "@nadava669"
    },
    {
      "name": "@pasha-codefresh"
    },
    {
      "name": "@crenshaw-dev"
    },
    {
      "name": "@todaywasawesome"
    },
    {
      "name": "@jannfis"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-307",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-14T10:52:15Z",
        "owner": "argoproj",
        "forks_count": "5014",
        "stars_count": "16555",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-14T10:52:15Z",
        "owner": "argoproj",
        "forks_count": "5014",
        "stars_count": "16555",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2652",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}