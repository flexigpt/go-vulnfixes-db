{
  "schema_version": "1.6.3",
  "id": "CVE-2022-29188",
  "modified": "2022-06-07T21:23:46.777000Z",
  "published": "2022-05-21T00:15:11.323000Z",
  "aliases": [],
  "related": [],
  "summary": "Smokescreen is an HTTP proxy. The primary use case for Smokescreen is to prevent server-side request forgery (SSRF) attacks in which external attackers leverage the behavior of applications to connect to or scan internal infrastructure. Smokescreen also offers an option to deny access to additional (e.g., external) URLs by way of a deny list. There was an issue in Smokescreen that made it possible to bypass the deny list feature by surrounding the hostname with square brackets (e.g. `[example.com]`). This only impacted the HTTP proxy functionality of Smokescreen. HTTPS requests were not impacted. Smokescreen version 0.0.4 contains a patch for this issue. Smokescreen es un proxy HTTP. El principal caso de uso de Smokescreen es evitar los ataques de tipo server-side request forgery (SSRF) en los que atacantes externos aprovechan el comportamiento de las aplicaciones para conectarse o explorar la infraestructura interna. Smokescreen también ofrece una opción para denegar el acceso a URLs adicionales (por ejemplo, externas) mediante una lista de denegación. Se presentaba un problema en Smokescreen que permitía omitir la función de lista de denegación rodeando el nombre de host con corchetes (por ejemplo, \"[ejemplo.com]\"). Esto sólo afectaba a la funcionalidad de proxy HTTP de Smokescreen. Las peticiones HTTPS no están afectadas. Smokescreen versión 0.0.4 contiene un parche para este problema. CWE-918",
  "details": "Smokescreen is an HTTP proxy. The primary use case for Smokescreen is to prevent server-side request forgery (SSRF) attacks in which external attackers leverage the behavior of applications to connect to or scan internal infrastructure. Smokescreen also offers an option to deny access to additional (e.g., external) URLs by way of a deny list. There was an issue in Smokescreen that made it possible to bypass the deny list feature by surrounding the hostname with square brackets (e.g. `[example.com]`). This only impacted the HTTP proxy functionality of Smokescreen. HTTPS requests were not impacted. Smokescreen version 0.0.4 contains a patch for this issue",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "6.4"
    },
    {
      "type": "CVSS_V3",
      "score": "5.3"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "stripe/smokescreen",
        "purl": "https://github.com/stripe/smokescreen"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "fixed": "0.0.4"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/stripe/smokescreen/commit/dea7b3c89df000f4072ff9866d61d78e30df6a36"
    },
    {
      "type": "WEB",
      "url": "https://github.com/stripe/smokescreen/security/advisories/GHSA-qwrf-gfpj-qvj6"
    }
  ],
  "credits": [
    {
      "name": "Jessica Jiang",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 2.5
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 6.4
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 10.0,
          "impactScore": 4.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-918",
        "name": "Primary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/stripe/smokescreen",
        "name": "stripe/smokescreen",
        "description": "A simple HTTP proxy that fogs over naughty URLs    ",
        "date_created": "2016-07-01 19:14:36",
        "date_last_push": "2022-08-26 20:40:08",
        "owner": "stripe",
        "forks_count": "45.0",
        "stars_count": "755.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:stripe:smokescreen:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "94FC7F9A-90E2-4C5A-AF7E-0946DCC695A5",
            "versionEndExcluding": "0.0.4"
          }
        ]
      }
    ],
    "datasources": {
      "govuln": false,
      "nvd": true,
      "cvefixes": true
    }
  }
}