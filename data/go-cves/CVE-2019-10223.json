{
  "schema_version": "1.6.3",
  "id": "CVE-2019-10223",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-05-18T15:38:54Z",
  "aliases": [
    "GO-2022-0621",
    "GHSA-2v6x-frw8-7r7f",
    "GHSA-c92w-72c5-9x59",
    "CVE-2019-17110"
  ],
  "related": [],
  "summary": "Exposure of sensitive information in k8s.io/kube-state-metrics. A security issue was discovered in the kube-state-metrics versions v1.7.0 and v1.7.1. An experimental feature was added to the v1.7.0 release that enabled annotations to be exposed as metrics. By default, the kube-state-metrics metrics only expose metadata about Secrets. However, a combination of the default `kubectl` behavior and this new feature can cause the entire secret content to end up in metric labels thus inadvertently exposing the secret content in metrics. This feature has been reverted and released as the v1.7.2 release. If you are running the v1.7.0 or v1.7.1 release, please upgrade to the v1.7.2 release as soon as possible. Se descubrió un problema de seguridad en las versiones v1.7.0 y v1.7.1 de kube-state-metrics. Una característica experimental fue agregada a la versión v1.7.0, lo que permitió que las anotaciones sean expuestas como métricas. Por defecto, las métricas de kube-state-metrics solo exponen metadatos sobre Secretos. Sin embargo, una combinación del comportamiento predeterminado de \"kubectl\" y esta nueva característica puede causar que todo el contenido secreto termine en etiquetas métricas, exponiendo inadvertidamente el contenido de secreto en métricas. Esta característica ha sido revertida y lanzada como la versión v1.7.2. Si está ejecutando la versión v1.7.0 o v1.7.1, actualice a la versión v1.7.2 lo antes posible",
  "details": "Exposing annotations as metrics can leak secrets.\n\nAn experimental feature of kube-state-metrics enables annotations to be exposed as metrics. By default, metrics only expose metadata about secrets. However, a combination of the default kubectl behavior and this new feature can cause the entire secret content to end up in metric labels",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.0"
    },
    {
      "type": "CVSS_V3",
      "score": "5.3"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "k8s.io/kube-state-metrics"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.7.0"
            },
            {
              "fixed": "1.7.2"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "k8s.io/kube-state-metrics/internal/store",
            "symbols": [
              "Builder.Build",
              "kubeAnnotationsToPrometheusLabels"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/kubernetes/kube-state-metrics/commit/03122fe3e2df49a9a7298b8af921d3c37c430f7f"
    },
    {
      "type": "WEB",
      "url": "http://www.openwall.com/lists/oss-security/2019/08/15/8"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10223"
    },
    {
      "type": "WEB",
      "url": "https://github.com/kubernetes/kube-state-metrics/releases/tag/v1.7.2"
    },
    {
      "type": "WEB",
      "url": "https://www.openwall.com/lists/oss-security/2019/08/09/1"
    }
  ],
  "credits": [
    {
      "name": "Moritz S."
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV30": [
        {
          "source": "secalert@redhat.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.6,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "SINGLE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.0
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.0,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-200",
        "url": ""
      },
      {
        "cwe_id": "secalert@redhat.com",
        "name": "Secondary",
        "description": "CWE-200",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/kubernetes/kube-state-metrics",
        "name": "kubernetes/kube-state-metrics",
        "description": "Add-on agent to generate and expose cluster-level metrics.",
        "date_created": "2016-05-06T06:10:13Z",
        "date_last_push": "2024-06-14T12:01:45Z",
        "owner": "kubernetes",
        "forks_count": "1885",
        "stars_count": "5176",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": false,
            "criteria": "cpe:2.3:o:linux:linux_kernel:-:*:*:*:*:*:*:*",
            "matchCriteriaId": "703AF700-7A70-47E2-BC3A-7FD03B3CA9C1"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:kubernetes:kube-state-metrics:1.7.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "F35A3D90-A326-4F91-8D10-B64D14384713"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:kubernetes:kube-state-metrics:1.7.1:*:*:*:*:*:*:*",
            "matchCriteriaId": "626E380A-BA9D-4ED1-A3A3-0A74FE6E9BEB"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:redhat:openshift_container_platform:3.11:*:*:*:*:*:*:*",
            "matchCriteriaId": "2F87326E-0B56-4356-A889-73D026DB1D4B"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.1:*:*:*:*:*:*:*",
            "matchCriteriaId": "064E7BDD-4EF0-4A0D-A38D-8C75BAFEDCEF"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.2:*:*:*:*:*:*:*",
            "matchCriteriaId": "4C85A84D-A70F-4B02-9E5D-CD9660ABF048"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0621",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}