{
  "schema_version": "1.6.3",
  "id": "CVE-2022-2990",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-09-21T15:06:10Z",
  "aliases": [
    "GO-2022-1008",
    "GHSA-fjm8-m7m6-2fjp"
  ],
  "related": [
    "CVE-2022-36109",
    "GHSA-4wjj-jwc9-2x96",
    "CVE-2023-25173",
    "GHSA-phjr-8j92-w5v7",
    "GHSA-rc4r-wh2q-q6c4",
    "CVE-2022-2995",
    "CVE-2022-2989",
    "GHSA-hmfx-3pcx-653p"
  ],
  "summary": "Unauthorized file access in github.com/containers/buildah. An incorrect handling of the supplementary groups in the Buildah container engine might lead to the sensitive information disclosure or possible data modification if an attacker has direct access to the affected container where supplementary groups are used to set access permissions and is able to execute a binary code in that container. Un manejo incorrecto de los grupos suplementarios en el motor de contenedores de Buildah podría conllevar a una divulgación de información confidencial o una posible modificación de datos si un atacante presenta acceso directo al contenedor afectado donde son usados los grupos suplementarios para establecer los permisos de acceso y es capaz de ejecutar un código binario en ese contenedor",
  "details": "SGID programs executed in a container can access files that have negative group permissions for the user's primary group.\n\nConsider a file which is owned by user u1 and group g1, permits user and other read access, and does NOT permit group read access. This file is readable by u1 and all other users except for ones in group g1.\n\nA program with the set-group-ID (SGID) bit set assumes the primary group of the program's group when it executes.\n\nA user with the primary group g1 who executes an SGID program owned by group g2 should not be able to access the file described above. While the program executes with the primary group g2, the group g1 should remain in its supplementary groups, blocking access to the file.\n\nBuildah does not correctly add g1 to the supplementary groups in this scenario, permitting unauthorized access",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.1"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/containers/buildah"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.27.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/containers/buildah",
            "symbols": [
              "Builder.Run",
              "Builder.configureUIDGID"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://www.benthamsgaze.org/2022/08/22/vulnerability-in-linux-containers-investigation-and-mitigation/"
    },
    {
      "type": "FIX",
      "url": "https://github.com/containers/buildah/commit/4a8bf740e862f2438279c6feee2ea59ddf0cda0b"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2121453"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 5.2
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-842",
        "name": "Primary",
        "description": "",
        "source": "secalert@redhat.com",
        "url": ""
      },
      {
        "cwe_id": "CWE-863",
        "name": "Secondary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/containers/buildah",
        "name": "containers/buildah",
        "description": "A tool that facilitates building OCI images.",
        "date_created": "2017-01-26T16:59:13Z",
        "date_last_push": "2024-06-22T20:24:00Z",
        "owner": "containers",
        "forks_count": "765",
        "stars_count": "7132",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:buildah_project:buildah:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "6BD601F2-7106-4CA2-8C32-023ECD5EC5ED",
            "versionEndExcluding": "1.27.1"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "932D137F-528B-4526-9A89-CD59FA1AB0FE"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux:7.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "142AD0DD-4CF3-4D74-9442-459CE3347E3A"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux:9.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "7F6FB57C-2BC7-487C-96DD-132683AEB35D"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1008",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}