{
  "schema_version": "1.6.3",
  "id": "CVE-2020-15106",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-04-14T20:04:52Z",
  "aliases": [
    "GHSA-m332-53r6-2w93",
    "GO-2020-0005",
    "GHSA-p4g4-wgrh-qrg2",
    "CVE-2020-15112"
  ],
  "related": [],
  "summary": "Panic due to malformed WALs in go.etcd.io/etcd. In etcd before versions 3.3.23 and 3.4.10, a large slice causes panic in decodeRecord method. The size of a record is stored in the length field of a WAL file and no additional validation is done on this data. Therefore, it is possible to forge an extremely large frame size that can unintentionally panic at the expense of any RAFT participant trying to decode the WAL. En etcd versiones anteriores a 3.3.23 y 3.4.10, un segmento grande causa pánico en el método decodeRecord. El tamaño de un registro es almacenado en el campo de longitud de un archivo WAL y no se hace ninguna comprobación adicional en estos datos. Por lo tanto, es posible forjar un tamaño de trama extremadamente grande que puede entrar en pánico involuntariamente a expensas de cualquier participante de RAFT que intente decodificar el WAL",
  "details": "Malformed WALs can be constructed such that WAL.ReadAll can cause attempted out of bounds reads, or creation of arbitrarily sized slices, which may be used as a DoS vector",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.0"
    },
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "go.etcd.io/etcd"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.5.0-alpha.5.0.20200423152442-f4b650b51dc4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "go.etcd.io/etcd/wal",
            "symbols": [
              "Create",
              "Repair",
              "Verify",
              "WAL.ReadAll",
              "decoder.decodeRecord"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/etcd-io/etcd/pull/11793"
    },
    {
      "type": "FIX",
      "url": "https://github.com/etcd-io/etcd/commit/f4b650b51dc4a53a8700700dc12e1242ac56ba07"
    },
    {
      "type": "WEB",
      "url": "https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf"
    },
    {
      "type": "WEB",
      "url": "https://github.com/etcd-io/etcd/security/advisories/GHSA-p4g4-wgrh-qrg2"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/"
    }
  ],
  "credits": [
    {
      "name": "Trail of Bits"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "SINGLE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "PARTIAL",
            "baseScore": 4.0
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.0,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "NVD-CWE-Other",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-20",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/etcd-io/etcd",
        "name": "etcd-io/etcd",
        "description": "Distributed reliable key-value store for the most critical data of a distributed system",
        "date_created": "2013-07-06T21:57:21Z",
        "date_last_push": "2024-06-24T09:08:53Z",
        "owner": "etcd-io",
        "forks_count": "9632",
        "stars_count": "46726",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:etcd:etcd:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "60E61F81-923E-4EB5-ABFD-F46AF0978E0B",
            "versionEndExcluding": "3.3.23"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:etcd:etcd:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "6A6101FF-FA05-42EB-AB82-108A9372B8E6",
            "versionStartIncluding": "3.4.0",
            "versionEndExcluding": "3.4.10"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*",
            "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2020-0005",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}