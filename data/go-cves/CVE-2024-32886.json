{
  "schema_version": "1.6.3",
  "id": "CVE-2024-32886",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-05-10T20:07:17Z",
  "aliases": [
    "GHSA-649x-hxfx-57j2",
    "GO-2024-2826"
  ],
  "related": [],
  "summary": "Denial of service attack by triggering unbounded memory usage in vitess.io/vitess. Vitess is a database clustering system for horizontal scaling of MySQL. When executing the following simple query, the `vtgate` will go into an endless loop that also keeps consuming memory and eventually will run out of memory. This vulnerability is fixed in 19.0.4, 18.0.5, and 17.0.7. Vitess es un sistema de agrupación de bases de datos para el escalado horizontal de MySQL. Al ejecutar la siguiente consulta simple, `vtgate` entrará en un bucle sin fin que también sigue consumiendo memoria y eventualmente se quedará sin memoria. Esta vulnerabilidad se solucionó en 19.0.4, 18.0.5 y 17.0.7",
  "details": "When executing a query, the vtgate will go into an endless loop that also keeps consuming memory and eventually will OOM. This causes a denial of service",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "4.9"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "vitess.io/vitess"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.17.7"
            },
            {
              "introduced": "0.18.0"
            },
            {
              "fixed": "0.18.5"
            },
            {
              "introduced": "0.19.0"
            },
            {
              "fixed": "0.19.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "vitess.io/vitess/go/mysql/collations/charset",
            "symbols": [
              "Convert",
              "ConvertFromBinary",
              "ConvertFromUTF8",
              "Validate",
              "convertSlow"
            ]
          },
          {
            "path": "vitess.io/vitess/go/mysql/collations/charset/unicode",
            "symbols": [
              "Charset_ucs2.DecodeRune",
              "Charset_utf16be.DecodeRune",
              "Charset_utf16be.EncodeRune",
              "Charset_utf32.EncodeRune"
            ]
          },
          {
            "path": "vitess.io/vitess/go/vt/vtgate/evalengine",
            "symbols": [
              "Add",
              "AggregateEvalTypes",
              "CoerceTo",
              "CoerceTypes",
              "Column.Format",
              "Column.FormatFast",
              "Comparison.ApplyTinyWeights",
              "Comparison.Compare",
              "Comparison.Less",
              "Comparison.More",
              "Comparison.Sort",
              "Comparison.SortResult",
              "CompiledExpr.Format",
              "CompiledExpr.FormatFast",
              "Divide",
              "EvalResult.MustBoolean",
              "EvalResult.String",
              "EvalResult.ToBoolean",
              "EvalResult.ToBooleanStrict",
              "EvalResult.TupleValues",
              "EvalResult.Value",
              "ExpressionEnv.Evaluate",
              "ExpressionEnv.EvaluateVM",
              "FieldResolver.Column",
              "IntroducerExpr.eval",
              "Literal.Format",
              "Literal.FormatFast",
              "Merger.Init",
              "Merger.Pop",
              "Merger.Push",
              "Multiply",
              "NewLiteralBinaryFromBit",
              "NewLiteralDateFromBytes",
              "NewLiteralDatetimeFromBytes",
              "NewLiteralDecimalFromBytes",
              "NewLiteralFloatFromBytes",
              "NewLiteralIntegralFromBytes",
              "NewLiteralTimeFromBytes",
              "NullSafeAdd",
              "NullsafeCompare",
              "NullsafeHashcode",
              "NullsafeHashcode128",
              "OrderByParams.Compare",
              "OrderByParams.String",
              "Sorter.Push",
              "Sorter.Sorted",
              "Subtract",
              "Translate",
              "TupleBindVariable.Format",
              "TupleBindVariable.FormatFast",
              "TupleExpr.Format",
              "TupleExpr.FormatFast",
              "UnsupportedCollationError.Error",
              "UntypedExpr.Compile",
              "UntypedExpr.Format",
              "UntypedExpr.FormatFast",
              "WeightString",
              "aggregationDecimal.Add",
              "aggregationDecimal.Max",
              "aggregationDecimal.Min",
              "aggregationFloat.Add",
              "aggregationFloat.Max",
              "aggregationFloat.Min",
              "aggregationInt.Add",
              "aggregationInt.Max",
              "aggregationInt.Min",
              "aggregationMinMax.Max",
              "aggregationMinMax.Min",
              "aggregationSumAny.Add",
              "aggregationSumCount.Add",
              "aggregationUint.Add",
              "aggregationUint.Max",
              "aggregationUint.Min",
              "argError.Error",
              "assembler.Fn_JSON_KEYS",
              "assembler.Fn_REGEXP_REPLACE_slow",
              "assembler.PushLiteral",
              "astCompiler.translateIntroducerExpr",
              "errJSONType.Error",
              "evalBytes.Hash"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/vitessio/vitess/security/advisories/GHSA-649x-hxfx-57j2"
    },
    {
      "type": "WEB",
      "url": "https://github.com/vitessio/vitess/commit/2fd5ba1dbf6e9b32fdfdaf869d130066b1b5c0df"
    },
    {
      "type": "WEB",
      "url": "https://github.com/vitessio/vitess/commit/9df4b66550e46b5d7079e21ed0e1b0f49f92b055"
    },
    {
      "type": "WEB",
      "url": "https://github.com/vitessio/vitess/commit/c46dc5b6a4329a10589ca928392218d96031ac8d"
    },
    {
      "type": "WEB",
      "url": "https://github.com/vitessio/vitess/commit/d438adf7e34a6cf00fe441db80842ec669a99202"
    },
    {
      "type": "WEB",
      "url": "https://github.com/vitessio/vitess/blob/8f6cfaaa643a08dc111395a75a2d250ee746cfa8/go/mysql/collations/charset/convert.go#L73-L79"
    },
    {
      "type": "WEB",
      "url": "https://github.com/vitessio/vitess/blob/8f6cfaaa643a08dc111395a75a2d250ee746cfa8/go/mysql/collations/charset/unicode/utf16.go#L69-L71"
    }
  ],
  "credits": [
    {
      "name": "@dbussink, @mattrobenolt, and @vmg"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 4.9,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.2,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-835",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/vitessio/vitess",
        "name": "vitessio/vitess",
        "description": "Vitess is a database clustering system for horizontal scaling of MySQL.",
        "date_created": "2013-06-27T21:20:28Z",
        "date_last_push": "2024-06-24T09:58:00Z",
        "owner": "vitessio",
        "forks_count": "2051",
        "stars_count": "18113",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/vitessio/vitess",
        "name": "vitessio/vitess",
        "description": "Vitess is a database clustering system for horizontal scaling of MySQL.",
        "date_created": "2013-06-27T21:20:28Z",
        "date_last_push": "2024-06-24T09:58:00Z",
        "owner": "vitessio",
        "forks_count": "2051",
        "stars_count": "18113",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/vitessio/vitess",
        "name": "vitessio/vitess",
        "description": "Vitess is a database clustering system for horizontal scaling of MySQL.",
        "date_created": "2013-06-27T21:20:28Z",
        "date_last_push": "2024-06-24T09:58:00Z",
        "owner": "vitessio",
        "forks_count": "2051",
        "stars_count": "18113",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2826",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}