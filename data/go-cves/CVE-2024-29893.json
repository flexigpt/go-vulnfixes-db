{
  "schema_version": "1.6.3",
  "id": "CVE-2024-29893",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-04-16T18:16:39Z",
  "aliases": [
    "GHSA-jhwx-mhww-rgc3",
    "GO-2024-2667"
  ],
  "related": [],
  "summary": "Out of memory crash from malicious Helm registry in github.com/argoproj/argo-cd/v2. Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. All versions of ArgoCD starting from v2.4 have a bug where the ArgoCD repo-server component is vulnerable to a Denial-of-Service attack vector. Specifically,  it's possible to crash the repo server component through an out of memory error by pointing it to a malicious Helm registry. The loadRepoIndex() function in the ArgoCD's helm package, does not limit the size nor time while fetching the data. It fetches it and creates a byte slice from the retrieved data in one go. If the registry is implemented to push data continuously, the repo server will keep allocating memory until it runs out of it. A patch for this vulnerability has been released in v2.10.3, v2.9.8, and v2.8.12. Argo CD es una herramienta declarativa de entrega continua de GitOps para Kubernetes. Todas las versiones de ArgoCD a partir de la v2.4 tienen un error por el cual el componente del servidor de repositorio de ArgoCD es vulnerable a un vector de ataque de denegación de servicio. Específicamente, es posible bloquear el componente del servidor de repositorio debido a un error de falta de memoria al señalarlo a un registro de Helm malicioso. La función loadRepoIndex() en el paquete helm de ArgoCD no limita el tamaño ni el tiempo al recuperar los datos. Lo recupera y crea un segmento de bytes a partir de los datos recuperados de una sola vez. Si el registro se implementa para enviar datos continuamente, el servidor de repositorio seguirá asignando memoria hasta que se agote. Se lanzó un parche para esta vulnerabilidad en las versiones 2.10.3, 2.9.8 y 2.8.12",
  "details": "Out of memory crash from malicious Helm registry in github.com/argoproj/argo-cd/v2",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.4.0"
            },
            {
              "fixed": "2.8.14"
            },
            {
              "introduced": "2.9.0"
            },
            {
              "fixed": "2.9.10"
            },
            {
              "introduced": "2.10.0"
            },
            {
              "fixed": "2.10.5"
            }
          ]
        }
      ],
      "ecosystem_specific": {}
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-jhwx-mhww-rgc3"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/14f681e3ee7c38731943b98f92277e88a3db109d"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/36b8a12a38f8d92d55bffc81deed44389bf6eb59"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/3e5a878f6e30d935fa149723ea2a2e93748fcddd"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-400",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-14T10:52:15Z",
        "owner": "argoproj",
        "forks_count": "5014",
        "stars_count": "16555",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-14T10:52:15Z",
        "owner": "argoproj",
        "forks_count": "5014",
        "stars_count": "16555",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-14T10:52:15Z",
        "owner": "argoproj",
        "forks_count": "5014",
        "stars_count": "16555",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2667",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}