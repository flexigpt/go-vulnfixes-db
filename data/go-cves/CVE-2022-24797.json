{
  "schema_version": "1.6.3",
  "id": "CVE-2022-24797",
  "modified": "2023-07-06T13:49:47.470000Z",
  "published": "2022-03-31T23:15:08.247000Z",
  "aliases": [],
  "related": [],
  "summary": "Pomerium is an identity-aware access proxy. In distributed service mode, Pomerium's Authenticate service exposes pprof debug and prometheus metrics handlers to untrusted traffic. This can leak potentially sensitive environmental information or lead to limited denial of service conditions. This issue is patched in version v0.17.1 Workarounds: Block access to `/debug` and `/metrics` paths on the authenticate service. This can be done with any L7 proxy, including Pomerium's own proxy service. Pomerium es un proxy de acceso consciente de la identidad. En el modo de servicio distribuido, el servicio de autenticación de Pomerium expone los manejadores de depuración pprof y de métricas prometheus al tráfico no confiable. Esto puede filtrar información ambiental potencialmente confidencial o conllevar a condiciones limitadas de denegación de servicio. Este problema ha sido parcheado en versión v0.17.1 Mitigaciones: Bloquear el acceso a las rutas \"/debug\" y \"/metrics\" en el servicio de autenticación. Esto puede hacerse con cualquier proxy L7, incluyendo el propio servicio proxy de Pomerium. CWE-200",
  "details": "Pomerium is an identity-aware access proxy. In distributed service mode, Pomerium's Authenticate service exposes pprof debug and prometheus metrics handlers to untrusted traffic. This can leak potentially sensitive environmental information or lead to limited denial of service conditions. This issue is patched in version v0.17.1 Workarounds: Block access to `/debug` and `/metrics` paths on the authenticate service. This can be done with any L7 proxy, including Pomerium's own proxy service",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "6.4"
    },
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "pomerium/pomerium",
        "purl": "https://github.com/pomerium/pomerium"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.16.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/pomerium/pomerium/commit/b435f73e2b54088da2aca5e8c3aa1808293d6903"
    },
    {
      "type": "WEB",
      "url": "https://github.com/pomerium/pomerium/pull/3212"
    },
    {
      "type": "WEB",
      "url": "https://github.com/pomerium/pomerium/security/advisories/GHSA-q98f-2x4p-prjr"
    }
  ],
  "credits": [
    {
      "name": "Caleb Doxsey",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 9.1,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.2
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "availabilityImpact": "LOW",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 2.5
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "availabilityImpact": "PARTIAL",
            "baseScore": 6.4
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 10.0,
          "impactScore": 4.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "NVD-CWE-Other",
        "url": ""
      },
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-200",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/pomerium/pomerium",
        "name": "pomerium/pomerium",
        "description": "Pomerium is an identity and context-aware access proxy.",
        "date_created": "2019-01-01 08:04:37",
        "date_last_push": "2022-08-26 21:44:25",
        "owner": "pomerium",
        "forks_count": "254.0",
        "stars_count": "3191.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pomerium:pomerium:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "10481143-FB07-45DD-B3B3-232D4F9EE63F",
            "versionStartIncluding": "0.16.0",
            "versionEndExcluding": "0.17.1"
          }
        ]
      }
    ],
    "datasources": {
      "govuln": false,
      "nvd": true,
      "cvefixes": true
    }
  }
}