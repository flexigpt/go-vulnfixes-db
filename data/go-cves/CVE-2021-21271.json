{
  "schema_version": "1.6.3",
  "id": "CVE-2021-21271",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-10-14T23:59:50Z",
  "aliases": [
    "GO-2022-1052",
    "GHSA-p658-8693-mhvg"
  ],
  "related": [],
  "summary": "Uncontrolled resource consumption during consensus in github.com/tendermint/tendermint. Tendermint Core is an open source Byzantine Fault Tolerant (BFT) middleware that takes a state transition machine - written in any programming language - and securely replicates it on many machines. Tendermint Core v0.34.0 introduced a new way of handling evidence of misbehavior. As part of this, we added a new Timestamp field to Evidence structs. This timestamp would be calculated using the same algorithm that is used when a block is created and proposed. (This algorithm relies on the timestamp of the last commit from this specific block.) In Tendermint Core v0.34.0-v0.34.2, the consensus reactor is responsible for forming DuplicateVoteEvidence whenever double signs are observed. However, the current block is still “in flight” when it is being formed by the consensus reactor. It hasn’t been finalized through network consensus yet. This means that different nodes in the network may observe different “last commits” when assigning a timestamp to DuplicateVoteEvidence. In turn, different nodes could form DuplicateVoteEvidence objects at the same height but with different timestamps. One DuplicateVoteEvidence object (with one timestamp) will then eventually get finalized in the block, but this means that any DuplicateVoteEvidence with a different timestamp is considered invalid. Any node that formed invalid DuplicateVoteEvidence will continue to propose invalid evidence; its peers may see this, and choose to disconnect from this node. This bug means that double signs are DoS vectors in Tendermint Core v0.34.0-v0.34.2. Tendermint Core v0.34.3 is a security release which fixes this bug. As of v0.34.3, DuplicateVoteEvidence is no longer formed by the consensus reactor; rather, the consensus reactor passes the Votes themselves into the EvidencePool, which is now responsible for forming DuplicateVoteEvidence. The EvidencePool has timestamp info that should be consistent across the network, which means that DuplicateVoteEvidence formed in this reactor should have consistent timestamps. This release changes the API between the consensus and evidence reactors. Tendermint Core es un middleware Byzantine Fault Tolerant (BFT) de código abierto que toma una máquina de transición de estado, escrita en cualquier lenguaje de programación, y la replica de forma segura en muchas máquinas. Tendermint Core versión v0.34.0 introdujo una nueva forma de manejar la evidencia de mal comportamiento. Como parte de esto, agregamos un nuevo campo Timestamp a las estructuras Evidence. Esta marca de tiempo se calcularía usando el mismo algoritmo que se utiliza cuando un bloque sea creado y propuesto. (Este algoritmo se basa en la marca de tiempo del último commit de este bloque específico). En Tendermint Core versiones v0.34.0-v0.34.2, el reactor de consenso es responsable de formar un DuplicateVoteEvidence siempre que se observen signos dobles. Sin embargo, el bloque actual todavía está \"in flight\" cuando lo está formando el reactor de consenso. Aún no se ha finalizado mediante el consenso de la red. Esto significa que diferentes nodos en la red pueden observar diferentes \"last commits\" al asignar una marca de tiempo a DuplicateVoteEvidence. A su vez, diferentes nodos podrían formar objetos DuplicateVoteEvidence a la misma altura pero con diferentes marcas de tiempo. Un objeto DuplicateVoteEvidence (con una marca de tiempo) finalmente se finalizará en el bloque, pero esto significa que cualquier DuplicateVoteEvidence con una marca de tiempo diferente se considera inválido. Cualquier nodo que formó un DuplicateVoteEvidence inválido continuará proponiendo evidencia inválida; sus peers pueden visualizar esto y optar por desconectarse de este nodo. Este error significa que los signos dobles son vectores de DoS en Tendermint Core versiones v0.34.0-v0.34.2. Tendermint Core versión v0.34.3 es una versión de seguridad que corrige este error. A partir de la versión 0.34.3, DuplicateVoteEvidence ya no está formado por el reactor de consenso; más bien, el reactor de consenso pasa los Votos mismos al EvidencePool, que ahora es responsable de formar un DuplicateVoteEvidence. EvidencePool posee información de marca de tiempo que debe ser consistente en toda la red, lo que significa que un DuplicateVoteEvidence formado en este reactor debe tener marcas de tiempo consistentes. Esta versión cambia la API entre los reactores de consenso y evidencia. CWE-400",
  "details": "Mishandling of timestamps during consensus process can cause a denial of service.\n\nWhile reaching consensus, different tendermint nodes can observe a different timestamp for a consensus evidence. This mismatch can cause the evidence to be invalid, upon which the node producing the evidence will be asked to generate a new evidence. This new evidence will be the same, which means it will again be rejected by other nodes involved in the consensus. This loop will continue until the peer nodes decide to disconnect from the node producing the evidence. Tendermint Core is an open source Byzantine Fault Tolerant (BFT) middleware that takes a state transition machine - written in any programming language - and securely replicates it on many machines. Tendermint Core v0.34.0 introduced a new way of handling evidence of misbehavior. As part of this, we added a new Timestamp field to Evidence structs. This timestamp would be calculated using the same algorithm that is used when a block is created and proposed. (This algorithm relies on the timestamp of the last commit from this specific block.) In Tendermint Core v0.34.0-v0.34.2, the consensus reactor is responsible for forming DuplicateVoteEvidence whenever double signs are observed. However, the current block is still “in flight” when it is being formed by the consensus reactor. It hasn’t been finalized through network consensus yet. This means that different nodes in the network may observe different “last commits” when assigning a timestamp to DuplicateVoteEvidence. In turn, different nodes could form DuplicateVoteEvidence objects at the same height but with different timestamps. One DuplicateVoteEvidence object (with one timestamp) will then eventually get finalized in the block, but this means that any DuplicateVoteEvidence with a different timestamp is considered invalid. Any node that formed invalid DuplicateVoteEvidence will continue to propose invalid evidence; its peers may see this, and choose to disconnect from this node. This bug means that double signs are DoS vectors in Tendermint Core v0.34.0-v0.34.2. Tendermint Core v0.34.3 is a security release which fixes this bug. As of v0.34.3, DuplicateVoteEvidence is no longer formed by the consensus reactor; rather, the consensus reactor passes the Votes themselves into the EvidencePool, which is now responsible for forming DuplicateVoteEvidence. The EvidencePool has timestamp info that should be consistent across the network, which means that DuplicateVoteEvidence formed in this reactor should have consistent timestamps. This release changes the API between the consensus and evidence reactors",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.0"
    },
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "tendermint/tendermint",
        "purl": "https://github.com/tendermint/tendermint"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.34.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/tendermint/tendermint/security/advisories/GHSA-p658-8693-mhvg"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tendermint/tendermint/blob/v0.34.3/CHANGELOG.md#v0.34.3"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tendermint/tendermint/commit/a2a6852ab99e4a0f9e79f0ea8c1726e262e25c76"
    }
  ],
  "credits": [
    {
      "name": "cmwaters (Github)"
    },
    {
      "name": "Callum",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "SINGLE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "PARTIAL",
            "baseScore": 4.0
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.0,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-400",
        "name": "Primary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/tendermint/tendermint",
        "name": "tendermint/tendermint",
        "description": "⟁ Tendermint Core (BFT Consensus) in Go",
        "date_created": "2014-05-14 23:21:35",
        "date_last_push": "2022-08-27 23:36:20",
        "owner": "tendermint",
        "forks_count": "1770.0",
        "stars_count": "5116.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:tendermint:tendermint:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "E506A553-4EE9-4251-8C60-DF2EA5EB2E98",
            "versionStartIncluding": "0.34.0",
            "versionEndIncluding": "0.34.2"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1052",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}