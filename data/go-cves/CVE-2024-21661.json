{
  "schema_version": "1.6.3",
  "id": "CVE-2024-21661",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-22T18:44:48Z",
  "aliases": [
    "GO-2024-2654",
    "GHSA-6v85-wr92-q4p7"
  ],
  "related": [],
  "summary": "Denial of service in github.com/argoproj/argo-cd/v2. Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Prior to versions 2.8.13, 2.9.9, and 2.10.4, an attacker can exploit a critical flaw in the application to initiate a Denial of Service (DoS) attack, rendering the application inoperable and affecting all users. The issue arises from unsafe manipulation of an array in a multi-threaded environment. The vulnerability is rooted in the application's code, where an array is being modified while it is being iterated over. This is a classic programming error but becomes critically unsafe when executed in a multi-threaded environment. When two threads interact with the same array simultaneously, the application crashes. This is a Denial of Service (DoS) vulnerability. Any attacker can crash the application continuously, making it impossible for legitimate users to access the service. The issue is exacerbated because it does not require authentication, widening the pool of potential attackers. Versions 2.8.13, 2.9.9, and 2.10.4 contain a patch for this issue. Argo CD es una herramienta declarativa de entrega continua de GitOps para Kubernetes. Antes de las versiones 2.8.13, 2.9.9 y 2.10.4, un atacante podía explotar una falla crítica en la aplicación para iniciar un ataque de denegación de servicio (DoS), dejando la aplicación inoperable y afectando a todos los usuarios. El problema surge de la manipulación insegura de una matriz en un entorno de subprocesos múltiples. La vulnerabilidad tiene su origen en el código de la aplicación, donde se modifica una matriz mientras se itera sobre ella. Este es un error de programación clásico, pero se vuelve críticamente inseguro cuando se ejecuta en un entorno de subprocesos múltiples. Cuando dos subprocesos interactúan con la misma matriz simultáneamente, la aplicación falla. Esta es una vulnerabilidad de denegación de servicio (DoS). Cualquier atacante puede bloquear la aplicación continuamente, imposibilitando que los usuarios legítimos accedan al servicio. El problema se agrava porque no requiere autenticación, lo que amplía el grupo de atacantes potenciales. Las versiones 2.8.13, 2.9.9 y 2.10.4 contienen un parche para este problema",
  "details": "Application may crash due to concurrent writes, leading to a denial of service. An attacker can crash the application continuously, making it impossible for legitimate users to access the service. Authentication is not required in the attack",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.8.13"
            },
            {
              "introduced": "2.9.0"
            },
            {
              "fixed": "2.9.9"
            },
            {
              "introduced": "2.10.0"
            },
            {
              "fixed": "2.10.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/argoproj/argo-cd/v2/server/application",
            "symbols": [
              "NewHandler",
              "newTerminalSession"
            ]
          },
          {
            "path": "github.com/argoproj/argo-cd/v2/util/session",
            "symbols": [
              "SessionManager.VerifyUsernamePassword",
              "SessionManager.getFailureCount",
              "SessionManager.updateFailureCount",
              "expireOldFailedAttempts"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/2a22e19e06aaf6a1e734443043310a66c234e345"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/5bbb51ab423f273dda74ab956469843d2db2e208"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/ce04dc5c6f6e92033221ec6d96b74403b065ca8b"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/blob/54601c8fd30b86a4c4b7eb449956264372c8bde0/util/session/sessionmanager.go#L302-L311"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-6v85-wr92-q4p7"
    }
  ],
  "credits": [
    {
      "name": "@nadava669"
    },
    {
      "name": "@todaywasawesome"
    },
    {
      "name": "@crenshaw-dev"
    },
    {
      "name": "@jannfis"
    },
    {
      "name": "@pasha-codefresh"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-787",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-24T10:01:00Z",
        "owner": "argoproj",
        "forks_count": "5041",
        "stars_count": "16635",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-24T10:01:00Z",
        "owner": "argoproj",
        "forks_count": "5041",
        "stars_count": "16635",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-24T10:01:00Z",
        "owner": "argoproj",
        "forks_count": "5041",
        "stars_count": "16635",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2654",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}