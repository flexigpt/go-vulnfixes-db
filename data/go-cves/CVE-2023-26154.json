{
  "schema_version": "1.6.3",
  "id": "CVE-2023-26154",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-01-02T18:32:37Z",
  "aliases": [
    "GO-2023-2385",
    "GHSA-5844-q3fc-56rh"
  ],
  "related": [],
  "summary": "Insufficient entropy in AES-256-CBC in github.com/pubnub/go. Versions of the package pubnub before 7.4.0; all versions of the package com.pubnub:pubnub; versions of the package pubnub before 6.19.0; all versions of the package github.com/pubnub/go; versions of the package github.com/pubnub/go/v7 before 7.2.0; versions of the package pubnub before 7.3.0; versions of the package pubnub/pubnub before 6.1.0; versions of the package pubnub before 5.3.0; versions of the package pubnub before 0.4.0; versions of the package pubnub/c-core before 4.5.0; versions of the package com.pubnub:pubnub-kotlin before 7.7.0; versions of the package pubnub/swift before 6.2.0; versions of the package pubnub before 5.2.0; versions of the package pubnub before 4.3.0 are vulnerable to Insufficient Entropy via the getKey function, due to inefficient implementation of the AES-256-CBC cryptographic algorithm. The provided encrypt function is less secure when hex encoding and trimming are applied, leaving half of the bits in the key always the same for every encoded message or file.\r\r**Note:**\r\rIn order to exploit this vulnerability, the attacker needs to invest resources in preparing the attack and brute-force the encryption. Versiones del paquete pubnub anteriores a 7.4.0; todas las versiones del paquete com.pubnub:pubnub; versiones del paquete pubnub anteriores a 6.19.0; todas las versiones del paquete github.com/pubnub/go; versiones del paquete github.com/pubnub/go/v7 anteriores a 7.2.0; versiones del paquete pubnub anteriores a 7.3.0; versiones del paquete pubnub/pubnub anteriores a 6.1.0; versiones del paquete pubnub anteriores a 5.3.0; versiones del paquete pubnub anteriores a 0.4.0; versiones del paquete pubnub/c-core anteriores a 4.5.0; versiones del paquete com.pubnub:pubnub-kotlin anteriores a 7.7.0; versiones del paquete pubnub/swift anteriores a 6.2.0; versiones del paquete pubnub anteriores a 5.2.0; Las versiones del paquete pubnub anteriores a la 4.3.0 son vulnerables a una entropía insuficiente a través de la función getKey, debido a una implementación ineficiente del algoritmo criptográfico AES-256-CBC. La función de cifrado proporcionada es menos segura cuando se aplica codificación y recorte hexadecimal, dejando la mitad de los bits de la clave siempre igual para cada mensaje o archivo codificado. **Nota:** Para aprovechar esta vulnerabilidad, el atacante necesita invertir recursos en preparar el ataque y aplicar fuerza bruta al cifrado",
  "details": "There is insufficient entropy in the implementation of the AES-256-CBC cryptographic algorithm. The provided encrypt functions are less secure when hex encoding and trimming are applied, leaving half of the bits in the key always the same for every encoded message or file.\n\nUsers are encouraged to migrate to the new crypto package introduced in v7.2.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.9"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/pubnub/go"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/pubnub/go/utils",
            "symbols": [
              "DecryptFile",
              "DecryptString",
              "EncryptCipherKey",
              "EncryptFile",
              "EncryptString",
              "SerializeAndEncrypt",
              "SerializeEncryptAndSerialize",
              "aesCipher",
              "generateIV",
              "padWithPKCS7",
              "unpadPKCS7"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/pubnub/go/v5"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/pubnub/go/v5/utils",
            "symbols": [
              "DecryptFile",
              "DecryptString",
              "EncryptCipherKey",
              "EncryptFile",
              "EncryptString",
              "SerializeAndEncrypt",
              "SerializeEncryptAndSerialize",
              "aesCipher",
              "generateIV",
              "padWithPKCS7",
              "unpadPKCS7"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/pubnub/go/v6"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/pubnub/go/v6/utils",
            "symbols": [
              "DecryptFile",
              "DecryptString",
              "EncryptCipherKey",
              "EncryptFile",
              "EncryptString",
              "SerializeAndEncrypt",
              "SerializeEncryptAndSerialize",
              "aesCipher",
              "generateIV",
              "padWithPKCS7",
              "unpadPKCS7"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/pubnub/go/v7"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/pubnub/go/v7/utils",
            "symbols": [
              "DecryptFile",
              "DecryptString",
              "EncryptCipherKey",
              "EncryptFile",
              "EncryptString",
              "SerializeAndEncrypt",
              "SerializeEncryptAndSerialize",
              "aesCipher",
              "generateIV",
              "padWithPKCS7",
              "unpadPKCS7"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/pubnub/go/v7"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "7.2.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/pubnub/go/v7/crypto",
            "symbols": [
              "EncryptCipherKey",
              "NewAesCbcCryptoModule",
              "NewLegacyCryptoModule",
              "NewLegacyCryptor",
              "defaultExtendedCryptor.DecryptStream",
              "defaultExtendedCryptor.EncryptStream",
              "legacyAesCipher",
              "legacyCryptor.Decrypt",
              "legacyCryptor.DecryptStream",
              "legacyCryptor.Encrypt",
              "legacyCryptor.EncryptStream",
              "module.Decrypt",
              "module.DecryptStream",
              "module.Encrypt",
              "module.EncryptStream"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/advisories/GHSA-5844-q3fc-56rh"
    },
    {
      "type": "FIX",
      "url": "https://github.com/pubnub/go/commit/428517fef5b901db7275d9f5a75eda89a4c28e08"
    },
    {
      "type": "WEB",
      "url": "https://gist.github.com/vargad/20237094fce7a0a28f0723d7ce395bb0"
    },
    {
      "type": "WEB",
      "url": "https://github.com/pubnub/javascript/blob/master/src/crypto/modules/web.js%23L70"
    },
    {
      "type": "WEB",
      "url": "https://github.com/pubnub/javascript/commit/fb6cd0417cbb4ba87ea2d5d86a9c94774447e119"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-COCOAPODS-PUBNUB-6098384"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-DOTNET-PUBNUB-6098372"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-GOLANG-GITHUBCOMPUBNUBGO-6098373"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-GOLANG-GITHUBCOMPUBNUBGOV7-6098374"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-JAVA-COMPUBNUB-6098371"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-JAVA-COMPUBNUB-6098380"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-JS-PUBNUB-5840690"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-PHP-PUBNUBPUBNUB-6098376"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-PUB-PUBNUB-6098385"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-PYTHON-PUBNUB-6098375"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-RUBY-PUBNUB-6098377"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-RUST-PUBNUB-6098378"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-SWIFT-PUBNUBSWIFT-6098381"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-UNMANAGED-PUBNUBCCORE-6098379"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 3.6
        },
        {
          "source": "report@snyk.io",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-331",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-331",
        "name": "Secondary",
        "description": "",
        "source": "report@snyk.io",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/pubnub/go",
        "name": "pubnub/go",
        "description": "PubNub clients for Go",
        "date_created": "2013-04-09T19:14:20Z",
        "date_last_push": "2024-05-29T06:45:38Z",
        "owner": "pubnub",
        "forks_count": "62",
        "stars_count": "103",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/pubnub/javascript",
        "name": "pubnub/javascript",
        "description": "PubNub JavaScript SDK docs https://www.pubnub.com/docs/sdks/javascript",
        "date_created": "2013-02-19T23:19:36Z",
        "date_last_push": "2024-06-19T05:41:18Z",
        "owner": "pubnub",
        "forks_count": "401",
        "stars_count": "551",
        "repo_language": "TypeScript"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:c-core:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "828BEB48-975A-4362-8BDD-904BCE3823FF",
            "versionEndExcluding": "4.5.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:kotlin:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "73948491-97EE-4EB8-8B97-9429088F99DF",
            "versionEndExcluding": "7.7.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:pubnub:*:*:*:*:*:-:*:*",
            "matchCriteriaId": "8170F0DF-1ED2-417E-B339-C08E1155938B",
            "versionEndExcluding": "0.4.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:pubnub:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "DF09708C-0267-4D74-BEB3-26273E41BC57",
            "versionEndExcluding": "7.2.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:pubnub:*:*:*:*:*:-:*:*",
            "matchCriteriaId": "CFA61BEF-9855-4A93-B02B-4D18B2AA3367",
            "versionStartIncluding": "3.6.4",
            "versionEndExcluding": "4.3.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:pubnub:*:*:*:*:*:-:*:*",
            "matchCriteriaId": "8D178036-011A-496A-81B2-2F6EC9CC10A4",
            "versionStartIncluding": "4.3.1",
            "versionEndExcluding": "5.2.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:pubnub:*:*:*:*:*:-:*:*",
            "matchCriteriaId": "E6AB8896-76D8-4888-A242-9A822898F0E3",
            "versionStartIncluding": "6.0.0",
            "versionEndExcluding": "6.1.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:pubnub:*:*:*:*:*:-:*:*",
            "matchCriteriaId": "1F2A00A7-9503-40F4-B31C-AEDC2B451A36",
            "versionStartIncluding": "6.2.0",
            "versionEndExcluding": "6.19.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:pubnub:*:*:*:*:*:-:*:*",
            "matchCriteriaId": "F1CF5B2D-CBE3-40AE-A53E-55B88317D278",
            "versionStartIncluding": "7.0.0",
            "versionEndExcluding": "7.3.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:pubnub:*:*:*:*:*:-:*:*",
            "matchCriteriaId": "8FF1CC6E-E537-4776-BF26-C07C83EEE35A",
            "versionStartIncluding": "7.3.1",
            "versionEndExcluding": "7.4.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pubnub:swift:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "24510B75-8FA4-46F5-A8C0-24C89141904B",
            "versionEndExcluding": "6.2.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2385",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}