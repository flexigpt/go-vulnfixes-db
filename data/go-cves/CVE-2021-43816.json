{
  "schema_version": "1.6.3",
  "id": "CVE-2021-43816",
  "modified": "2023-11-07T03:39:26.780000Z",
  "published": "2022-01-05T19:15:08.717000Z",
  "aliases": [],
  "related": [],
  "summary": "containerd is an open source container runtime. On installations using SELinux, such as EL8 (CentOS, RHEL), Fedora, or SUSE MicroOS, with containerd since v1.5.0-beta.0 as the backing container runtime interface (CRI), an unprivileged pod scheduled to the node may bind mount, via hostPath volume, any privileged, regular file on disk for complete read/write access (sans delete). Such is achieved by placing the in-container location of the hostPath volume mount at either `/etc/hosts`, `/etc/hostname`, or `/etc/resolv.conf`. These locations are being relabeled indiscriminately to match the container process-label which effectively elevates permissions for savvy containers that would not normally be able to access privileged host files. This issue has been resolved in version 1.5.9. Users are advised to upgrade as soon as possible. containerd es un tiempo de ejecución de contenedores de código abierto. En las instalaciones que usan SELinux, como EL8 (CentOS, RHEL), Fedora o SUSE MicroOS, con containerd desde la versión v1.5.0-beta.0 como interfaz de ejecución de contenedores de respaldo (CRI), un pod sin privilegios programado en el nodo puede enlazar el montaje, por medio del volumen hostPath, de cualquier archivo privilegiado y regular en el disco para un acceso completo de lectura/escritura (sans delete). Esto es conseguido al colocar la ubicación dentro del contenedor del montaje del volumen hostPath en \"/etc/hosts\", \"/etc/hostname\", o \"/etc/resolv.conf\". Estas ubicaciones están siendo reetiquetadas indiscriminadamente para que coincidan con la etiqueta del proceso del contenedor, lo que efectivamente eleva los permisos para los contenedores inteligentes que normalmente no podrían acceder a los archivos privilegiados del host. Este problema ha sido resuelto en versión 1.5.9. Se recomienda a usuarios que actualicen lo antes posible.. CWE-281",
  "details": "containerd is an open source container runtime. On installations using SELinux, such as EL8 (CentOS, RHEL), Fedora, or SUSE MicroOS, with containerd since v1.5.0-beta.0 as the backing container runtime interface (CRI), an unprivileged pod scheduled to the node may bind mount, via hostPath volume, any privileged, regular file on disk for complete read/write access (sans delete). Such is achieved by placing the in-container location of the hostPath volume mount at either `/etc/hosts`, `/etc/hostname`, or `/etc/resolv.conf`. These locations are being relabeled indiscriminately to match the container process-label which effectively elevates permissions for savvy containers that would not normally be able to access privileged host files. This issue has been resolved in version 1.5.9. Users are advised to upgrade as soon as possible",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "6.0"
    },
    {
      "type": "CVSS_V3",
      "score": "8.0"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "dweomer/containerd",
        "purl": "https://github.com/dweomer/containerd"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": []
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/containerd/containerd/commit/a731039238c62be081eb8c31525b988415745eea"
    },
    {
      "type": "WEB",
      "url": "https://github.com/containerd/containerd/issues/6194"
    },
    {
      "type": "WEB",
      "url": "https://github.com/containerd/containerd/security/advisories/GHSA-mvff-h3cj-wj9c"
    },
    {
      "type": "WEB",
      "url": "https://github.com/dweomer/containerd/commit/f7f08f0e34fb97392b0d382e58916d6865100299"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/GD5GH7NMK5VJMA2Y5CYB5O5GTPYMWMLX/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MPDIZMI7ZPERSZE2XO265UCK5IWM7CID/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MPDIZMI7ZPERSZE2XO265UCK5IWM7CID/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GD5GH7NMK5VJMA2Y5CYB5O5GTPYMWMLX/"
    }
  ],
  "credits": [
    {
      "name": "Jacob Blain Christen",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.1,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 2.3,
          "impactScore": 6.0
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.0,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.3,
          "impactScore": 6.0
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "SINGLE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 6.0
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 6.8,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-281",
        "url": ""
      },
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Secondary",
        "description": "CWE-281",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/dweomer/containerd",
        "name": "dweomer/containerd",
        "description": "An open and reliable container runtime",
        "date_created": "2018-08-22 19:16:10",
        "date_last_push": "2021-11-15 21:14:55",
        "owner": "dweomer",
        "forks_count": "0.0",
        "stars_count": "0.0",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/containerd/containerd",
        "name": "containerd/containerd",
        "description": "An open and reliable container runtime",
        "date_created": "2015-11-13 00:27:43",
        "date_last_push": "2022-08-27 13:51:10",
        "owner": "containerd",
        "forks_count": "2386.0",
        "stars_count": "11911.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "43387595-2EE9-4BCB-BA40-899372BAFD60",
            "versionStartIncluding": "1.5.1",
            "versionEndExcluding": "1.5.9"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:-:*:*:*:*:*:*",
            "matchCriteriaId": "51312F5E-E77D-4714-A47A-EB2900F91852"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:beta0:*:*:*:*:*:*",
            "matchCriteriaId": "2C477ED1-29F2-47CC-B523-331FE4052336"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:beta1:*:*:*:*:*:*",
            "matchCriteriaId": "2DD59A2E-2AF5-4D24-A0BD-F9A7C2064A91"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:beta2:*:*:*:*:*:*",
            "matchCriteriaId": "6D819271-9946-4A69-8EF7-AFF8AAA226CE"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:beta3:*:*:*:*:*:*",
            "matchCriteriaId": "F87C27FC-1AE4-45BA-BCF5-D5C2AEC3F3E4"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:beta4:*:*:*:*:*:*",
            "matchCriteriaId": "3F6FA16C-59DA-42A7-A75C-5E8FB0E83453"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:rc0:*:*:*:*:*:*",
            "matchCriteriaId": "2829C988-52D0-42A6-B063-B789046DBC58"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:rc1:*:*:*:*:*:*",
            "matchCriteriaId": "459C3B7F-4875-42A1-B242-A342218CEFD4"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:rc2:*:*:*:*:*:*",
            "matchCriteriaId": "6C93E100-A2D4-4781-8C36-4DBCFD704CB2"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:1.5.0:rc3:*:*:*:*:*:*",
            "matchCriteriaId": "F43624CC-D1D3-4FF0-8D97-20E190A9A56E"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
            "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*",
            "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"
          }
        ]
      }
    ],
    "datasources": {
      "govuln": false,
      "nvd": true,
      "cvefixes": true
    }
  }
}