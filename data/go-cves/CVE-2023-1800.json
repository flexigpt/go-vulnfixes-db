{
  "schema_version": "1.6.3",
  "id": "CVE-2023-1800",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-04-12T21:45:55Z",
  "aliases": [
    "GO-2023-1713",
    "GHSA-xq3x-grrj-fj6x"
  ],
  "related": [],
  "summary": "Path traversal in github.com/sjqzhang/go-fastdfs. A vulnerability, which was classified as critical, has been found in sjqzhang go-fastdfs up to 1.4.3. Affected by this issue is the function upload of the file /group1/uploa of the component File Upload Handler. The manipulation leads to path traversal: '../filedir'. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The identifier of this vulnerability is VDB-224768",
  "details": "An attacker can craft a remote request to upload a file to \"/group1/upload\" that uses path traversal to instead write the file contents to an attacker controlled path on the server",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "7.5"
    },
    {
      "type": "CVSS_V3",
      "score": "9.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/sjqzhang/go-fastdfs"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.4.5-0.20230408141131-61cbff5124c6"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/sjqzhang/go-fastdfs/server",
            "symbols": [
              "HttpHandler.ServeHTTP",
              "Server.ConsumerUpload",
              "Server.CrossOrigin",
              "Server.Download",
              "Server.DownloadNormalFileByURI",
              "Server.Start",
              "Server.Upload",
              "Server.upload",
              "Start"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/yangyanglo/ForCVE/blob/93a16663cd32a36d37d8a0f0102e1592254d0279/2023-0x05.md"
    },
    {
      "type": "WEB",
      "url": "https://vuldb.com/?ctiid.224768"
    },
    {
      "type": "WEB",
      "url": "https://vuldb.com/?id.224768"
    },
    {
      "type": "FIX",
      "url": "https://github.com/sjqzhang/go-fastdfs/commit/61cbff5124c61e292994099372b11c06cdb5b80b"
    },
    {
      "type": "ADVISORY",
      "url": "https://github.com/advisories/GHSA-xq3x-grrj-fj6x"
    },
    {
      "type": "WEB",
      "url": "https://github.com/yangyanglo/ForCVE/blob/main/2023-0x05.md"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        },
        {
          "source": "cna@vuldb.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "LOW",
            "baseScore": 7.3,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.4
        }
      ],
      "cvssMetricV2": [
        {
          "source": "cna@vuldb.com",
          "type": "Secondary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 7.5
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 10.0,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-434",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-24",
        "name": "Secondary",
        "description": "",
        "source": "cna@vuldb.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/sjqzhang/go-fastdfs",
        "name": "sjqzhang/go-fastdfs",
        "description": "go-fastdfs 是一个简单的分布式文件系统(私有云存储)，具有无中心、高性能，高可靠，免维护等优点，支持断点续传，分块上传，小文件合并，自动同步，自动修复。Go-fastdfs is a simple distributed file system (private cloud storage), with no center, high performance, high reliability, maintenance free and other advantages, support breakpoint continuation, block upload, small file merge, automatic synchronization, automatic repair.(similar fastdfs).",
        "date_created": "2019-01-07T01:35:37Z",
        "date_last_push": "2024-01-08T08:45:11Z",
        "owner": "sjqzhang",
        "forks_count": "735",
        "stars_count": "3856",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:go-fastdfs_project:go-fastdfs:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "E2E013CB-1199-4CAB-9165-31BFA6BF281E",
            "versionEndIncluding": "1.4.3"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-1713",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}