{
  "schema_version": "1.6.3",
  "id": "CVE-2022-36111",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-12-22T22:30:39Z",
  "aliases": [
    "GHSA-672p-m5jq-mrh8",
    "GO-2022-1117"
  ],
  "related": [],
  "summary": "Insufficient verification of proofs in github.com/codenotary/immudb. immudb is a database with built-in cryptographic proof and verification. In versions prior to 1.4.1, a malicious immudb server can provide a falsified proof that will be accepted by the client SDK signing a falsified transaction replacing the genuine one. This situation can not be triggered by a genuine immudb server and requires the client to perform a specific list of verified operations resulting in acceptance of an invalid state value. This vulnerability only affects immudb client SDKs, the immudb server itself is not affected by this vulnerability. This issue has been patched in version 1.4.1. immudb es una base de datos con prueba y verificación criptográfica incorporada. En versiones anteriores a la 1.4.1, un servidor immudb malicioso puede proporcionar una prueba falsificada que será aceptada por el SDK del cliente al firmar una transacción falsificada que reemplaza la genuina. Esta situación no puede ser provocada por un servidor immudb genuino y requiere que el cliente realice una lista específica de operaciones verificadas que resultan en la aceptación de un valor de estado no válido. Esta vulnerabilidad solo afecta a los SDK del cliente immudb; el servidor immudb en sí no se ve afectado por esta vulnerabilidad. Este problema se solucionó en la versión 1.4.1",
  "details": "In certain scenarios, a malicious immudb server can provide a falsified proof that will be accepted by the client SDK signing a falsified transaction replacing the genuine one. This situation can not be triggered by a genuine immudb server and requires the client to perform a specific list of verified operations resulting in acceptance of an invalid state value.\n\nThis vulnerability only affects immudb client SDKs, the immudb server itself is not affected by this vulnerability",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.3"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/codenotary/immudb"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.4.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/codenotary/immudb/pkg/client/auditor",
            "symbols": [
              "defaultAuditor.Run",
              "defaultAuditor.audit"
            ]
          },
          {
            "path": "github.com/codenotary/immudb/pkg/client",
            "symbols": [
              "immuClient.SafeGet",
              "immuClient.SafeReference",
              "immuClient.SafeSet",
              "immuClient.SafeZAdd",
              "immuClient.StreamVerifiedGet",
              "immuClient.StreamVerifiedSet",
              "immuClient.VerifiedGet",
              "immuClient.VerifiedGetAt",
              "immuClient.VerifiedGetAtRevision",
              "immuClient.VerifiedGetSince",
              "immuClient.VerifiedSet",
              "immuClient.VerifiedSetReference",
              "immuClient.VerifiedSetReferenceAt",
              "immuClient.VerifiedTxByID",
              "immuClient.VerifiedZAdd",
              "immuClient.VerifiedZAddAt",
              "immuClient.VerifyRow",
              "immuClient._streamVerifiedGet",
              "immuClient._streamVerifiedSet",
              "immuClient.verifiedGet"
            ]
          },
          {
            "path": "github.com/codenotary/immudb/embedded/store",
            "symbols": [
              "ImmuStore.DualProof",
              "VerifyDualProof",
              "VerifyLinearProof"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/codenotary/immudb/security/advisories/GHSA-672p-m5jq-mrh8"
    },
    {
      "type": "WEB",
      "url": "https://github.com/codenotary/immudb/tree/master/docs/security/vulnerabilities/linear-fake"
    },
    {
      "type": "FIX",
      "url": "https://github.com/codenotary/immudb/commit/acf7f1b3d62436ea5e038acea1fc6394f90ab1c6"
    },
    {
      "type": "FIX",
      "url": "https://github.com/codenotary/immudb/commit/7267d67e28be8f0257b71d734611a051593e8a81"
    },
    {
      "type": "WEB",
      "url": "https://github.com/codenotary/immudb/releases/tag/v1.4.1"
    },
    {
      "type": "WEB",
      "url": "https://pkg.go.dev/github.com/codenotary/immudb/pkg/client"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.6,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "HIGH",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.4,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.0,
          "impactScore": 4.0
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-345",
        "name": "Primary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/codenotary/immudb",
        "name": "codenotary/immudb",
        "description": "immudb - immutable database based on zero trust, SQL/Key-Value/Document model, tamperproof, data change history",
        "date_created": "2019-11-07T08:22:16Z",
        "date_last_push": "2024-06-07T14:34:30Z",
        "owner": "codenotary",
        "forks_count": "337",
        "stars_count": "8520",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/codenotary/immudb",
        "name": "codenotary/immudb",
        "description": "immudb - immutable database based on zero trust, SQL/Key-Value/Document model, tamperproof, data change history",
        "date_created": "2019-11-07T08:22:16Z",
        "date_last_push": "2024-06-07T14:34:30Z",
        "owner": "codenotary",
        "forks_count": "337",
        "stars_count": "8520",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:codenotary:immudb:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "0EA9B368-DD84-4E51-ABFB-7FDEF2E9807E",
            "versionEndExcluding": "1.4.1"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1117",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}