{
  "schema_version": "1.6.3",
  "id": "CVE-2018-6574",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-08-09T18:15:41Z",
  "aliases": [
    "GO-2022-0201"
  ],
  "related": [],
  "summary": "Remote command execution via \"go get\" command with cgo in cmd/go. Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2 allow \"go get\" remote command execution during source code build, by leveraging the gcc or clang plugin feature, because -fplugin= and -plugin= arguments were not blocked. Go, en versiones anteriores a la 1.8.7; Go en versiones 1.9.x anteriores a la 1.9.4 y los prelanzamientos de Go 1.10 anteriores a Go 1.10rc2 permiten la ejecución remota de comandos \"go get\" durante la construcción del código fuente aprovechando la característica del plugin gcc o clang debido a que los argumentos -fplugin= y -plugin= no se bloquearon",
  "details": "The \"go get\" command with cgo is vulnerable to remote command execution by leveraging the gcc or clang plugin feature.\n\nWhen cgo is enabled, the build step during \"go get\" invokes the host C compiler, gcc or clang, adding compiler flags specified in the Go source files. Both gcc and clang support a plugin mechanism in which a shared-library plugin is loaded into the compiler, as directed by compiler flags. This means that a Go package repository can contain an attack.so file along with a Go source file that says (for example) \"// #cgo CFLAGS: -fplugin=attack.so\" causing the attack plugin to be loaded into the host C compiler during the build. Gcc and clang plugins are completely unrestricted in their access to the host system",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.6"
    },
    {
      "type": "CVSS_V3",
      "score": "7.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "toolchain"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.8.7"
            },
            {
              "introduced": "1.9.0-0"
            },
            {
              "fixed": "1.9.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "cmd/go"
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://go.googlesource.com/go/+/1dcb5836ad2c60776561da2923c70576ba2eefc6"
    },
    {
      "type": "REPORT",
      "url": "https://go.dev/issue/23672"
    },
    {
      "type": "WEB",
      "url": "https://groups.google.com/g/golang-nuts/c/Gbhh1NxAjMU"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2018:0878"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2018:1304"
    },
    {
      "type": "WEB",
      "url": "https://github.com/KINGSABRI/CVE-in-Ruby/tree/master/CVE-2018-6574"
    },
    {
      "type": "WEB",
      "url": "https://github.com/golang/go/issues/23672"
    },
    {
      "type": "WEB",
      "url": "https://groups.google.com/forum/#%21topic/golang-nuts/Gbhh1NxAjMU"
    },
    {
      "type": "WEB",
      "url": "https://groups.google.com/forum/#%21topic/golang-nuts/sprOaQ5m3Dk"
    },
    {
      "type": "WEB",
      "url": "https://www.debian.org/security/2019/dsa-4380"
    }
  ],
  "credits": [
    {
      "name": "Christopher Brown of Mattermost"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV30": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 5.9
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "LOCAL",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 4.6
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 3.9,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-94",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "EADCBB6B-14BB-4EA3-AB22-5E85DC3E4741",
            "versionEndIncluding": "1.8.6"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.9:*:*:*:*:*:*:*",
            "matchCriteriaId": "7596E7CD-6863-4933-A9FB-74CF0ECF918F"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.9.1:*:*:*:*:*:*:*",
            "matchCriteriaId": "A3509578-3727-4D78-BA61-F642850F0740"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.9.2:*:*:*:*:*:*:*",
            "matchCriteriaId": "5F342C3C-F856-4C58-B7A4-4B162E4E6618"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.9.3:*:*:*:*:*:*:*",
            "matchCriteriaId": "673D7BE7-AEC1-4933-856D-89AB36607DFB"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.10:beta1:*:*:*:*:*:*",
            "matchCriteriaId": "91401035-811E-41FF-9ABE-E7EBBA2047BF"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.10:beta2:*:*:*:*:*:*",
            "matchCriteriaId": "D4B757CC-FE7C-450E-BF61-C1DB98C85D92"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.10:rc1:*:*:*:*:*:*",
            "matchCriteriaId": "C21E284A-D681-4F07-89AD-B565D3450F0C"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "51EF4996-72F4-4FA4-814F-F5991E7A8318"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux_server_aus:7.6:*:*:*:*:*:*:*",
            "matchCriteriaId": "B353CE99-D57C-465B-AAB0-73EF581127D1"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux_server_eus:7.6:*:*:*:*:*:*:*",
            "matchCriteriaId": "BF77CDCF-B9C9-427D-B2BF-36650FB2148C"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux_server_tus:7.6:*:*:*:*:*:*:*",
            "matchCriteriaId": "B76AA310-FEC7-497F-AF04-C3EC1E76C4CC"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0201",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}