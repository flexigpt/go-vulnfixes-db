{
  "schema_version": "1.6.3",
  "id": "CVE-2022-47633",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-12-27T18:24:54Z",
  "aliases": [
    "GO-2022-1180",
    "GHSA-m3cq-xcx9-3gvm"
  ],
  "related": [],
  "summary": "Verification rule bypass in github.com/kyverno/kyverno. An image signature validation bypass vulnerability in Kyverno 1.8.3 and 1.8.4 allows a malicious image registry (or a man-in-the-middle attacker) to inject unsigned arbitrary container images into a protected Kubernetes cluster. This is fixed in 1.8.5. This has been fixed in 1.8.5 and mitigations are available for impacted releases. Una vulnerabilidad de omisión de validación de firma de imagen en Kyverno 1.8.3 y 1.8.4 permite que un registro de imágenes malicioso (o un atacante intermediario) inyecte imágenes de contenedores arbitrarias sin firmar en un clúster de Kubernetes protegido. Esto se solucionó en 1.8.5. Esto se solucionó en 1.8.5 y hay mitigaciones disponibles para las versiones afectadas",
  "details": "A malicious proxy/registry can bypass verifyImages rules",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "8.1"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/kyverno/kyverno"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.8.3"
            },
            {
              "fixed": "1.8.5"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/kyverno/kyverno/pkg/engine",
            "symbols": [
              "imageVerifier.verifyAttestation",
              "imageVerifier.verifyAttestations",
              "imageVerifier.verifyAttestorSet",
              "imageVerifier.verifyAttestors",
              "imageVerifier.verifyImage"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/kyverno/kyverno/security/advisories/GHSA-m3cq-xcx9-3gvm"
    },
    {
      "type": "WEB",
      "url": "https://github.com/kyverno/kyverno/pull/5713"
    },
    {
      "type": "WEB",
      "url": "https://kyverno.io/policies/best-practices/restrict_image_registries/restrict_image_registries"
    },
    {
      "type": "WEB",
      "url": "https://github.com/kyverno/kyverno/compare/v1.8.4...v1.8.5"
    },
    {
      "type": "WEB",
      "url": "https://github.com/kyverno/kyverno/releases/tag/v1.8.5"
    },
    {
      "type": "WEB",
      "url": "https://kyverno.io/docs/writing-policies/verify-images/"
    }
  ],
  "credits": [
    {
      "name": "@slashben"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 5.9
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-287",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:kyverno:kyverno:1.8.3:*:*:*:*:*:*:*",
            "matchCriteriaId": "0D729B50-5AE9-4D29-8D58-FE477B5019E6"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:kyverno:kyverno:1.8.4:*:*:*:*:*:*:*",
            "matchCriteriaId": "71A13850-26FF-4699-9042-79F8DCA156B3"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1180",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}