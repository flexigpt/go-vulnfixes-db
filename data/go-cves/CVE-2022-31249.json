{
  "schema_version": "1.6.3",
  "id": "CVE-2022-31249",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-02-14T19:34:35Z",
  "aliases": [
    "GO-2023-1519",
    "GHSA-qrg7-hfx7-95c5"
  ],
  "related": [],
  "summary": "Command injection in github.com/rancher/wrangler. A Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') vulnerability in wrangler of SUSE Rancher allows remote attackers to inject commands in the underlying host via crafted commands passed to Wrangler. This issue affects: SUSE Rancher wrangler version 0.7.3 and prior versions; wrangler version 0.8.4 and prior versions; wrangler version 1.0.0 and prior versions",
  "details": "A command injection vulnerability exists in the Wrangler Git package. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.\n\nA workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "9.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/rancher/wrangler"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.7.4-security1"
            },
            {
              "introduced": "0.8.0"
            },
            {
              "fixed": "0.8.5-security1"
            },
            {
              "introduced": "0.8.6"
            },
            {
              "fixed": "0.8.11"
            },
            {
              "introduced": "1.0.0"
            },
            {
              "fixed": "1.0.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/rancher/wrangler/pkg/git",
            "symbols": [
              "Git.Clone",
              "Git.Ensure",
              "Git.Head",
              "Git.LsRemote",
              "Git.Update",
              "Git.fetchAndReset",
              "Git.gitCmd",
              "Git.reset"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/advisories/GHSA-qrg7-hfx7-95c5"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1200299"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        },
        {
          "source": "meissner@suse.de",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.6,
          "impactScore": 5.9
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "meissner@suse.de",
        "name": "Primary",
        "description": "CWE-78",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:suse:wrangler:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "46C3F368-99A7-4B09-B53F-0D57D8E76422",
            "versionEndExcluding": "0.7.4"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:suse:wrangler:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "79667660-A783-43C5-9BD1-6EDBA0B2C61C",
            "versionStartIncluding": "0.8.0",
            "versionEndExcluding": "0.8.5"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:suse:wrangler:1.0.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "73F2D72A-9CDA-4823-BA12-0A4468536CFE"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-1519",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}