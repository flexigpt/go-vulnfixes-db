{
  "schema_version": "1.6.3",
  "id": "CVE-2024-1753",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-22T16:47:09Z",
  "aliases": [
    "GHSA-pmf3-c36m-g5cf",
    "GO-2024-2658"
  ],
  "related": [
    "GHSA-874v-pj72-92f3"
  ],
  "summary": "Container escape at build time in github.com/containers/buildah. A flaw was found in Buildah (and subsequently Podman Build) which allows containers to mount arbitrary locations on the host filesystem into build containers. A malicious Containerfile can use a dummy image with a symbolic link to the root filesystem as a mount source and cause the mount operation to mount the host root filesystem inside the RUN step. The commands inside the RUN step will then have read-write access to the host filesystem, allowing for full container escape at build time. Se encontró una falla en Buildah (y posteriormente en Podman Build) que permite que los contenedores monten ubicaciones arbitrarias en el sistema de archivos del host en contenedores de compilación. Un Containerfile malicioso puede usar una imagen ficticia con un enlace simbólico al sistema de archivos raíz como fuente de montaje y hacer que la operación de montaje monte el sistema de archivos raíz del host dentro del paso RUN. Los comandos dentro del paso RUN tendrán acceso de lectura y escritura al sistema de archivos del host, lo que permitirá el escape completo del contenedor en el momento de la compilación",
  "details": "A crafted container file can use a dummy image with a symbolic link to the host filesystem as a mount source and cause the mount operation to mount the host filesystem during a build-time RUN step. The commands inside the RUN step will then have read-write access to the host filesystem",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "8.6"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/containers/buildah"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.35.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/containers/buildah/internal/volumes",
            "symbols": [
              "GetBindMount",
              "GetVolumes"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/containers/buildah/commit/9de9c20ff368beb84b84fe660773d352519dc1c5"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2265513"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2049"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2055"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2064"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2066"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2077"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2084"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2089"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2090"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2097"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2098"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2548"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2645"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2669"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2672"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2784"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2877"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:3254"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/security/cve/CVE-2024-1753"
    },
    {
      "type": "WEB",
      "url": "https://github.com/containers/buildah/security/advisories/GHSA-pmf3-c36m-g5cf"
    },
    {
      "type": "WEB",
      "url": "https://github.com/containers/podman/security/advisories/GHSA-874v-pj72-92f3"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FCRZVUDOFM5CPREQKBEU2VK2QK62PSBP/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KOYMVMQ7RWMDTSKQTBO734BE3WQPI2AJ/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZVBSVZGVABPYIHK5HZM472NPGWMI7WXH/"
    }
  ],
  "credits": [
    {
      "name": "@rmcnamara-snyk"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "secalert@redhat.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.6,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 6.0
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-269",
        "name": "Primary",
        "description": "",
        "source": "secalert@redhat.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/containers/buildah",
        "name": "containers/buildah",
        "description": "A tool that facilitates building OCI images.",
        "date_created": "2017-01-26T16:59:13Z",
        "date_last_push": "2024-06-22T20:24:00Z",
        "owner": "containers",
        "forks_count": "765",
        "stars_count": "7132",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2658",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}