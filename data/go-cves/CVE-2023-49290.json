{
  "schema_version": "1.6.3",
  "id": "CVE-2023-49290",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-12-11T15:08:59Z",
  "aliases": [
    "GO-2023-2379",
    "GHSA-7f9x-gw85-8grf"
  ],
  "related": [],
  "summary": "Denial of service due to malicious parameters in github.com/lestrrat-go/jwx. lestrrat-go/jwx is a Go module implementing various JWx (JWA/JWE/JWK/JWS/JWT, otherwise known as JOSE) technologies. A p2c parameter set too high in JWE's algorithm PBES2-* could lead to a denial of service. The JWE key management algorithms based on PBKDF2 require a JOSE Header Parameter called p2c (PBES2 Count). This parameter dictates the number of PBKDF2 iterations needed to derive a CEK wrapping key. Its primary purpose is to intentionally slow down the key derivation function, making password brute-force and dictionary attacks more resource- intensive. Therefore, if an attacker sets the p2c parameter in JWE to a very large number, it can cause a lot of computational consumption, resulting in a denial of service. This vulnerability has been addressed in commit `64f2a229b` which has been included in release version 1.2.27 and 2.0.18. Users are advised to upgrade. There are no known workarounds for this vulnerability. lestrrat-go/jwx es un módulo Go que implementa varias tecnologías JWx (JWA/JWE/JWK/JWS/JWT, también conocidas como JOSE). Un parámetro p2c establecido demasiado alto en el algoritmo PBES2-* de JWE podría provocar una denegación de servicio. Los algoritmos de gestión de claves JWE basados en PBKDF2 requieren un parámetro de encabezado JOSE llamado p2c (PBES2 Count). Este parámetro dicta el número de iteraciones de PBKDF2 necesarias para derivar una clave de envoltura CEK. Su objetivo principal es ralentizar intencionalmente la función de derivación de claves, haciendo que los ataques de fuerza bruta a contraseñas y de diccionario requieran más recursos. Por lo tanto, si un atacante establece el parámetro p2c en JWE en un número muy grande, puede provocar un gran consumo computacional, lo que resultará en una denegación de servicio. Esta vulnerabilidad se solucionó en el commit `64f2a229b` que se incluyó en las versiones 1.2.27 y 2.0.18. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad",
  "details": "The JWE key management algorithms based on PBKDF2 require a JOSE Header Parameter called p2c (PBES2 Count). This parameter dictates the number of PBKDF2 iterations needed to derive a CEK wrapping key. Its purpose is to intentionally slow down the key derivation function, making password brute-force and dictionary attacks more resource-intensive. However, if an attacker sets the p2c parameter in JWE to a very large number, it can cause excessive computational consumption",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.3"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/lestrrat-go/jwx"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.2.27"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/lestrrat-go/jwx/jwe",
            "symbols": [
              "Decrypt"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/lestrrat-go/jwx/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.0.18"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/lestrrat-go/jwx/v2/jwe",
            "symbols": [
              "Decrypt",
              "decryptCtx.decryptContent"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/lestrrat-go/jwx/security/advisories/GHSA-7f9x-gw85-8grf"
    },
    {
      "type": "WEB",
      "url": "https://github.com/lestrrat-go/jwx/commit/64f2a229b8e18605f47361d292b526bdc4aee01c"
    }
  ],
  "credits": [
    {
      "name": "@P3ngu1nW"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "LOW",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "LOW",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-400",
        "name": "Primary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/lestrrat-go/jwx",
        "name": "lestrrat-go/jwx",
        "description": "Implementation of various JWx (Javascript Object Signing and Encryption/JOSE) technologies",
        "date_created": "2015-11-04T05:12:52Z",
        "date_last_push": "2024-06-19T14:27:32Z",
        "owner": "lestrrat-go",
        "forks_count": "157",
        "stars_count": "1837",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:lestrrat-go:jwx:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "D883F8E3-02A2-4BC4-ADB3-F420624DD720",
            "versionEndExcluding": "1.2.27"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:lestrrat-go:jwx:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "566A6052-A735-4FDB-975D-47C594210E70",
            "versionStartIncluding": "2.0.0",
            "versionEndExcluding": "2.0.18"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2379",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}