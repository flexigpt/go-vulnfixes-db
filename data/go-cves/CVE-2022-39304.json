{
  "schema_version": "1.6.3",
  "id": "CVE-2022-39304",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-12-22T21:01:01Z",
  "aliases": [
    "GO-2022-1178",
    "GHSA-h4q8-96p6-jcgr"
  ],
  "related": [],
  "summary": "JWT leak in github.com/bradleyfalzon/ghinstallation. ghinstallation provides transport, which implements http.RoundTripper to provide authentication as an installation for GitHub Apps. In ghinstallation version 1, when the request to refresh an installation token failed, the HTTP request and response would be returned for debugging. The request contained the bearer JWT for the App, and was returned back to clients. This token is short lived (10 minute maximum). This issue has been patched and is available in version 2.0.0.\n ghinstallation proporciona transporte, que implementa http.RoundTripper para proporcionar autenticación como una instalación para GitHub Apps. En la versión 1 de ghinstallation, cuando fallaba la solicitud para actualizar un token de instalación, la solicitud HTTP y la respuesta se devolvían para su depuración. La solicitud contenía el JWT portador de la aplicación y se devolvía a los clientes. Este token tiene una duración breve (máximo 10 minutos). Este problema ha sido solucionado y está disponible en la versión 2.0.0",
  "details": "Errors returned by ghinstallation.Transport can include the JWT used for the failed operation. If the error is exposed to an untrusted party, this JWT could be extracted and used to authenticate further requests",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "4.7"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/bradleyfalzon/ghinstallation"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.1.2-0.20210308182858-d24f14f8be70"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/bradleyfalzon/ghinstallation",
            "symbols": [
              "Transport.RoundTrip",
              "Transport.Token",
              "Transport.refreshToken"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/bradleyfalzon/ghinstallation/security/advisories/GHSA-h4q8-96p6-jcgr"
    },
    {
      "type": "WEB",
      "url": "https://github.com/bradleyfalzon/ghinstallation/commit/d24f14f8be70d94129d76026e8b0f4f9170c8c3e"
    },
    {
      "type": "WEB",
      "url": "https://docs.github.com/en/developers/apps/building-github-apps/authenticating-with-github-apps#authenticating-as-an-installation"
    },
    {
      "type": "WEB",
      "url": "https://github.com/bradleyfalzon/ghinstallation/blob/24e56b3fb7669f209134a01eff731d7e2ef72a5c/transport.go#L172-L174"
    }
  ],
  "credits": [
    {
      "name": "@Miskerest"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.7,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.0,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:L",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "LOW",
            "baseScore": 5.0,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 0.8,
          "impactScore": 4.2
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-209",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/bradleyfalzon/ghinstallation",
        "name": "bradleyfalzon/ghinstallation",
        "description": "HTTP Round Tripper for GitHub Apps - Authenticate as an Installation Workflow",
        "date_created": "2016-10-26T11:24:09Z",
        "date_last_push": "2024-06-03T02:59:54Z",
        "owner": "bradleyfalzon",
        "forks_count": "93",
        "stars_count": "299",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:ghinstallation_project:ghinstallation:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "DBDED0BF-75D1-42F9-B5A5-D7D8A4D3A147",
            "versionEndExcluding": "2.0.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1178",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}