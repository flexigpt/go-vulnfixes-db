{
  "schema_version": "1.6.3",
  "id": "CVE-2022-36056",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-11-09T19:35:28Z",
  "aliases": [
    "GHSA-8gw7-4j42-w388",
    "GO-2022-0998"
  ],
  "related": [],
  "summary": "Improper blob verification in github.com/sigstore/cosign. Cosign is a project under the sigstore organization which aims to make signatures invisible infrastructure. In versions prior to 1.12.0 a number of vulnerabilities have been found in cosign verify-blob, where Cosign would successfully verify an artifact when verification should have failed. First a cosign bundle can be crafted to successfully verify a blob even if the embedded rekorBundle does not reference the given signature. Second, when providing identity flags, the email and issuer of a certificate is not checked when verifying a Rekor bundle, and the GitHub Actions identity is never checked. Third, providing an invalid Rekor bundle without the experimental flag results in a successful verification. And fourth an invalid transparency log entry will result in immediate success for verification. Details and examples of these issues can be seen in the GHSA-8gw7-4j42-w388 advisory linked. Users are advised to upgrade to 1.12.0. There are no known workarounds for these issues. Cosign es un proyecto bajo la organización sigstore que presenta como objetivo hacer que la infraestructura de las firmas sea invisible. En versiones anteriores a 1.12.0, han sido encontradas una serie de vulnerabilidades en cosign verify-blob, donde Cosign verificaba con éxito un artefacto cuando la verificación debería haber fallado. En primer lugar, puede diseñarse un paquete de Cosign para que verifique correctamente un blob aunque el rekorBundle insertado no haga referencia a la firma en cuestión. En segundo lugar, cuando son proporcionados indicadores de identidad, el correo electrónico y el emisor de un certificado no son comprobados cuando es verificado un paquete Rekor, y la identidad de las acciones de GitHub nunca es comprobada. En tercer lugar, si es proporcionada un paquete Rekor no válido sin el flag experimental, la verificación es realizada con éxito. Y en cuarto lugar, una entrada de registro de transparencia no válida resultará en un éxito inmediato de la verificación. Los detalles y ejemplos de estos problemas pueden verse en el aviso GHSA-8gw7-4j42-w388 enlazado. Es recomendado a usuarios actualizar a versión 1.12.0. No se presentan mitigaciones conocidas para estos problemas",
  "details": "Improper blob verification in github.com/sigstore/cosign",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/sigstore/cosign"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.12.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/sigstore/cosign/cmd/cosign/cli/verify",
            "symbols": [
              "VerifyAttestationCommand.Exec",
              "VerifyBlobCmd",
              "VerifyCommand.Exec",
              "signatures",
              "verifyRekorBundle",
              "verifyRekorEntry",
              "verifySigByUUID"
            ]
          },
          {
            "path": "github.com/sigstore/cosign/pkg/cosign",
            "symbols": [
              "TLogUpload",
              "TLogUploadInTotoAttestation",
              "VerifyBundle",
              "VerifyImageAttestations",
              "VerifyImageSignature",
              "VerifyImageSignatures",
              "VerifyLocalImageAttestations",
              "VerifyLocalImageSignatures",
              "VerifySET",
              "VerifyTLogEntry"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/sigstore/cosign/security/advisories/GHSA-8gw7-4j42-w388"
    },
    {
      "type": "WEB",
      "url": "https://github.com/sigstore/cosign/commit/80b79ed8b4d28ccbce3d279fd273606b5cddcc25"
    },
    {
      "type": "WEB",
      "url": "https://github.com/sigstore/cosign/releases/tag/v1.12.0"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-347",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/sigstore/cosign",
        "name": "sigstore/cosign",
        "description": "Code signing and transparency for containers and binaries",
        "date_created": "2021-02-04T12:49:39Z",
        "date_last_push": "2024-06-12T18:03:36Z",
        "owner": "sigstore",
        "forks_count": "504",
        "stars_count": "4183",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:sigstore:cosign:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "B4975968-ACFD-4039-AD18-F2C53D2CF1DD",
            "versionEndExcluding": "1.12.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0998",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}