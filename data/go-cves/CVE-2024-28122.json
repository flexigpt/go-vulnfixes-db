{
  "schema_version": "1.6.3",
  "id": "CVE-2024-28122",
  "modified": "2024-05-20T19:46:23Z",
  "published": "2024-05-20T19:46:23Z",
  "aliases": [
    "GHSA-hj3v-m684-v259",
    "GO-2024-2632"
  ],
  "related": [],
  "summary": "JWX vulnerable to a denial of service attack using compressed JWE message in github.com/lestrrat-go/jwx.  JWX is Go module implementing various JWx (JWA/JWE/JWK/JWS/JWT, otherwise known as JOSE) technologies. This vulnerability allows an attacker with a trusted public key to cause a Denial-of-Service (DoS) condition by crafting a malicious JSON Web Encryption (JWE) token with an exceptionally high compression ratio. This issue has been patched in versions 1.2.29 and 2.0.21. JWX es un módulo Go que implementa varias tecnologías JWx (JWA/JWE/JWK/JWS/JWT, también conocidas como JOSE). Esta vulnerabilidad permite a un atacante con una clave pública confiable provocar una condición de denegación de servicio (DoS) mediante la creación de un token JSON Web Encryption (JWE) malicioso con una relación de compresión excepcionalmente alta. Este problema se solucionó en las versiones 1.2.29 y 2.0.21",
  "details": "An attacker with a trusted public key may cause a Denial-of-Service (DoS) condition by crafting a malicious JSON Web Encryption (JWE) token with an exceptionally high compression ratio. When this token is processed by the recipient, it results in significant memory allocation and processing time during decompression",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "6.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/lestrrat-go/jwx"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.2.29"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/lestrrat-go/jwx/jwe",
            "symbols": [
              "Decrypt",
              "Message.Decrypt",
              "uncompress"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/lestrrat-go/jwx/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.0.21"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/lestrrat-go/jwx/v2/jwe",
            "symbols": [
              "Decrypt",
              "Settings",
              "decryptCtx.decryptContent",
              "uncompress"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/lestrrat-go/jwx/security/advisories/GHSA-hj3v-m684-v259"
    },
    {
      "type": "FIX",
      "url": "https://github.com/lestrrat-go/jwx/commit/d01027d74c7376d66037a10f4f64af9af26a7e34"
    },
    {
      "type": "FIX",
      "url": "https://github.com/lestrrat-go/jwx/commit/d43f2ceb7f0c13714dfe8854d6439766e86faa76"
    },
    {
      "type": "WEB",
      "url": "https://github.com/lestrrat-go/jwx/releases/tag/v1.2.29"
    },
    {
      "type": "WEB",
      "url": "https://github.com/lestrrat-go/jwx/releases/tag/v2.0.21"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.8,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.3,
          "impactScore": 4.0
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-400",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/lestrrat-go/jwx",
        "name": "lestrrat-go/jwx",
        "description": "Implementation of various JWx (Javascript Object Signing and Encryption/JOSE) technologies",
        "date_created": "2015-11-04T05:12:52Z",
        "date_last_push": "2024-06-05T07:32:52Z",
        "owner": "lestrrat-go",
        "forks_count": "156",
        "stars_count": "1827",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/lestrrat-go/jwx",
        "name": "lestrrat-go/jwx",
        "description": "Implementation of various JWx (Javascript Object Signing and Encryption/JOSE) technologies",
        "date_created": "2015-11-04T05:12:52Z",
        "date_last_push": "2024-06-05T07:32:52Z",
        "owner": "lestrrat-go",
        "forks_count": "156",
        "stars_count": "1827",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2632",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}