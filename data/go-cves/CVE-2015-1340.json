{
  "schema_version": "1.6.3",
  "id": "CVE-2015-1340",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-04-14T20:04:52Z",
  "aliases": [
    "GHSA-8mpq-fmr3-6jxv",
    "GO-2021-0071"
  ],
  "related": [],
  "summary": "Race condition in github.com/lxc/lxd. LXD before version 0.19-0ubuntu5 doUidshiftIntoContainer() has an unsafe Chmod() call that races against the stat in the Filepath.Walk() function. A symbolic link created in that window could cause any file on the system to have any mode of the attacker's choice. LXD anterior a la versión 0,19-0ubuntu5 la función doUidshiftIntoContainer() presenta una llamada no segura chmod() que corre contra la STAT en la función FilePath.Walk(). Un enlace simbólico creado en esa ventana podría hacer que cualquier archivo en el sistema tuviera cualquier modo de elección del atacante. CWE-362",
  "details": "A race between chown and chmod operations during a container filesystem shift may allow a user who can modify the filesystem to chmod an arbitrary path of their choice, rather than the expected path. LXD before version 0.19-0ubuntu5 doUidshiftIntoContainer() has an unsafe Chmod() call that races against the stat in the Filepath.Walk() function. A symbolic link created in that window could cause any file on the system to have any mode of the attacker's choice",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "6.8"
    },
    {
      "type": "CVSS_V3",
      "score": "8.1"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "lxc/lxd",
        "purl": "https://github.com/lxc/lxd"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": []
        }
      ]
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/lxc/lxd/pull/1189"
    },
    {
      "type": "WEB",
      "url": "https://github.com/lxc/lxd/commit/19c6961cc1012c8a529f20807328a9357f5034f4"
    },
    {
      "type": "WEB",
      "url": "https://bugs.launchpad.net/ubuntu/+source/lxd/+bug/1502270"
    }
  ],
  "credits": [
    {
      "name": "Seth Arnold"
    },
    {
      "name": "Stéphane Graber",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV30": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 5.9
        },
        {
          "source": "security@ubuntu.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:P/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H",
            "attackVector": "PHYSICAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.0,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 0.4,
          "impactScore": 6.0
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 6.8
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-362",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/lxc/lxd",
        "name": "lxc/lxd",
        "description": "Powerful system container and virtual machine manager",
        "date_created": "2014-11-04 22:40:52",
        "date_last_push": "2022-08-27 17:02:55",
        "owner": "lxc",
        "forks_count": "785.0",
        "stars_count": "3436.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxcontainers:lxd:-:*:*:*:*:*:*:*",
            "matchCriteriaId": "0CA5DE4F-5C5D-4013-B838-F9A0548AD004"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0071",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}