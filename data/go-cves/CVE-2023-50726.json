{
  "schema_version": "1.6.3",
  "id": "CVE-2023-50726",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-22T18:12:03Z",
  "aliases": [
    "GO-2024-2643",
    "GHSA-g623-jcgg-mhmm"
  ],
  "related": [],
  "summary": "Bypass manifest during application creation in github.com/argoproj/argo-cd/v2. Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. \"Local sync\" is an Argo CD feature that allows developers to temporarily override an Application's manifests with locally-defined manifests. Use of the feature should generally be limited to highly-trusted users, since it allows the user to bypass any merge protections in git. An improper validation bug allows users who have `create` privileges but not `override` privileges to sync local manifests on app creation. All other restrictions, including AppProject restrictions are still enforced. The only restriction which is not enforced is that the manifests come from some approved git/Helm/OCI source. The bug was introduced in 1.2.0-rc1 when the local manifest sync feature was added. The bug has been patched in Argo CD versions 2.10.3, 2.9.8, and 2.8.12. Users are advised to upgrade. Users unable to upgrade may mitigate the risk of branch protection bypass by removing `applications, create` RBAC access. The only way to eliminate the issue without removing RBAC access is to upgrade to a patched version. Argo CD es una herramienta declarativa de entrega continua de GitOps para Kubernetes. La \"sincronización local\" es una característica de Argo CD que permite a los desarrolladores anular temporalmente los manifiestos de una aplicación con manifiestos definidos localmente. El uso de la función generalmente debe limitarse a usuarios de alta confianza, ya que permite al usuario evitar cualquier protección de combinación en git. Un error de validación inadecuado permite a los usuarios que tienen privilegios de \"crear\" pero no privilegios de \"anular\" sincronizar manifiestos locales al crear la aplicación. Todas las demás restricciones, incluidas las de AppProject, aún se aplican. La única restricción que no se aplica es que los manifiestos provengan de alguna fuente aprobada de git/Helm/OCI. El error se introdujo en 1.2.0-rc1 cuando se agregó la función de sincronización del manifiesto local. El error se ha solucionado en las versiones 2.10.3, 2.9.8 y 2.8.12 de Argo CD. Se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar pueden mitigar el riesgo de eludir la protección de sucursal eliminando el acceso RBAC \"aplicaciones, creación\". La única forma de eliminar el problema sin eliminar el acceso a RBAC es actualizar a una versión parcheada",
  "details": "An improper validation bug allows users who have create privileges to sync a local manifest during application creation. This allows for bypassing the restriction that the manifests come from some approved git/Helm/OCI source",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "6.4"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.2.0-rc1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/argoproj/argo-cd/server/application",
            "symbols": [
              "Server.Create"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.0.0"
            },
            {
              "fixed": "2.8.12"
            },
            {
              "introduced": "2.9.0"
            },
            {
              "fixed": "2.9.8"
            },
            {
              "introduced": "2.10.0"
            },
            {
              "fixed": "2.10.3"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/argoproj/argo-cd/v2/server/application",
            "symbols": [
              "Server.Create"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/3b8f673f06c2d228e01cbc830e5cb57cef008978"
    },
    {
      "type": "WEB",
      "url": "https://argo-cd.readthedocs.io/en/latest/operator-manual/rbac"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-g623-jcgg-mhmm"
    }
  ],
  "credits": [
    {
      "name": "@crenshaw-dev"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:L/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "LOW",
            "availabilityImpact": "LOW",
            "baseScore": 6.4,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.1,
          "impactScore": 2.7
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-269",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/argoproj/argo-cd",
        "name": "argoproj/argo-cd",
        "description": "Declarative Continuous Deployment for Kubernetes",
        "date_created": "2018-02-09T11:12:01Z",
        "date_last_push": "2024-06-24T10:01:00Z",
        "owner": "argoproj",
        "forks_count": "5041",
        "stars_count": "16635",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2643",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}