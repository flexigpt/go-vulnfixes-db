{
  "schema_version": "1.6.3",
  "id": "CVE-2023-41338",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-09-12T17:31:22Z",
  "aliases": [
    "GHSA-3q5p-3558-364f",
    "GO-2023-2052"
  ],
  "related": [],
  "summary": "IsFromLocal local address check can be circumvented in github.com/gofiber/fiber/v2. Fiber is an Express inspired web framework built in the go language. Versions of gofiber prior to 2.49.2 did not properly restrict access to localhost. This issue impacts users of our project who rely on the `ctx.IsFromLocal` method to restrict access to localhost requests. If exploited, it could allow unauthorized access to resources intended only for localhost. Setting `X-Forwarded-For: 127.0.0.1` in a request from a foreign host, will result in true for `ctx.IsFromLocal`. Access is limited to the scope of the affected process. This issue has been patched in version `2.49.2` with commit `b8c9ede6`. Users are advised to upgrade. There are no known workarounds to remediate this vulnerability without upgrading to the patched version.  Fiber es un framework web inspirado en Express creado en el lenguaje Go. Las versiones de gofiber anteriores a la 2.49.2 no restringían adecuadamente el acceso a localhost. Este problema afecta a los usuarios de nuestro proyecto que dependen del método `ctx.IsFromLocal` para restringir el acceso a las solicitudes de localhost. Si se explota, podría permitir el acceso no autorizado a recursos destinados únicamente a localhost. Configurar `X-Forwarded-For: 127.0.0.1` en una solicitud de un host externo dará como resultado verdadero para `ctx.IsFromLocal`. El acceso está limitado al alcance del proceso afectado. Este problema se solucionó en la versión `2.49.2` con el commit `b8c9ede6`. Se recomienda a los usuarios que actualicen. No se conocen soluciones para remediar esta vulnerabilidad sin actualizar a la versión parcheada",
  "details": "The Ctx.IsFromLocal function can incorrectly report a request as being sent from localhost when the request contains an X-Forwarded-For header containing a localhost IP address",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.3"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/gofiber/fiber/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.49.2-0.20230906112033-b8c9ede6efa2"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/gofiber/fiber/v2",
            "symbols": [
              "Ctx.IsFromLocal",
              "Ctx.isLocalHost"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/gofiber/fiber/security/advisories/GHSA-3q5p-3558-364f"
    },
    {
      "type": "WEB",
      "url": "https://github.com/gofiber/fiber/commit/b8c9ede6efa231116c4bd8bb9d5e03eac1cb76dc"
    },
    {
      "type": "WEB",
      "url": "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For"
    },
    {
      "type": "WEB",
      "url": "https://docs.gofiber.io/api/ctx#isfromlocal"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-670",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/gofiber/fiber",
        "name": "gofiber/fiber",
        "description": "⚡️ Express inspired web framework written in Go",
        "date_created": "2020-01-16T03:59:20Z",
        "date_last_push": "2024-06-13T12:59:27Z",
        "owner": "gofiber",
        "forks_count": "1584",
        "stars_count": "31896",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:gofiber:fiber:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "DC21F2CF-3B2C-4803-AF42-0377FB5CD6AD",
            "versionEndExcluding": "2.49.2"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2052",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}