{
  "schema_version": "1.6.3",
  "id": "CVE-2018-21246",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-04-14T20:04:52Z",
  "aliases": [
    "GO-2020-0043",
    "GHSA-gr7w-x2jp-3xgw"
  ],
  "related": [],
  "summary": "Authentication bypass in github.com/mholt/caddy. Caddy before 0.10.13 mishandles TLS client authentication, as demonstrated by an authentication bypass caused by the lack of the StrictHostMatching mode. Caddy versiones anteriores a 0.10.13, maneja inapropiadamente la autenticación del cliente TLS, como es demostrado por una omisión de autenticación causado por la falta del modo StrictHostMatching",
  "details": "Due to improper TLS verification when serving traffic for multiple SNIs, an attacker may bypass TLS client authentication by indicating an SNI during the TLS handshake that is different from the name in the HTTP Host header",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "7.5"
    },
    {
      "type": "CVSS_V3",
      "score": "9.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/mholt/caddy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.10.13"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/mholt/caddy/caddyhttp/httpserver",
            "symbols": [
              "Server.serveHTTP",
              "assertConfigsCompatible",
              "httpContext.MakeServers"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/caddyserver/caddy/pull/2099"
    },
    {
      "type": "FIX",
      "url": "https://github.com/caddyserver/caddy/commit/4d9ee000c8d2cbcdd8284007c1e0f2da7bc3c7c3"
    },
    {
      "type": "WEB",
      "url": "https://bugs.gentoo.org/715214"
    },
    {
      "type": "WEB",
      "url": "https://github.com/caddyserver/caddy/releases/tag/v0.10.13"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 7.5
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 10.0,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-287",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/caddyserver/caddy",
        "name": "caddyserver/caddy",
        "description": "Fast and extensible multi-platform HTTP/1-2-3 web server with automatic HTTPS",
        "date_created": "2015-01-13T19:45:03Z",
        "date_last_push": "2024-06-14T11:03:47Z",
        "owner": "caddyserver",
        "forks_count": "3891",
        "stars_count": "55090",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:caddyserver:caddy:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "2FE503B4-3B28-4163-B779-6912D0966DC8",
            "versionEndExcluding": "0.10.3"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2020-0043",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}