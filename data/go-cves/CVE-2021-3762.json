{
  "schema_version": "1.6.3",
  "id": "CVE-2021-3762",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-15T23:30:27Z",
  "aliases": [
    "GO-2022-0346",
    "GHSA-mq47-6wwv-v79w"
  ],
  "related": [],
  "summary": "Path traversal in github.com/quay/claircore. A directory traversal vulnerability was found in the ClairCore engine of Clair. An attacker can exploit this by supplying a crafted container image which, when scanned by Clair, allows for arbitrary file write on the filesystem, potentially allowing for remote code execution. Se ha encontrado una vulnerabilidad de salto de directorio en el motor ClairCore de Clair. Un atacante puede explotar esto al suministrar una imagen de contenedor diseñada que, cuando es escaneada por Clair, permite una escritura de archivos arbitrarios en el sistema de archivos, permitiendo potencialmente una ejecución de código remota. CWE-22",
  "details": "A maliciously crafted RPM file can cause the Scanner.Scan function to write files with arbitrary contents to arbitrary locations on the local filestem. A directory traversal vulnerability was found in the ClairCore engine of Clair. An attacker can exploit this by supplying a crafted container image which, when scanned by Clair, allows for arbitrary file write on the filesystem, potentially allowing for remote code execution",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "7.5"
    },
    {
      "type": "CVSS_V3",
      "score": "9.8"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "quay/claircore",
        "purl": "https://github.com/quay/claircore"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.4.6"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/quay/claircore/pull/478"
    },
    {
      "type": "WEB",
      "url": "https://github.com/quay/claircore/commit/691f2023a1720a0579e688b69a2f4bfe1f4b7821"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2000795"
    },
    {
      "type": "WEB",
      "url": "https://github.com/quay/clair/pull/1379"
    },
    {
      "type": "WEB",
      "url": "https://github.com/quay/clair/pull/1380"
    },
    {
      "type": "WEB",
      "url": "https://vulmon.com/exploitdetails?qidtp=maillist_oss_security&qid=d19fce9ede06e13dfb5630ece7f14f83"
    }
  ],
  "credits": [
    {
      "name": "Hank Donnay",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 7.5
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 10.0,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-22",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-22",
        "name": "Secondary",
        "description": "",
        "source": "secalert@redhat.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/quay/claircore",
        "name": "quay/claircore",
        "description": "foundation modules for scanning container packages and reporting vulnerabilities",
        "date_created": "2019-09-10 20:44:53",
        "date_last_push": "2022-08-22 17:01:52",
        "owner": "quay",
        "forks_count": "53.0",
        "stars_count": "97.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:redhat:clair:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "DC3746AC-E2FF-414F-8707-CE382C70441B",
            "versionStartIncluding": "0.4.6",
            "versionEndExcluding": "0.4.8"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:redhat:clair:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "A6A00809-457A-4305-94EF-7E523A8B1691",
            "versionStartIncluding": "0.5.3",
            "versionEndExcluding": "0.5.5"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:redhat:quay:3.5.6:*:*:*:*:*:*:*",
            "matchCriteriaId": "414D3D0A-77F7-4D92-88D6-647F293A86B4"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0346",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}