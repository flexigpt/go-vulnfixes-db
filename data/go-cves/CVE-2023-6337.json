{
  "schema_version": "1.6.3",
  "id": "CVE-2023-6337",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-01-03T22:56:19Z",
  "aliases": [
    "GO-2023-2399",
    "GHSA-6p62-6cg9-f5f5"
  ],
  "related": [],
  "summary": "Denial of service via memory exhaustion in github.com/hashicorp/vault. HashiCorp Vault and Vault Enterprise 1.12.0 and newer are vulnerable to a denial of service through memory exhaustion of the host when handling large unauthenticated and authenticated HTTP requests from a client. Vault will attempt to map the request to memory, resulting in the exhaustion of available memory on the host, which may cause Vault to crash.\n\nFixed in Vault 1.15.4, 1.14.8, 1.13.12.\n\n HashiCorp Vault y Vault Enterprise 1.12.0 y versiones posteriores son vulnerables a una denegación de servicio debido al agotamiento de la memoria del host cuando se manejan grandes solicitudes HTTP autenticadas y no autenticadas de un cliente. Vault intentará asignar la solicitud a la memoria, lo que provocará que se agote la memoria disponible en el host, lo que puede provocar que Vault falle. Corregido en Vault 1.15.4, 1.14.8, 1.13.12",
  "details": "Unauthenticated and authenticated HTTP requests from a client will be attempted to be mapped to memory. Large requests may result in the exhaustion of available memory on the host, which may cause crashes and denial of service",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/hashicorp/vault"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.12.0"
            },
            {
              "fixed": "1.13.12"
            },
            {
              "introduced": "1.14.0"
            },
            {
              "fixed": "1.14.8"
            },
            {
              "introduced": "1.15.0"
            },
            {
              "fixed": "1.15.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/hashicorp/vault/helper/forwarding",
            "symbols": [
              "GenerateForwardedHTTPRequest",
              "GenerateForwardedRequest"
            ]
          },
          {
            "path": "github.com/hashicorp/vault/http",
            "symbols": [
              "HandlerAnchor.Handler",
              "TestServer",
              "TestServerWithListener",
              "TestServerWithListenerAndProperties",
              "handler",
              "parseFormRequest",
              "parseJSONRequest",
              "rateLimitQuotaWrapping",
              "wrapGenericHandler"
            ]
          },
          {
            "path": "github.com/hashicorp/vault/vault",
            "symbols": [
              "Core.DetermineRoleFromLoginRequest",
              "Core.DetermineRoleFromLoginRequestFromBytes",
              "Core.ForwardRequest",
              "Core.HandleRequest",
              "NewSystemBackend",
              "NewTestCluster",
              "SystemBackend.handleStorageRaftSnapshotWrite",
              "TestCluster.InitCores",
              "TestCoreUnsealed",
              "TestCoreUnsealedRaw",
              "TestCoreUnsealedWithConfig",
              "TestCoreUnsealedWithMetrics",
              "TestCoreWithCustomResponseHeaderAndUI"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-6337"
    },
    {
      "type": "WEB",
      "url": "https://discuss.hashicorp.com/t/hcsec-2023-34-vault-vulnerable-to-denial-of-service-through-memory-exhaustion-when-handling-large-http-requests/60741"
    },
    {
      "type": "FIX",
      "url": "https://github.com/hashicorp/vault/pull/24354"
    },
    {
      "type": "WEB",
      "url": "https://security.netapp.com/advisory/ntap-20240112-0006/"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security@hashicorp.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-770",
        "url": ""
      },
      {
        "cwe_id": "security@hashicorp.com",
        "name": "Secondary",
        "description": "CWE-770",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "279420C4-177B-42B2-A4D9-6E9EDA3F1D0E",
            "versionEndIncluding": "1.12.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "B0DB3723-28B2-48CB-9027-9A3AE4C650BD",
            "versionEndIncluding": "1.12.0"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "DCBF4C08-0C81-46C1-B9C6-843E07C78E34",
            "versionStartIncluding": "1.13.0",
            "versionEndExcluding": "1.13.12"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "F1B50279-B5C2-442A-AA6B-55DDD19ED8F5",
            "versionStartIncluding": "1.13.0",
            "versionEndExcluding": "1.13.12"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "885CF0FC-A707-4E8F-BCA8-45BC83FC06EE",
            "versionStartIncluding": "1.14.0",
            "versionEndExcluding": "1.14.8"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "D1BCB828-CA09-433F-96C3-4653B565DF1F",
            "versionStartIncluding": "1.14.0",
            "versionEndExcluding": "1.14.8"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "89F657D5-0195-4A10-80B3-C12ACFFA5B0E",
            "versionStartIncluding": "1.15.0",
            "versionEndExcluding": "1.15.4"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "CB94C54C-E891-47FD-8695-DFE0652F0E30",
            "versionStartIncluding": "1.15.0",
            "versionEndExcluding": "1.15.4"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2399",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}