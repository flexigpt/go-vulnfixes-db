{
  "schema_version": "1.6.3",
  "id": "CVE-2021-41803",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-04-05T16:54:12Z",
  "aliases": [
    "GHSA-hr3v-8cp3-68rf",
    "GO-2024-2683"
  ],
  "related": [],
  "summary": "Improper handling of node names in JWT claims assertions in github.com/hashicorp/consul. HashiCorp Consul 1.8.1 up to 1.11.8, 1.12.4, and 1.13.1 do not properly validate the node or segment names prior to interpolation and usage in JWT claim assertions with the auto config RPC. Fixed in 1.11.9, 1.12.5, and 1.13.2.\" HashiCorp Consul versiones 1.8.1 hasta 1.11.8, 1.12.4 y 1.13.1, no comprueban apropiadamente los nombres de nodos o segmentos antes de la interpolaci칩n y el uso en las aserciones de reclamaci칩n JWT con el RPC de configuraci칩n autom치tica. Corregido en versiones 1.11.9, 1.12.5 y 1.13.2\"",
  "details": "HashiCorp Consul does not properly validate the node or segment names prior to interpolation and usage in JWT claim assertions with the auto config RPC",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.1"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/hashicorp/consul"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.8.1"
            },
            {
              "fixed": "1.11.9"
            },
            {
              "introduced": "1.12.0"
            },
            {
              "fixed": "1.12.5"
            },
            {
              "introduced": "1.13.0"
            },
            {
              "fixed": "1.13.2"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/hashicorp/consul/agent/consul",
            "symbols": [
              "AutoConfig.InitialConfiguration",
              "jwtAuthorizer.Authorize"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://discuss.hashicorp.com/t/hcsec-2022-19-consul-auto-config-jwt-authorization-missing-input-validation/44627"
    },
    {
      "type": "FIX",
      "url": "https://github.com/hashicorp/consul/pull/14577/commits/2c881259ce10e308ff03afc968c4165998fd7fee"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/"
    },
    {
      "type": "WEB",
      "url": "https://www.hashicorp.com/blog/category/consul"
    }
  ],
  "credits": [
    {
      "name": "anonymous4ACL24"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 4.2
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-862",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:consul:*:*:*:*:-:*:*:*",
            "matchCriteriaId": "5383A26F-D49C-435F-A81D-15A1A7A74215",
            "versionStartIncluding": "1.8.1",
            "versionEndExcluding": "1.11.9"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:consul:*:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "E72F2F36-94E2-40D8-AC42-805F3EB54922",
            "versionStartIncluding": "1.8.1",
            "versionEndExcluding": "1.11.9"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:consul:1.12.4:*:*:*:-:*:*:*",
            "matchCriteriaId": "4A8E6F38-D34C-4EAE-98C6-6C65ACF35BEA"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:consul:1.12.4:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "6A7455E7-398A-42A5-946A-2497B88394F2"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:consul:1.13.1:*:*:*:-:*:*:*",
            "matchCriteriaId": "80BC2226-63EB-41E2-BEB4-4B3A84393E48"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:hashicorp:consul:1.13.1:*:*:*:enterprise:*:*:*",
            "matchCriteriaId": "5A31B819-4F49-42A3-9685-CE34440A4850"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2683",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}