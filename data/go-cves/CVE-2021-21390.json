{
  "schema_version": "1.6.3",
  "id": "CVE-2021-21390",
  "modified": "2021-03-25T20:29:34.060000Z",
  "published": "2021-03-19T16:15:12.920000Z",
  "aliases": [],
  "related": [],
  "summary": "MinIO is an open-source high performance object storage service and it is API compatible with Amazon S3 cloud storage service. In MinIO before version RELEASE.2021-03-17T02-33-02Z, there is a vulnerability which enables MITM modification of request bodies that are meant to have integrity guaranteed by chunk signatures. In a PUT request using aws-chunked encoding, MinIO ordinarily verifies signatures at the end of a chunk. This check can be skipped if the client sends a false chunk size that is much greater than the actual data sent: the server accepts and completes the request without ever reaching the end of the chunk + thereby without ever checking the chunk signature. This is fixed in version RELEASE.2021-03-17T02-33-02Z. As a workaround one can avoid using \"aws-chunked\" encoding-based chunk signature upload requests instead use TLS. MinIO SDKs automatically disable chunked encoding signature when the server endpoint is configured with TLS. MinIO es un servicio de almacenamiento de objetos de alto rendimiento de código abierto y su API es compatible con el servicio de almacenamiento en la nube Amazon S3. En MinIO versiones anteriores a RELEASE.2021-03-17T02-33-02Z, se presenta una vulnerabilidad que permite la modificación por parte de un MITM de los cuerpos de las peticiones que se supone que presentan la integridad garantizada por las firmas de los fragmentos. En una petición PUT que usa la codificación aws-chunked, MinIO normalmente comprueba las firmas al final de un fragmento. Esta comprobación puede saltarse si el cliente envía un tamaño de fragmento falso que es mucho mayor que los datos reales enviados: el servidor acepta y completa la petición sin llegar nunca al final del fragmento + por tanto sin comprobar nunca la firma del fragmento. Esto se ha corregido en la versión RELEASE.2021-03-17T02-33-02Z. Como solución, se puede evitar el uso de peticiones de carga de firmas de fragmentos basadas en la codificación \"aws-chunked\" y, en su lugar, usar TLS. Los SDKs de MinIO deshabilitan automáticamente la firma de codificación en trozos cuando el endpoint del servidor está configurado con TLS. CWE-924",
  "details": "MinIO is an open-source high performance object storage service and it is API compatible with Amazon S3 cloud storage service. In MinIO before version RELEASE.2021-03-17T02-33-02Z, there is a vulnerability which enables MITM modification of request bodies that are meant to have integrity guaranteed by chunk signatures. In a PUT request using aws-chunked encoding, MinIO ordinarily verifies signatures at the end of a chunk. This check can be skipped if the client sends a false chunk size that is much greater than the actual data sent: the server accepts and completes the request without ever reaching the end of the chunk + thereby without ever checking the chunk signature. This is fixed in version RELEASE.2021-03-17T02-33-02Z. As a workaround one can avoid using \"aws-chunked\" encoding-based chunk signature upload requests instead use TLS. MinIO SDKs automatically disable chunked encoding signature when the server endpoint is configured with TLS",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.3"
    },
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "minio/minio",
        "purl": "https://github.com/minio/minio"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "fixed": "2021-03-17t02-33-02z"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/minio/minio/commit/e197800f9055489415b53cf137e31e194aaf7ba0"
    },
    {
      "type": "WEB",
      "url": "https://github.com/minio/minio/pull/11801"
    },
    {
      "type": "WEB",
      "url": "https://github.com/minio/minio/security/advisories/GHSA-xr7r-7gpj-5pgp"
    }
  ],
  "credits": [
    {
      "name": "Andreas Auernhammer",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 4.3
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-924",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-924",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/minio/minio",
        "name": "minio/minio",
        "description": "Multi-Cloud :cloud: Object Storage ",
        "date_created": "2015-01-14 19:23:58",
        "date_last_push": "2022-08-27 08:48:43",
        "owner": "minio",
        "forks_count": "4137.0",
        "stars_count": "34954.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:minio:minio:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "420A5DDF-D7F9-45C8-82EB-BD18D81939CA",
            "versionEndExcluding": "2021-03-17t02-33-02z"
          }
        ]
      }
    ],
    "datasources": {
      "govuln": false,
      "nvd": true,
      "cvefixes": true
    }
  }
}