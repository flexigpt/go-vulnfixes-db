{
  "schema_version": "1.6.3",
  "id": "CVE-2021-3907",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-15T23:07:18Z",
  "aliases": [
    "GHSA-cqh2-vc2f-q4fh",
    "GO-2022-0248",
    "GHSA-8459-6rc9-8vf8"
  ],
  "related": [
    "GHSA-3jhm-87m6-x959"
  ],
  "summary": "Directory traversal in manifest path extraction in github.com/cloudflare/cfrpki. OctoRPKI does not escape a URI with a filename containing \"..\", this allows a repository to create a file, (ex. rsync://example.org/repo/../../etc/cron.daily/evil.roa), which would then be written to disk outside the base cache folder. This could allow for remote code execution on the host machine OctoRPKI is running on. OctoRPKI no escapa a un URI con un nombre de archivo que contenga \"..\", esto permite que un repositorio cree un archivo, (ej. rsync://ejemplo.org/repo/../../etc/cron.daily/evil.roa), que luego sería escrito en el disco fuera de la carpeta de caché base. Esto podría permitir una ejecución de código remota en la máquina anfitriona en la que se ejecuta OctoRPKI",
  "details": "Manifest path extraction is vulnerable to directory traversal attacks.\n\nThe ExtractPathManifest function permits file paths containing relative directory components (\"..\"), permitting files to reference arbitrary locations on the filesystem",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "7.5"
    },
    {
      "type": "CVSS_V3",
      "score": "9.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/cloudflare/cfrpki"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.4.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/cloudflare/cfrpki/validator/pki",
            "symbols": [
              "ExtractPathManifest",
              "SimpleManager.Explore",
              "SimpleManager.ExploreAdd",
              "Validator.AddManifest",
              "Validator.AddResource"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/cloudflare/cfrpki/commit/eb9cc4db7b7b79e44f56dfaa959fccdfb2af8284"
    },
    {
      "type": "FIX",
      "url": "https://github.com/cloudflare/cfrpki/commit/a053a808feeb3115c76b6cc263ee55598ce6e8cd"
    },
    {
      "type": "WEB",
      "url": "https://github.com/cloudflare/cfrpki/security/advisories/GHSA-3jhm-87m6-x959"
    },
    {
      "type": "WEB",
      "url": "https://github.com/cloudflare/cfrpki/security/advisories/GHSA-cqh2-vc2f-q4fh"
    },
    {
      "type": "WEB",
      "url": "https://www.debian.org/security/2021/dsa-5033"
    },
    {
      "type": "WEB",
      "url": "https://www.debian.org/security/2022/dsa-5041"
    }
  ],
  "credits": [
    {
      "name": "Koen van Hove"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        },
        {
          "source": "cna@cloudflare.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.4,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 5.2
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 7.5
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 10.0,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-22",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-20 CWE-22",
        "name": "Secondary",
        "description": "",
        "source": "cna@cloudflare.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/cloudflare/cfrpki",
        "name": "cloudflare/cfrpki",
        "description": "Cloudflare's RPKI Toolbox",
        "date_created": "2019-02-14T15:41:52Z",
        "date_last_push": "2024-02-29T14:57:11Z",
        "owner": "cloudflare",
        "forks_count": "40",
        "stars_count": "176",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/cloudflare/cfrpki",
        "name": "cloudflare/cfrpki",
        "description": "Cloudflare's RPKI Toolbox",
        "date_created": "2019-02-14T15:41:52Z",
        "date_last_push": "2024-02-29T14:57:11Z",
        "owner": "cloudflare",
        "forks_count": "40",
        "stars_count": "176",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:cloudflare:octorpki:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "A39C112F-E066-40D1-9CAC-9D9F89B467EE",
            "versionEndExcluding": "1.3.0"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "FA6FEEC2-9F11-4643-8827-749718254FED"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0248",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}