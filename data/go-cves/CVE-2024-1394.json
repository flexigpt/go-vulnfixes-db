{
  "schema_version": "1.6.3",
  "id": "CVE-2024-1394",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-27T22:08:48Z",
  "aliases": [
    "GHSA-78hx-gp6g-7mj6",
    "GO-2024-2660"
  ],
  "related": [],
  "summary": "Memory leak in github.com/golang-fips/openssl/v2 and github.com/microsoft/go-crypto-openssl. A memory leak flaw was found in Golang in the RSA encrypting/decrypting code, which might lead to a resource exhaustion vulnerability using attacker-controlled inputs​. The memory leak happens in github.com/golang-fips/openssl/openssl/rsa.go#L113. The objects leaked are pkey​ and ctx​. That function uses named return parameters to free pkey​ and ctx​ if there is an error initializing the context or setting the different properties. All return statements related to error cases follow the \"return nil, nil, fail(...)\" pattern, meaning that pkey​ and ctx​ will be nil inside the deferred function that should free them. Se encontró una falla de pérdida de memoria en Golang en el código de cifrado/descifrado RSA, lo que podría conducir a una vulnerabilidad de agotamiento de recursos mediante entradas controladas por el atacante. La pérdida de memoria ocurre en github.com/golang-fips/openssl/openssl/rsa.go#L113. Los objetos filtrados son pkey? y ctx?. Esa función utiliza parámetros de retorno con nombre para liberar pkey? y ctx? si hay un error al inicializar el contexto o al configurar las diferentes propiedades. Todas las declaraciones de devolución relacionadas con casos de error siguen el patrón \"return nil, nil, fail(...)\", lo que significa que pkey? y ctx? serán nulos dentro de la función diferida que debería liberarlos",
  "details": "Using crafted public RSA keys can cause a small memory leak when encrypting and verifying payloads. This can be gradually leveraged into a denial of service attack",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/golang-fips/openssl/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.0.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/golang-fips/openssl/v2",
            "symbols": [
              "DecryptRSANoPadding",
              "DecryptRSAOAEP",
              "DecryptRSAPKCS1",
              "EncryptRSANoPadding",
              "EncryptRSAOAEP",
              "EncryptRSAPKCS1",
              "NewGCMTLS",
              "NewGCMTLS13",
              "NewRC4Cipher",
              "SignMarshalECDSA",
              "SignRSAPKCS1v15",
              "SignRSAPSS",
              "VerifyECDSA",
              "VerifyRSAPKCS1v15",
              "VerifyRSAPSS",
              "aesCipher.Decrypt",
              "aesCipher.Encrypt",
              "aesCipher.NewCBCDecrypter",
              "aesCipher.NewCBCEncrypter",
              "aesCipher.NewCTR",
              "aesCipher.NewGCM",
              "aesCipher.NewGCMTLS",
              "aesCipher.NewGCMTLS13",
              "desCipher.Decrypt",
              "desCipher.Encrypt",
              "desCipher.NewCBCDecrypter",
              "desCipher.NewCBCEncrypter",
              "desCipherWithoutCBC.Decrypt",
              "desCipherWithoutCBC.Encrypt",
              "newCipherCtx",
              "noGCM.Decrypt",
              "noGCM.Encrypt",
              "setupEVP"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/microsoft/go-crypto-openssl"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.2.9"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/microsoft/go-crypto-openssl/openssl",
            "symbols": [
              "DecryptRSANoPadding",
              "DecryptRSAOAEP",
              "DecryptRSAOAEPWithMGF1Hash",
              "DecryptRSAPKCS1",
              "EncryptRSANoPadding",
              "EncryptRSAOAEP",
              "EncryptRSAOAEPWithMGF1Hash",
              "EncryptRSAPKCS1",
              "SignMarshalECDSA",
              "SignRSAPKCS1v15",
              "SignRSAPSS",
              "VerifyECDSA",
              "VerifyRSAPKCS1v15",
              "VerifyRSAPSS",
              "setupEVP"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/golang-fips/openssl/commit/85d31d0d257ce842c8a1e63c4d230ae850348136"
    },
    {
      "type": "WEB",
      "url": "https://github.com/microsoft/go-crypto-openssl/commit/104fe7f6912788d2ad44602f77a0a0a62f1f259f"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1462"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1468"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1472"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1501"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1502"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1561"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1563"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1566"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1567"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1574"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1640"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1644"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1646"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1763"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:1897"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2562"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2568"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2569"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2729"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2730"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:2767"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2024:3265"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/security/cve/CVE-2024-1394"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2262921"
    },
    {
      "type": "WEB",
      "url": "https://github.com/golang-fips/openssl/security/advisories/GHSA-78hx-gp6g-7mj6"
    },
    {
      "type": "WEB",
      "url": "https://pkg.go.dev/vuln/GO-2024-2660"
    },
    {
      "type": "WEB",
      "url": "https://vuln.go.dev/ID/GO-2024-2660.json"
    }
  ],
  "credits": [
    {
      "name": "@qmuntal and @r3kumar"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "secalert@redhat.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "secalert@redhat.com",
        "name": "Primary",
        "description": "CWE-401",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/golang-fips/openssl",
        "name": "golang-fips/openssl",
        "date_created": "2022-05-02T22:26:14Z",
        "date_last_push": "2024-05-29T22:34:01Z",
        "owner": "golang-fips",
        "forks_count": "9",
        "stars_count": "9",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/microsoft/go-crypto-openssl",
        "name": "microsoft/go-crypto-openssl",
        "description": "Go crypto backend for Linux using OpenSSL",
        "date_created": "2022-01-18T17:57:06Z",
        "date_last_push": "2024-03-26T19:16:25Z",
        "owner": "microsoft",
        "forks_count": "14",
        "stars_count": "53",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2660",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}