{
  "schema_version": "1.6.3",
  "id": "CVE-2023-44378",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-10-09T21:29:55Z",
  "aliases": [
    "GHSA-498w-5j49-vqjg",
    "GO-2023-2098"
  ],
  "related": [],
  "summary": "Unsoundness in variable comparison / non-unique binary decomposition in github.com/consensys/gnark. gnark is a zk-SNARK library that offers a high-level API to design circuits. Prior to version 0.9.0, for some in-circuit values, it is possible to construct two valid decomposition to bits. In addition to the canonical decomposition of `a`, for small values there exists a second decomposition for `a+r` (where `r` is the modulus the values are being reduced by). The second decomposition was possible due to overflowing the field where the values are defined. Upgrading to version 0.9.0 should fix the issue without needing to change the calls to value comparison methods. gnark es una librería zk-SNARK que ofrece una API de alto nivel para diseñar circuitos. Antes de la versión 0.9.0, para algunos valores en el circuito, era posible construir dos descomposición válida en bits. Además de la descomposición canónica de \"a\", para valores pequeños existe una segunda descomposición para \"a+r\" (donde \"r\" es el módulo por el que se reducen los valores). La segunda descomposición fue posible debido al desbordamiento del campo donde se definen los valores. La actualización a la versión 0.9.0 debería solucionar el problema sin necesidad de cambiar las llamadas a los métodos de comparación de valores",
  "details": "Unsoundness in variable comparison / non-unique binary decomposition in github.com/consensys/gnark",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/consensys/gnark"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.9.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/consensys/gnark/frontend/cs/r1cs",
            "symbols": [
              "builder.AssertIsLessOrEqual",
              "builder.Cmp",
              "builder.ToBinary",
              "builder.mustBeLessOrEqCst",
              "builder.mustBeLessOrEqVar"
            ]
          },
          {
            "path": "github.com/consensys/gnark/frontend/cs/scs",
            "symbols": [
              "builder.AssertIsLessOrEqual",
              "builder.Cmp",
              "builder.ToBinary",
              "builder.mustBeLessOrEqCst",
              "builder.mustBeLessOrEqVar"
            ]
          },
          {
            "path": "github.com/consensys/gnark/internal/backend/circuits",
            "symbols": [
              "recursiveHint.Define"
            ]
          },
          {
            "path": "github.com/consensys/gnark/std/math/bits",
            "symbols": [
              "WithNbDigits"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/zkopru-network/zkopru/issues/116"
    },
    {
      "type": "FIX",
      "url": "https://github.com/Consensys/gnark/pull/835"
    },
    {
      "type": "WEB",
      "url": "https://github.com/Consensys/gnark/commit/59a4087261a6c73f13e80d695c17b398c3d0934f"
    },
    {
      "type": "ADVISORY",
      "url": "https://github.com/advisories/GHSA-498w-5j49-vqjg"
    },
    {
      "type": "WEB",
      "url": "https://github.com/Consensys/gnark/security/advisories/GHSA-498w-5j49-vqjg"
    }
  ],
  "credits": [
    {
      "name": "@kustosz"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.5,
          "impactScore": 4.0
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-191 CWE-697",
        "name": "Primary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/Consensys/gnark",
        "name": "Consensys/gnark",
        "description": "gnark is a fast zk-SNARK library that offers a high-level API to design circuits. The library is open source and developed under the Apache 2.0 license",
        "date_created": "2020-02-24T16:08:21Z",
        "date_last_push": "2024-06-21T17:05:53Z",
        "owner": "Consensys",
        "forks_count": "335",
        "stars_count": "1332",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:consensys:gnark:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "33F1210A-A393-4C12-B0DF-0F698913487C",
            "versionEndExcluding": "0.9.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2098",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}