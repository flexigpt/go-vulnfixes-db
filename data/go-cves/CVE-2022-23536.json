{
  "schema_version": "1.6.3",
  "id": "CVE-2022-23536",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-12-22T17:41:59Z",
  "aliases": [
    "GHSA-cq2g-pw6q-hf7j",
    "GO-2022-1175"
  ],
  "related": [],
  "summary": "Exposure of local files in github.com/cortexproject/cortex. Cortex provides multi-tenant, long term storage for Prometheus. A local file inclusion vulnerability exists in Cortex versions 1.13.0, 1.13.1 and 1.14.0, where a malicious actor could remotely read local files as a result of parsing maliciously crafted Alertmanager configurations when submitted to the Alertmanager Set Configuration API. Only users of the Alertmanager service where `-experimental.alertmanager.enable-api` or `enable_api: true` is configured are affected. Affected Cortex users are advised to upgrade to patched versions 1.13.2 or 1.14.1. However as a workaround, Cortex administrators may reject Alertmanager configurations containing the `api_key_file` setting in the `opsgenie_configs` section before sending to the Set Alertmanager Configuration API.\n Cortex proporciona almacenamiento a largo plazo para múltiples inquilinos para Prometheus. Existe una vulnerabilidad de inclusión de archivos locales en las versiones 1.13.0, 1.13.1 y 1.14.0 de Cortex, donde un actor malintencionado podría leer de forma remota archivos locales como resultado del análisis de configuraciones de Alertmanager diseñadas con fines malintencionados cuando se envían a la API de configuración de Alertmanager. Solo se ven afectados los usuarios del servicio Alertmanager donde está configurado `-experimental.alertmanager.enable-api` o `enable_api: true`. Se recomienda a los usuarios afectados de Cortex que actualicen a las versiones parcheadas 1.13.2 o 1.14.1. Sin embargo, como workaround, los administradores de Cortex pueden rechazar las configuraciones de Alertmanager que contengan la configuración `api_key_file` en la sección `opsgenie_configs` antes de enviarlas a la API Set Alertmanager Configuration",
  "details": "A malicious actor could remotely read local files by submitting to the Alertmanager Set Configuration API maliciously crafted inputs. Only users of the Alertmanager service where \"-experimental.alertmanager.enable-api\" or \"enable_api: true\" is configured are affected",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/cortexproject/cortex"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.13.0"
            },
            {
              "fixed": "1.13.2"
            },
            {
              "introduced": "1.14.0"
            },
            {
              "fixed": "1.14.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/cortexproject/cortex/pkg/alertmanager",
            "symbols": [
              "validateAlertmanagerConfig",
              "validateGlobalConfig"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/cortexproject/cortex/security/advisories/GHSA-cq2g-pw6q-hf7j"
    },
    {
      "type": "FIX",
      "url": "https://github.com/cortexproject/cortex/commit/03e023d8b012887b31cc268d0d011b01e1e65506"
    },
    {
      "type": "WEB",
      "url": "https://cortexmetrics.io/docs/api/#set-alertmanager-configuration"
    },
    {
      "type": "WEB",
      "url": "https://github.com/cortexproject/cortex/releases/tag/v1.13.2"
    },
    {
      "type": "WEB",
      "url": "https://github.com/cortexproject/cortex/releases/tag/v1.14.1"
    }
  ],
  "credits": [
    {
      "name": "Austin Robertson with Amazon Web Services"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "NVD-CWE-noinfo",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-184 CWE-641 CWE-73",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/cortexproject/cortex",
        "name": "cortexproject/cortex",
        "description": "A horizontally scalable, highly available, multi-tenant, long term Prometheus.",
        "date_created": "2016-09-09T11:23:12Z",
        "date_last_push": "2024-06-24T07:57:27Z",
        "owner": "cortexproject",
        "forks_count": "781",
        "stars_count": "5392",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:cortex:1.13.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "99530D49-4F18-4E0C-81B3-543FFB1A9916"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:cortex:1.13.1:*:*:*:*:*:*:*",
            "matchCriteriaId": "244198BF-FD25-44A5-814D-5E7C7B583D11"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:cortex:1.14.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "4F2FE6BB-9BF1-4620-ABEA-143828D3B0D4"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1175",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}