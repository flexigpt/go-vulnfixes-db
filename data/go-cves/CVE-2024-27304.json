{
  "schema_version": "1.6.3",
  "id": "CVE-2024-27304",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-14T17:12:43Z",
  "aliases": [
    "GO-2024-2606",
    "GHSA-mrww-27vc-gghv",
    "GHSA-7jwh-3vrq-q3m8"
  ],
  "related": [],
  "summary": "SQL injection in github.com/jackc/pgproto3 and github.com/jackc/pgx. pgx is a PostgreSQL driver and toolkit for Go. SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control. The problem is resolved in v4.18.2 and v5.5.4. As a workaround, reject user input large enough to cause a single query or bind message to exceed 4 GB in size. pgx es un controlador PostgreSQL y un conjunto de herramientas para Go. La inyección de SQL puede ocurrir si un atacante puede hacer que una sola consulta o mensaje de enlace supere los 4 GB de tamaño. Un desbordamiento de enteros en el tamaño del mensaje calculado puede provocar que un mensaje grande se envíe como varios mensajes bajo el control del atacante. El problema se resuelve en v4.18.2 y v5.5.4. Como solución alternativa, rechace la entrada del usuario lo suficientemente grande como para provocar que una sola consulta o mensaje vinculado supere los 4 GB de tamaño",
  "details": "An integer overflow in the calculated message size of a query or bind message could allow a single large message to be sent as multiple messages under the attacker's control. This could lead to SQL injection if an attacker can cause a single query or bind message to exceed 4 GB in size",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "9.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/jackc/pgproto3/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.3.3"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/jackc/pgproto3/v2",
            "symbols": [
              "AuthenticationCleartextPassword.Encode",
              "AuthenticationGSS.Encode",
              "AuthenticationGSSContinue.Encode",
              "AuthenticationMD5Password.Encode",
              "AuthenticationOk.Encode",
              "AuthenticationSASL.Encode",
              "AuthenticationSASLContinue.Encode",
              "AuthenticationSASLFinal.Encode",
              "Backend.Send",
              "BackendKeyData.Encode",
              "Bind.Encode",
              "BindComplete.Encode",
              "CancelRequest.Encode",
              "Close.Encode",
              "CloseComplete.Encode",
              "CommandComplete.Encode",
              "CopyBothResponse.Encode",
              "CopyData.Encode",
              "CopyDone.Encode",
              "CopyFail.Encode",
              "CopyInResponse.Encode",
              "CopyOutResponse.Encode",
              "DataRow.Encode",
              "Describe.Encode",
              "EmptyQueryResponse.Encode",
              "ErrorResponse.Encode",
              "ErrorResponse.marshalBinary",
              "Execute.Encode",
              "Flush.Encode",
              "Frontend.Send",
              "FunctionCall.Encode",
              "FunctionCallResponse.Encode",
              "GSSEncRequest.Encode",
              "GSSResponse.Encode",
              "NoData.Encode",
              "NoticeResponse.Encode",
              "NotificationResponse.Encode",
              "ParameterDescription.Encode",
              "ParameterStatus.Encode",
              "Parse.Encode",
              "ParseComplete.Encode",
              "PasswordMessage.Encode",
              "PortalSuspended.Encode",
              "Query.Encode",
              "ReadyForQuery.Encode",
              "RowDescription.Encode",
              "SASLInitialResponse.Encode",
              "SASLResponse.Encode",
              "SSLRequest.Encode",
              "StartupMessage.Encode",
              "Sync.Encode",
              "Terminate.Encode"
            ]
          },
          {
            "path": "github.com/jackc/pgproto3/v2/example/pgfortune",
            "symbols": [
              "PgFortuneBackend.Run",
              "PgFortuneBackend.handleStartup",
              "main"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/jackc/pgx/v4"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "4.18.2"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/jackc/pgx/v4/internal/sanitize",
            "symbols": [
              "Query.Sanitize",
              "SanitizeSQL"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/jackc/pgx/v5"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "5.0.0"
            },
            {
              "fixed": "5.5.4"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/jackc/pgx/v5/internal/sanitize",
            "symbols": [
              "Query.Sanitize",
              "SanitizeSQL"
            ]
          },
          {
            "path": "github.com/jackc/pgx/v5/pgproto3",
            "symbols": [
              "AuthenticationCleartextPassword.Encode",
              "AuthenticationGSS.Encode",
              "AuthenticationGSSContinue.Encode",
              "AuthenticationMD5Password.Encode",
              "AuthenticationOk.Encode",
              "AuthenticationSASL.Encode",
              "AuthenticationSASLContinue.Encode",
              "AuthenticationSASLFinal.Encode",
              "Backend.Flush",
              "Backend.Send",
              "BackendKeyData.Encode",
              "Bind.Encode",
              "BindComplete.Encode",
              "CancelRequest.Encode",
              "Close.Encode",
              "CloseComplete.Encode",
              "CommandComplete.Encode",
              "CopyBothResponse.Encode",
              "CopyData.Encode",
              "CopyDone.Encode",
              "CopyFail.Encode",
              "CopyInResponse.Encode",
              "CopyOutResponse.Encode",
              "DataRow.Encode",
              "Describe.Encode",
              "EmptyQueryResponse.Encode",
              "ErrorResponse.Encode",
              "ErrorResponse.marshalBinary",
              "Execute.Encode",
              "Flush.Encode",
              "Frontend.Flush",
              "Frontend.Send",
              "Frontend.SendBind",
              "Frontend.SendClose",
              "Frontend.SendDescribe",
              "Frontend.SendExecute",
              "Frontend.SendParse",
              "Frontend.SendQuery",
              "Frontend.SendSync",
              "Frontend.SendUnbufferedEncodedCopyData",
              "FunctionCall.Encode",
              "FunctionCallResponse.Encode",
              "GSSEncRequest.Encode",
              "GSSResponse.Encode",
              "NoData.Encode",
              "NoticeResponse.Encode",
              "NotificationResponse.Encode",
              "ParameterDescription.Encode",
              "ParameterStatus.Encode",
              "Parse.Encode",
              "ParseComplete.Encode",
              "PasswordMessage.Encode",
              "PortalSuspended.Encode",
              "Query.Encode",
              "ReadyForQuery.Encode",
              "RowDescription.Encode",
              "SASLInitialResponse.Encode",
              "SASLResponse.Encode",
              "SSLRequest.Encode",
              "StartupMessage.Encode",
              "Sync.Encode",
              "Terminate.Encode"
            ]
          },
          {
            "path": "github.com/jackc/pgx/v5/pgconn",
            "symbols": [
              "Batch.ExecParams",
              "Batch.ExecPrepared",
              "Connect",
              "ConnectConfig",
              "ConnectWithOptions",
              "MultiResultReader.Close",
              "MultiResultReader.NextResult",
              "MultiResultReader.ReadAll",
              "PgConn.CheckConn",
              "PgConn.Close",
              "PgConn.CopyFrom",
              "PgConn.CopyTo",
              "PgConn.Deallocate",
              "PgConn.Exec",
              "PgConn.ExecBatch",
              "PgConn.ExecParams",
              "PgConn.ExecPrepared",
              "PgConn.Ping",
              "PgConn.Prepare",
              "PgConn.ReceiveMessage",
              "PgConn.SyncConn",
              "PgConn.WaitForNotification",
              "Pipeline.Close",
              "Pipeline.Flush",
              "Pipeline.GetResults",
              "Pipeline.SendDeallocate",
              "Pipeline.SendPrepare",
              "Pipeline.SendQueryParams",
              "Pipeline.SendQueryPrepared",
              "Pipeline.Sync",
              "ResultReader.Close",
              "ResultReader.NextRow",
              "ResultReader.Read",
              "ValidateConnectTargetSessionAttrsPreferStandby",
              "ValidateConnectTargetSessionAttrsPrimary",
              "ValidateConnectTargetSessionAttrsReadOnly",
              "ValidateConnectTargetSessionAttrsReadWrite",
              "ValidateConnectTargetSessionAttrsStandby"
            ]
          },
          {
            "path": "github.com/jackc/pgx/v5/pgproto3/example/pgfortune",
            "symbols": [
              "PgFortuneBackend.Run",
              "PgFortuneBackend.handleStartup",
              "main"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv"
    },
    {
      "type": "WEB",
      "url": "https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007"
    },
    {
      "type": "WEB",
      "url": "https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4"
    },
    {
      "type": "WEB",
      "url": "https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8"
    },
    {
      "type": "WEB",
      "url": "https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df"
    },
    {
      "type": "WEB",
      "url": "https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8"
    }
  ],
  "credits": [
    {
      "name": "paul-gerste-sonarsource"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-190 CWE-89",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/jackc/pgproto3",
        "name": "jackc/pgproto3",
        "date_created": "2019-03-30T16:53:00Z",
        "date_last_push": "2024-06-10T10:45:26Z",
        "owner": "jackc",
        "forks_count": "40",
        "stars_count": "155",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/jackc/pgx",
        "name": "jackc/pgx",
        "description": "PostgreSQL driver and toolkit for Go",
        "date_created": "2013-03-30T19:06:26Z",
        "date_last_push": "2024-06-24T08:16:14Z",
        "owner": "jackc",
        "forks_count": "795",
        "stars_count": "9772",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/jackc/pgx",
        "name": "jackc/pgx",
        "description": "PostgreSQL driver and toolkit for Go",
        "date_created": "2013-03-30T19:06:26Z",
        "date_last_push": "2024-06-24T08:16:14Z",
        "owner": "jackc",
        "forks_count": "795",
        "stars_count": "9772",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/jackc/pgx",
        "name": "jackc/pgx",
        "description": "PostgreSQL driver and toolkit for Go",
        "date_created": "2013-03-30T19:06:26Z",
        "date_last_push": "2024-06-24T08:16:14Z",
        "owner": "jackc",
        "forks_count": "795",
        "stars_count": "9772",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2606",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}