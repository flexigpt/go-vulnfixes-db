{
  "schema_version": "1.6.3",
  "id": "CVE-2023-45141",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-10-24T16:57:08Z",
  "aliases": [
    "GHSA-mv73-f69x-444p",
    "GO-2023-2116"
  ],
  "related": [],
  "summary": "CSRF token validation vulnerability in github.com/gofiber/fiber/v2. Fiber is an express inspired web framework written in Go. A Cross-Site Request Forgery (CSRF) vulnerability has been identified in the application, which allows an attacker to obtain tokens and forge malicious requests on behalf of a user. This can lead to unauthorized actions being taken on the user's behalf, potentially compromising the security and integrity of the application. The vulnerability is caused by improper validation and enforcement of CSRF tokens within the application. This vulnerability has been addressed in version 2.50.0 and users are advised to upgrade. Users should take additional security measures like captchas or Two-Factor Authentication (2FA) and set Session cookies with SameSite=Lax or SameSite=Secure, and the Secure and HttpOnly attributes. Fiber es un framework web inspirado en Express escrito en Go. Se ha identificado una vulnerabilidad de Cross-Site Request Forgery (CSRF) en la aplicación, que permite a un atacante obtener tokens y falsificar solicitudes maliciosas en nombre de un usuario. Esto puede dar lugar a que se realicen acciones no autorizadas en nombre del usuario, lo que podría comprometer la seguridad y la integridad de la aplicación. La vulnerabilidad se debe a una validación y aplicación inadecuadas de los tokens CSRF dentro de la aplicación. Esta vulnerabilidad se solucionó en la versión 2.50.0 y se recomienda a los usuarios actualizarla. Los usuarios deben tomar medidas de seguridad adicionales como captchas o autenticación de dos factores (2FA) y configurar cookies de sesión con SameSite=Lax o SameSite=Secure, y los atributos Secure y HttpOnly",
  "details": "A cross-site request forgery vulnerability can allow an attacker to obtain tokens and forge malicious requests on behalf of a user. This can lead to unauthorized actions being taken on the user's behalf, potentially compromising the security and integrity of the application.\n\nThe vulnerability is caused by improper validation and enforcement of CSRF tokens within the application. The CSRF token is validated against tokens in storage but was is not tied to the original requestor that generated it, allowing for token reuse",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "8.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/gofiber/fiber/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.50.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/gofiber/fiber/v2/middleware/csrf",
            "symbols": [
              "CsrfFromCookie",
              "CsrfFromForm",
              "CsrfFromHeader",
              "CsrfFromParam",
              "CsrfFromQuery",
              "New",
              "configDefault",
              "manager.getRaw",
              "manager.setRaw",
              "newManager"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/gofiber/fiber/security/advisories/GHSA-mv73-f69x-444p"
    },
    {
      "type": "FIX",
      "url": "https://github.com/gofiber/fiber/commit/8c3916dbf4ad2ed427d02c6eb63ae8b2fa8f019a"
    },
    {
      "type": "FIX",
      "url": "https://github.com/gofiber/fiber/commit/b50d91d58ecdff2a330bf07950244b6c4caf65b1"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.9
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "HIGH",
            "availabilityImpact": "LOW",
            "baseScore": 8.6,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 4.7
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-352 CWE-565",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/gofiber/fiber",
        "name": "gofiber/fiber",
        "description": "⚡️ Express inspired web framework written in Go",
        "date_created": "2020-01-16T03:59:20Z",
        "date_last_push": "2024-06-13T12:59:27Z",
        "owner": "gofiber",
        "forks_count": "1584",
        "stars_count": "31896",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/gofiber/fiber",
        "name": "gofiber/fiber",
        "description": "⚡️ Express inspired web framework written in Go",
        "date_created": "2020-01-16T03:59:20Z",
        "date_last_push": "2024-06-13T12:59:27Z",
        "owner": "gofiber",
        "forks_count": "1584",
        "stars_count": "31896",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:gofiber:fiber:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "D4CF7CB2-A259-42A1-A42F-26170DCC266D",
            "versionEndExcluding": "2.50.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2116",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}