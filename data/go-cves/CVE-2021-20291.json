{
  "schema_version": "1.6.3",
  "id": "CVE-2021-20291",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-07-28T18:08:05Z",
  "aliases": [
    "GHSA-7qw8-847f-pggm",
    "GO-2021-0100"
  ],
  "related": [],
  "summary": "Denial of service via deadlock in github.com/containers/storage. A deadlock vulnerability was found in 'github.com/containers/storage' in versions before 1.28.1. When a container image is processed, each layer is unpacked using `tar`. If one of those layers is not a valid `tar` archive this causes an error leading to an unexpected situation where the code indefinitely waits for the tar unpacked stream, which never finishes. An attacker could use this vulnerability to craft a malicious image, which when downloaded and stored by an application using containers/storage, would then cause a deadlock leading to a Denial of Service (DoS). Se encontró una vulnerabilidad de interbloqueo en \"github.com/containers/storage\" en versiones anteriores a 1.28.1.&#xa0;Cuando se procesa una imagen de contenedor, cada capa se desempaqueta usando un \"tar\".&#xa0;Si una de esas capas no es un archivo \"tar\" válido, se produce un error que conlleva a una situación inesperada en la que el código espera indefinidamente el flujo desempaquetado de tar, que nunca termina.&#xa0;Un atacante podría utilizar esta vulnerabilidad para crear una imagen maliciosa, que cuando una aplicación la descarga y almacena mediante contenedores y almacenamiento, provocaría un punto muerto que conduciría a una Denegación de Servicio (DoS)",
  "details": "Due to a goroutine deadlock, using github.com/containers/storage/pkg/archive.DecompressStream on a xz archive returns a reader which will hang indefinitely when Close is called. An attacker can use this to cause denial of service if they are able to cause the caller to attempt to decompress an archive they control",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "7.1"
    },
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/containers/storage"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.28.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/containers/storage/pkg/archive",
            "symbols": [
              "ApplyLayer",
              "ApplyUncompressedLayer",
              "Archiver.CopyFileWithTar",
              "Archiver.CopyWithTar",
              "Archiver.TarUntar",
              "Archiver.UntarPath",
              "CopyResource",
              "CopyTo",
              "DecompressStream",
              "IsArchivePath",
              "Untar",
              "UntarPath",
              "UntarUncompressed",
              "cmdStream"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/containers/storage/pull/860"
    },
    {
      "type": "FIX",
      "url": "https://github.com/containers/storage/commit/306fcabc964470e4b3b87a43a8f6b7d698209ee1"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1939485"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/R5D7XL7FL24TWFMGQ3K2S72EOUSLZMKL/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SPYOHNG2Q7DCAQZMGYLMENLKALGDLG3X/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WX24EITRXVHDM5M223BVTJA2ODF2FSHI/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZNMB7O2UIXE34PGSCSOULGHPX5LIJBMM/"
    },
    {
      "type": "WEB",
      "url": "https://unit42.paloaltonetworks.com/cve-2021-20291/"
    }
  ],
  "credits": [
    {
      "name": "Aviv Sasson (Palo Alto Networks)"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:C",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "COMPLETE",
            "baseScore": 7.1
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 8.6,
          "impactScore": 6.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": true
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "secalert@redhat.com",
        "name": "Primary",
        "description": "CWE-667",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/containers/storage",
        "name": "containers/storage",
        "description": "Container Storage Library",
        "date_created": "2016-07-15T14:48:14Z",
        "date_last_push": "2024-06-13T13:15:33Z",
        "owner": "containers",
        "forks_count": "233",
        "stars_count": "534",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:storage_project:storage:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "89BBBDA6-01A5-4FB5-B662-8AE0B171CD46",
            "versionEndExcluding": "1.28.1"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "932D137F-528B-4526-9A89-CD59FA1AB0FE"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*",
            "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
            "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0100",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}