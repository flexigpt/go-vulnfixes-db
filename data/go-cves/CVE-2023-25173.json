{
  "schema_version": "1.6.3",
  "id": "CVE-2023-25173",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-02-17T20:52:58Z",
  "aliases": [
    "GHSA-hmfx-3pcx-653p",
    "GO-2023-1574"
  ],
  "related": [
    "CVE-2022-36109",
    "GHSA-4wjj-jwc9-2x96",
    "GHSA-rc4r-wh2q-q6c4",
    "GHSA-fjm8-m7m6-2fjp",
    "CVE-2022-2989",
    "CVE-2022-2990",
    "CVE-2022-2995",
    "GHSA-phjr-8j92-w5v7"
  ],
  "summary": "Privilege escalation via supplementary groups in github.com/containerd/containerd. containerd is an open source container runtime. A bug was found in containerd prior to versions 1.6.18 and 1.5.18 where supplementary groups are not set up properly inside a container. If an attacker has direct access to a container and manipulates their supplementary group access, they may be able to use supplementary group access to bypass primary group restrictions in some cases, potentially gaining access to sensitive information or gaining the ability to execute code in that container. Downstream applications that use the containerd client library may be affected as well.\n\nThis bug has been fixed in containerd v1.6.18 and v.1.5.18. Users should update to these versions and recreate containers to resolve this issue. Users who rely on a downstream application that uses containerd's client library should check that application for a separate advisory and instructions. As a workaround, ensure that the `\"USER $USERNAME\"` Dockerfile instruction is not used. Instead, set the container entrypoint to a value similar to `ENTRYPOINT [\"su\", \"-\", \"user\"]` to allow `su` to properly set up supplementary groups. Containerd es contenedor de código abierto en tiempo de ejecución. Se encontró un error en Containerd antes de las versiones 1.6.18 y 1.5.18 donde los grupos suplementarios no están configurados correctamente dentro de un contenedor. Si un atacante tiene acceso directo a un contenedor y manipula su acceso de grupo suplementario, es posible que pueda utilizar el acceso de grupo suplementario para eludir las restricciones del grupo primario en algunos casos, obteniendo potencialmente acceso a información confidencial o obteniendo la capacidad de ejecutar código en ese contenedor. Las aplicaciones posteriores que utilizan la librería cliente en containerd también pueden verse afectadas. Este error se ha solucionado en Containerd v1.6.18 y v.1.5.18. Los usuarios deben actualizar a estas versiones y volver a crear containers para resolver este problema. Los usuarios que dependen de una aplicación posterior que utiliza la librería cliente de Containerd deben verificar esa aplicación para obtener avisos e instrucciones por separado. Como workaround, asegúrese de que no se utilice la instrucción de Dockerfile `\"USER $USERNAME\"`. En su lugar, establezca el punto de entrada del contenedor en un valor similar a `ENTRYPOINT [\"su\", \"-\", \"user\"]` para permitir que `su` configure correctamente grupos suplementarios",
  "details": "Supplementary groups are not set up properly inside a container. If an attacker has direct access to a container and manipulates their supplementary group access, they may be able to use supplementary group access to bypass primary group restrictions in some cases and potentially escalate privileges in the container. Uses of the containerd client library may also have improperly setup supplementary groups",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/containerd/containerd"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.6.0"
            },
            {
              "fixed": "1.6.18"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/containerd/containerd/oci",
            "symbols": [
              "WithAdditionalGIDs",
              "WithUIDGID",
              "WithUser",
              "WithUserID",
              "WithUsername"
            ]
          },
          {
            "path": "github.com/containerd/containerd/pkg/cri/server",
            "symbols": [
              "criService.CreateContainer",
              "criService.containerSpecOpts",
              "instrumentedAlphaService.CreateContainer",
              "instrumentedService.CreateContainer"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/containerd/containerd"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.5.18"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/containerd/containerd/oci",
            "symbols": [
              "WithAdditionalGIDs",
              "WithUIDGID",
              "WithUser",
              "WithUserID",
              "WithUsername"
            ]
          },
          {
            "path": "github.com/containerd/containerd/pkg/cri/server",
            "symbols": [
              "criService.CreateContainer",
              "criService.containerSpecOpts",
              "instrumentedService.CreateContainer"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/containerd/containerd/security/advisories/GHSA-hmfx-3pcx-653p"
    },
    {
      "type": "WEB",
      "url": "https://github.com/moby/moby/security/advisories/GHSA-rc4r-wh2q-q6c4"
    },
    {
      "type": "WEB",
      "url": "https://github.com/containerd/containerd/commit/133f6bb6cd827ce35a5fb279c1ead12b9d21460a"
    },
    {
      "type": "WEB",
      "url": "https://github.com/advisories/GHSA-4wjj-jwc9-2x96"
    },
    {
      "type": "WEB",
      "url": "https://github.com/advisories/GHSA-fjm8-m7m6-2fjp"
    },
    {
      "type": "WEB",
      "url": "https://github.com/advisories/GHSA-phjr-8j92-w5v7"
    },
    {
      "type": "WEB",
      "url": "https://www.benthamsgaze.org/2022/08/22/vulnerability-in-linux-containers-investigation-and-mitigation/"
    },
    {
      "type": "WEB",
      "url": "https://github.com/containerd/containerd/releases/tag/v1.5.18"
    },
    {
      "type": "WEB",
      "url": "https://github.com/containerd/containerd/releases/tag/v1.6.18"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 5.9
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "LOW",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.4
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-863",
        "url": ""
      },
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Secondary",
        "description": "CWE-863",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/containerd/containerd",
        "name": "containerd/containerd",
        "description": "An open and reliable container runtime",
        "date_created": "2015-11-13T00:27:43Z",
        "date_last_push": "2024-06-14T10:14:49Z",
        "owner": "containerd",
        "forks_count": "3300",
        "stars_count": "16607",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "4C98A2DA-3CDD-4438-AECC-DDDA67E61935",
            "versionEndExcluding": "1.5.18"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:containerd:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "BDD5FC3E-BEEB-4CAA-845E-3BADF39E46B2",
            "versionStartIncluding": "1.6.0",
            "versionEndExcluding": "1.6.18"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-1574",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}