{
  "schema_version": "1.6.3",
  "id": "CVE-2021-41230",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-01-14T17:30:31Z",
  "aliases": [
    "GO-2021-0258",
    "GHSA-j6wp-3859-vxfg"
  ],
  "related": [],
  "summary": "Incorrect authorization in github.com/pomerium/pomerium. Pomerium is an open source identity-aware access proxy. In affected versions changes to the OIDC claims of a user after initial login are not reflected in policy evaluation when using `allowed_idp_claims` as part of policy. If using `allowed_idp_claims` and a user's claims are changed, Pomerium can make incorrect authorization decisions. This issue has been resolved in v0.15.6. For users unable to upgrade clear data on `databroker` service by clearing redis or restarting the in-memory databroker to force claims to be updated. Pomerium es un proxy de acceso de código abierto consciente de la identidad. En las versiones afectadas, los cambios en las reclamaciones OIDC de un usuario después del inicio de sesión no son reflejadas en la evaluación de la política cuando es usada \"allowed_idp_claims\" como parte de la política. Si es usada \"allowed_idp_claims\" y se cambian las reclamaciones de un usuario, Pomerium puede tomar decisiones de autorización incorrectas. Este problema se ha resuelto en la versión v0.15.6. Para usuarios que no pueden actualizar los datos claros en el servicio \"databroker\" borrando redis o reiniciando el databroker en memoria para forzar la actualización de las reclamaciones",
  "details": "Pomerium is an open source identity-aware access proxy. Changes to the OIDC claims of a user after initial login are not reflected in policy evaluation when using allowed_idp_claims as part of policy. If using allowed_idp_claims and a user's claims are changed, Pomerium can make incorrect authorization decisions.\n\nFor users unable to upgrade clear data on databroker service by clearing redis or restarting the in-memory databroker to force claims to be updated",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "6.5"
    },
    {
      "type": "CVSS_V3",
      "score": "8.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/pomerium/pomerium"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.15.6"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/pomerium/pomerium/internal/identity/manager",
            "symbols": [
              "Manager.Run",
              "Manager.RunLeased",
              "Manager.onUpdateRecords"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/pomerium/pomerium/pull/2724"
    },
    {
      "type": "FIX",
      "url": "https://github.com/pomerium/pomerium/commit/f20542c4bf2cc691e4c324f7ec79e02e46d95511"
    },
    {
      "type": "WEB",
      "url": "https://github.com/pomerium/pomerium/security/advisories/GHSA-j6wp-3859-vxfg"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.9
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.6,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "SINGLE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 6.5
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.0,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-863",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/pomerium/pomerium",
        "name": "pomerium/pomerium",
        "description": "Pomerium is an identity and context-aware access proxy.",
        "date_created": "2019-01-01T08:04:37Z",
        "date_last_push": "2024-06-13T03:23:46Z",
        "owner": "pomerium",
        "forks_count": "280",
        "stars_count": "3923",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:pomerium:pomerium:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "1D7D97E8-949E-420D-9DE9-16CD88756907",
            "versionStartIncluding": "0.14.0",
            "versionEndExcluding": "0.15.6"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0258",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}