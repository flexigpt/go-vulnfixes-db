{
  "schema_version": "1.6.3",
  "id": "CVE-2024-34360",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-05-14T16:33:28Z",
  "aliases": [
    "GHSA-jcqq-g64v-gcm7",
    "GO-2024-2831"
  ],
  "related": [],
  "summary": "ATX protocol validation problem in github.com/spacemeshos/go-spacemesh. go-spacemesh is a Go implementation of the Spacemesh protocol full node. Nodes can publish activations transactions (ATXs) which reference the incorrect previous ATX of the Smesher that created the ATX. ATXs are expected to form a single chain from the newest to the first ATX ever published by an identity. Allowing Smeshers to reference an earlier (but not the latest) ATX as previous breaks this protocol rule and can serve as an attack vector where Nodes are rewarded for holding their PoST data for less than one epoch but still being eligible for rewards. This vulnerability is fixed in go-spacemesh 1.5.2-hotfix1 and Spacemesh API 1.37.1. go-spacemesh es una implementaci√≥n Go del nodo completo del protocolo Spacemesh. Los nodos pueden publicar transacciones de activaciones (ATX) que hacen referencia al ATX anterior incorrecto del Smesher que cre√≥ el ATX. Se espera que los ATX formen una √∫nica cadena desde el m√°s nuevo hasta el primer ATX jam√°s publicado por una identidad. Permitir que Smeshers haga referencia a un ATX anterior (pero no al √∫ltimo) como anterior rompe esta regla de protocolo y puede servir como un vector de ataque donde los nodos son recompensados por conservar sus datos PoST durante menos de una √©poca pero a√∫n ser elegibles para recibir recompensas. Esta vulnerabilidad se solucion√≥ en go-spacemesh 1.5.2-hotfix1 y Spacemesh API 1.37.1",
  "details": "Nodes can publish ATXs which reference the incorrect previous ATX of the Smesher that created the ATX. ATXs are expected to form a single chain from the newest to the first ATX ever published by an identity. Allowing Smeshers to reference an earlier (but not the latest) ATX as previous breaks this protocol rule",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "8.2"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/spacemeshos/api/release/go"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.37.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/spacemeshos/api/release/go/spacemesh/v1"
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/spacemeshos/go-spacemesh"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.5.2-hotfix1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/spacemeshos/go-spacemesh/activation",
            "symbols": [
              "Handler.HandleGossipAtx",
              "Handler.SyntacticallyValidateDeps",
              "Handler.processATX",
              "Handler.storeAtx"
            ]
          },
          {
            "path": "github.com/spacemeshos/go-spacemesh/events",
            "symbols": [
              "CloseEventReporter",
              "EmitAtxPublished",
              "EmitBeacon",
              "EmitEligibilities",
              "EmitInitComplete",
              "EmitInitFailure",
              "EmitInitStart",
              "EmitInvalidPostProof",
              "EmitOwnMalfeasanceProof",
              "EmitPoetWaitProof",
              "EmitPoetWaitRound",
              "EmitPostComplete",
              "EmitPostFailure",
              "EmitPostServiceStarted",
              "EmitPostServiceStopped",
              "EmitPostStart",
              "EmitProposal",
              "InitializeReporter",
              "LayerUpdate.Field",
              "ReportAccountUpdate",
              "ReportError",
              "ReportLayerUpdate",
              "ReportMalfeasance",
              "ReportNewActivation",
              "ReportNewTx",
              "ReportNodeStatusUpdate",
              "ReportProposal",
              "ReportResult",
              "ReportRewardReceived",
              "ReportTxWithValidity",
              "SubcribeProposals",
              "Subscribe",
              "SubscribeAccount",
              "SubscribeActivations",
              "SubscribeErrors",
              "SubscribeLayers",
              "SubscribeMalfeasance",
              "SubscribeMatched",
              "SubscribeRewards",
              "SubscribeStatus",
              "SubscribeToLayers",
              "SubscribeTxs",
              "SubscribeUserEvents",
              "ToMalfeasancePB"
            ]
          },
          {
            "path": "github.com/spacemeshos/go-spacemesh/malfeasance",
            "symbols": [
              "Handler.HandleSyncedMalfeasanceProof",
              "Validate"
            ]
          },
          {
            "path": "github.com/spacemeshos/go-spacemesh/malfeasance/wire",
            "symbols": [
              "AtxProof.DecodeScale",
              "AtxProof.MarshalLogObject",
              "AtxProofMsg.DecodeScale",
              "AtxProofMsg.SignedBytes",
              "BallotProof.DecodeScale",
              "BallotProof.MarshalLogObject",
              "BallotProofMsg.DecodeScale",
              "BallotProofMsg.SignedBytes",
              "HareMetadata.DecodeScale",
              "HareMetadata.ToBytes",
              "HareProof.DecodeScale",
              "HareProof.MarshalLogObject",
              "HareProofMsg.DecodeScale",
              "HareProofMsg.SignedBytes",
              "InvalidPostIndexProof.DecodeScale",
              "InvalidPostIndexProof.EncodeScale",
              "MalfeasanceGossip.DecodeScale",
              "MalfeasanceGossip.EncodeScale",
              "MalfeasanceInfo",
              "MalfeasanceProof.DecodeScale",
              "MalfeasanceProof.EncodeScale",
              "MalfeasanceProof.MarshalLogObject",
              "Proof.DecodeScale",
              "Proof.EncodeScale"
            ]
          },
          {
            "path": "github.com/spacemeshos/go-spacemesh/node",
            "symbols": [
              "App.setupDBs",
              "App.verifyDB"
            ]
          },
          {
            "path": "github.com/spacemeshos/go-spacemesh/sql/atxs",
            "symbols": [
              "Add",
              "AddGettingNonce",
              "IterateIDsByEpoch"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/spacemeshos/go-spacemesh/security/advisories/GHSA-jcqq-g64v-gcm7"
    },
    {
      "type": "WEB",
      "url": "https://github.com/spacemeshos/api/commit/1d5bd972bbe225d024c3e0ae5214ddb6b481716e"
    },
    {
      "type": "WEB",
      "url": "https://github.com/spacemeshos/go-spacemesh/commit/9aff88d54be809ac43d60e8a8b4d65359c356b87"
    },
    {
      "type": "WEB",
      "url": "https://spacemesh.io/blog/spacemesh-white-paper-1"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 8.2,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 4.2
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-754",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/spacemeshos/api",
        "name": "spacemeshos/api",
        "description": "Protobuf implementation of the Spacemesh API",
        "date_created": "2020-04-28T15:24:21Z",
        "date_last_push": "2024-06-12T08:02:27Z",
        "owner": "spacemeshos",
        "forks_count": "8",
        "stars_count": "14",
        "repo_language": "Makefile"
      },
      {
        "url": "https://github.com/spacemeshos/go-spacemesh",
        "name": "spacemeshos/go-spacemesh",
        "description": "Go Implementation of the Spacemesh protocol full node. üíæ‚è∞üí™",
        "date_created": "2017-10-26T06:43:09Z",
        "date_last_push": "2024-06-14T09:41:50Z",
        "owner": "spacemeshos",
        "forks_count": "211",
        "stars_count": "746",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2831",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}