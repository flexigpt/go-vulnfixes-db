{
  "schema_version": "1.6.3",
  "id": "CVE-2020-8918",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-04-14T20:04:52Z",
  "aliases": [
    "GHSA-5x29-3hr9-6wpw",
    "GO-2021-0095"
  ],
  "related": [],
  "summary": "Sensitive information exposure in github.com/google/go-tpm. An improperly initialized 'migrationAuth' value in Google's go-tpm TPM1.2 library versions prior to 0.3.0 can lead an eavesdropping attacker to discover the auth value for a key created with CreateWrapKey. An attacker listening in on the channel can collect both 'encUsageAuth' and 'encMigrationAuth', and then can calculate 'usageAuth ^ encMigrationAuth' as the 'migrationAuth' can be guessed for all keys created with CreateWrapKey. TPM2.0 is not impacted by this. We recommend updating your library to 0.3.0 or later, or, if you cannot update, to call CreateWrapKey with a random 20-byte value for 'migrationAuth'. Un valor de \"migrationAuth\" inicializado inapropiadamente en la biblioteca go-tpm TPM1.2 de Google versiones anteriores a 0.3.0, puede conllevar a un atacante que espía a detectar el valor de autenticación de una clave creada con CreateWrapKey. Un atacante que escucha en el canal puede recopilar \"encUsageAuth\" y \"encMigrationAuth\", y luego puede calcular \"useAuth ^ encMigrationAuth\" ya que se puede adivinar \"migrationAuth\" para todas las claves creadas con CreateWrapKey. TPM2.0 no está afectado por esto. Recomendamos actualizar su biblioteca a la versión 0.3.0 o posterior o, si no puede actualizar, llamar a CreateWrapKey con un valor aleatorio de 20 bytes para \"migrationAuth\"",
  "details": "Due to repeated usage of a XOR key an attacker that can eavesdrop on the TPM 1.2 transport is able to calculate usageAuth for keys created using CreateWrapKey, despite it being encrypted, allowing them to use the created key",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "3.6"
    },
    {
      "type": "CVSS_V3",
      "score": "7.1"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/google/go-tpm"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.3.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/google/go-tpm/tpm",
            "symbols": [
              "CreateWrapKey"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/google/go-tpm/pull/195"
    },
    {
      "type": "FIX",
      "url": "https://github.com/google/go-tpm/commit/d7806cce857a1a020190c03348e5361725d8f141"
    },
    {
      "type": "WEB",
      "url": "https://github.com/google/go-tpm/security/advisories/GHSA-5x29-3hr9-6wpw"
    }
  ],
  "credits": [
    {
      "name": "Chris Fenner"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 5.2
        },
        {
          "source": "cve-coordination@google.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 6.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.0,
          "impactScore": 5.2
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:N",
            "accessVector": "LOCAL",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 3.6
          },
          "baseSeverity": "LOW",
          "exploitabilityScore": 3.9,
          "impactScore": 4.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-665",
        "url": ""
      },
      {
        "cwe_id": "cve-coordination@google.com",
        "name": "Secondary",
        "description": "CWE-665",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/google/go-tpm",
        "name": "google/go-tpm",
        "date_created": "2014-08-13T19:53:34Z",
        "date_last_push": "2024-06-13T12:11:06Z",
        "owner": "google",
        "forks_count": "155",
        "stars_count": "533",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:google:go-tpm:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "4C01295C-C049-40D7-AB0A-58BAEEC81283",
            "versionEndExcluding": "0.3.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0095",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}