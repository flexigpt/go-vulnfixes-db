{
  "schema_version": "1.6.3",
  "id": "CVE-2023-25568",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-06-14T17:22:51Z",
  "aliases": [
    "GHSA-m974-xj4j-7qv5",
    "GO-2023-1766",
    "GHSA-q3j6-22wf-3jh9"
  ],
  "related": [],
  "summary": "Denial of service from memory leak in github.com/ipfs/go-libipfs. Boxo, formerly known as go-libipfs, is a library for building IPFS applications and implementations. In versions 0.4.0 and 0.5.0, if an attacker is able allocate arbitrary many bytes in the Bitswap server, those allocations are lasting even if the connection is closed. This affects users accepting untrusted connections with the Bitswap server and also affects users using the old API stubs at `github.com/ipfs/go-libipfs/bitswap` because users then transitively import `github.com/ipfs/go-libipfs/bitswap/server`. Boxo versions 0.6.0 and 0.4.1 contain a patch for this issue. As a workaround, those who are using the stub object at `github.com/ipfs/go-libipfs/bitswap` not taking advantage of the features provided by the server can refactor their code to use the new split API that will allow them to run in a client only mode: `github.com/ipfs/go-libipfs/bitswap/client`",
  "details": "An attacker can cause a Bitswap server to allocate and leak unbounded amounts of memory",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/ipfs/go-libipfs"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.4.1"
            },
            {
              "introduced": "0.5.0"
            },
            {
              "fixed": "0.6.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/ipfs/go-libipfs/bitswap/server"
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/ipfs/go-bitswap"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.12.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/ipfs/go-bitswap/server"
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ipfs/go-libipfs/security/advisories/GHSA-m974-xj4j-7qv5"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ipfs/boxo/commit/62cbac40b96f49e39cd7fedc77ee6b56adce4916"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ipfs/boxo/commit/9cb5cb54d40b57084d1221ba83b9e6bb3fcc3197"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ipfs/boxo/commit/baa748b682fabb21a4c1f7628a8af348d4645974"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "LOW",
            "availabilityImpact": "HIGH",
            "baseScore": 8.2,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 4.2
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-770",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-400 CWE-770",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/ipfs/boxo",
        "name": "ipfs/boxo",
        "description": "A set of reference libraries for building IPFS applications and implementations in Go.",
        "date_created": "2022-11-28T20:48:23Z",
        "date_last_push": "2024-06-24T09:10:48Z",
        "owner": "ipfs",
        "forks_count": "77",
        "stars_count": "181",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/ipfs/boxo",
        "name": "ipfs/boxo",
        "description": "A set of reference libraries for building IPFS applications and implementations in Go.",
        "date_created": "2022-11-28T20:48:23Z",
        "date_last_push": "2024-06-24T09:10:48Z",
        "owner": "ipfs",
        "forks_count": "77",
        "stars_count": "181",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/ipfs/boxo",
        "name": "ipfs/boxo",
        "description": "A set of reference libraries for building IPFS applications and implementations in Go.",
        "date_created": "2022-11-28T20:48:23Z",
        "date_last_push": "2024-06-24T09:10:48Z",
        "owner": "ipfs",
        "forks_count": "77",
        "stars_count": "181",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:protocol:boxo:0.4.0:*:*:*:*:go:*:*",
            "matchCriteriaId": "E5D4F0B2-1C1A-4BBB-B133-EB87E61AD2B3"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:protocol:boxo:0.5.0:*:*:*:*:go:*:*",
            "matchCriteriaId": "ECB93B03-A1E1-4A87-994C-2AC70D3FF5CA"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-1766",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}