{
  "schema_version": "1.6.3",
  "id": "CVE-2022-23492",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-12-14T02:21:28Z",
  "aliases": [
    "GO-2022-1148",
    "GHSA-j7qp-mfxf-8xjw"
  ],
  "related": [],
  "summary": "Resource exhaustion in github.com/libp2p/go-libp2p. go-libp2p is the offical libp2p implementation in the Go programming language. Version `0.18.0` and older of go-libp2p are vulnerable to targeted resource exhaustion attacks. These attacks target libp2p’s connection, stream, peer, and memory management. An attacker can cause the allocation of large amounts of memory, ultimately leading to the process getting killed by the host’s operating system. While a connection manager tasked with keeping the number of connections within manageable limits has been part of go-libp2p, this component was designed to handle the regular churn of peers, not a targeted resource exhaustion attack. Users are advised to upgrade their version of go-libp2p to version `0.18.1` or newer. Users unable to upgrade may consult the denial of service (dos) mitigation page for more information on how to incorporate mitigation strategies, monitor your application, and respond to attacks. go-libp2p es la implementación oficial de libp2p en el lenguaje de programación Go. La versión `0.18.0` y anteriores de go-libp2p son vulnerables a ataques de agotamiento de recursos dirigidos. Estos ataques tienen como objetivo la gestión de conexión, flujo, pares y memoria de libp2p. Un atacante puede provocar la asignación de grandes cantidades de memoria, lo que en última instancia lleva a que el sistema operativo del host elimine el proceso. Si bien un administrador de conexiones encargado de mantener la cantidad de conexiones dentro de los límites manejables ha sido parte de go-libp2p, este componente fue diseñado para manejar la rotación regular de pares, no un ataque de agotamiento de recursos dirigido. Se recomienda a los usuarios que actualicen su versión de go-libp2p a la versión `0.18.1` o más reciente. Los usuarios que no puedan actualizar pueden consultar la página de mitigación de Denegación de Servicio (DoS) (dos) para obtener más información sobre cómo incorporar estrategias de mitigación, monitorizar su aplicación y responder a los ataques",
  "details": "go-libp2p is vulnerable to targeted resource exhaustion attacks.\n\nThese attacks target libp2p's connection, stream, peer, and memory management. An attacker can cause the allocation of large amounts of memory ultimately leading to the process getting killed by the host's operating system.\n\nWhile a connection manager tasked with keeping the number of connections within manageable limits has been part of go-libp2p, this component was designed to handle the regular churn of peers, not a targeted resource exhaustion attack.\n\nIt's recommend to update to v0.21.0 onwards to get some useful functionality that will help in production environments like better metrics around resource usage, Grafana dashboards around resource usage, allow list support, and default autoscaling limits",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/libp2p/go-libp2p"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.18.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/libp2p/go-libp2p",
            "symbols": [
              "DefaultStaticRelays",
              "Muxer",
              "New",
              "NewWithoutDefaults",
              "Security",
              "Transport"
            ]
          },
          {
            "path": "github.com/libp2p/go-libp2p/config",
            "symbols": [
              "Config.NewNode",
              "MuxerConstructor",
              "SecurityConstructor",
              "TransportConstructor",
              "makeArgumentConstructors",
              "makeConstructor",
              "makeMuxer",
              "makeTransports"
            ]
          },
          {
            "path": "github.com/libp2p/go-libp2p/p2p/host/autonat",
            "symbols": [
              "New",
              "autoNATService.handleStream",
              "client.DialBack"
            ]
          },
          {
            "path": "github.com/libp2p/go-libp2p/p2p/host/basic",
            "symbols": [
              "BasicHost.newStreamHandler",
              "NewHost"
            ]
          },
          {
            "path": "github.com/libp2p/go-libp2p/p2p/protocol/circuitv1/relay",
            "symbols": [
              "NewRelay"
            ]
          },
          {
            "path": "github.com/libp2p/go-libp2p/p2p/protocol/circuitv2/client",
            "symbols": [
              "Client.Dial",
              "Client.connectV1",
              "Client.connectV2"
            ]
          },
          {
            "path": "github.com/libp2p/go-libp2p/p2p/protocol/circuitv2/relay",
            "symbols": [
              "New",
              "Relay.Close",
              "Relay.handleConnect",
              "Relay.handleStream"
            ]
          },
          {
            "path": "github.com/libp2p/go-libp2p/p2p/protocol/holepunch",
            "symbols": [
              "Service.DirectConnect",
              "Service.handleNewStream",
              "Service.incomingHolePunch",
              "Service.initiateHolePunch",
              "netNotifiee.Connected"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/libp2p/go-libp2p/security/advisories/GHSA-j7qp-mfxf-8xjw"
    },
    {
      "type": "WEB",
      "url": "https://github.com/libp2p/go-libp2p/commit/15d7dfbf54264ead8e6f49ca658d79c90635e2de"
    },
    {
      "type": "WEB",
      "url": "https://docs.libp2p.io/reference/dos-mitigation/"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-770",
        "url": ""
      },
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-400",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/libp2p/go-libp2p",
        "name": "libp2p/go-libp2p",
        "description": "libp2p implementation in Go",
        "date_created": "2015-09-30T23:24:32Z",
        "date_last_push": "2024-06-13T17:43:53Z",
        "owner": "libp2p",
        "forks_count": "1031",
        "stars_count": "5808",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:protocol:libp2p:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "DC28B9D1-484A-4395-BDF7-C238C07EB7C1",
            "versionEndExcluding": "0.18.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1148",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}