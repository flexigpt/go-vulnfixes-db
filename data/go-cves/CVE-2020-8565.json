{
  "schema_version": "1.6.3",
  "id": "CVE-2020-8565",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-04-14T20:04:52Z",
  "aliases": [
    "GO-2021-0064",
    "GHSA-8cfg-vx93-jvxw"
  ],
  "related": [],
  "summary": "Unauthorized credential disclosure via debug logs in k8s.io/kubernetes and k8s.io/client-go. In Kubernetes, if the logging level is set to at least 9, authorization and bearer tokens will be written to log files. This can occur both in API server logs and client tool output like kubectl. This affects <= v1.19.3, <= v1.18.10, <= v1.17.13, < v1.20.0-alpha2. En Kubernetes, si el nivel de registro se establece en al menos 9, los tokens de autorización y portador se escribirán en los archivos de registro. Esto puede ocurrir tanto en los registros del servidor API como en la salida de la herramienta cliente como kubectl. Esto afecta a versiones anteriores e iguales a v1.19.3, versiones anteriores e iguales a v1.18.10, versiones anteriores e iguales a v1.17.13, versiones anteriores a v1.20.0-alpha2",
  "details": "Authorization tokens may be inappropriately logged if the verbosity level is set to a debug level. This is due to an incomplete fix for CVE-2019-11250",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "2.1"
    },
    {
      "type": "CVSS_V3",
      "score": "5.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "k8s.io/client-go"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.20.0-alpha.2"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "k8s.io/client-go/transport",
            "symbols": [
              "basicAuthRoundTripper.RoundTrip",
              "bearerAuthRoundTripper.RoundTrip",
              "debuggingRoundTripper.RoundTrip",
              "impersonatingRoundTripper.RoundTrip",
              "requestInfo.toCurl",
              "userAgentRoundTripper.RoundTrip"
            ]
          }
        ]
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "k8s.io/kubernetes"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.20.0-alpha.2"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "k8s.io/kubernetes/staging/src/k8s.io/client-go/transport",
            "symbols": [
              "requestInfo.toCurl"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/kubernetes/kubernetes/pull/95316"
    },
    {
      "type": "FIX",
      "url": "https://github.com/kubernetes/kubernetes/commit/e99df0e5a75eb6e86123b56d53e9b7ca0fd00419"
    },
    {
      "type": "WEB",
      "url": "https://github.com/kubernetes/kubernetes/issues/95623"
    },
    {
      "type": "WEB",
      "url": "https://groups.google.com/g/kubernetes-security-discuss/c/vm-HcrFUOCs/m/36utxAM5CwAJ"
    }
  ],
  "credits": [
    {
      "name": "@sfowl"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.6
        },
        {
          "source": "jordan@liggitt.net",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.7,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.0,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:L/Au:N/C:P/I:N/A:N",
            "accessVector": "LOCAL",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 2.1
          },
          "baseSeverity": "LOW",
          "exploitabilityScore": 3.9,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-532",
        "url": ""
      },
      {
        "cwe_id": "jordan@liggitt.net",
        "name": "Secondary",
        "description": "CWE-532",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/kubernetes/kubernetes",
        "name": "kubernetes/kubernetes",
        "description": "Production-Grade Container Scheduling and Management",
        "date_created": "2014-06-06T22:56:04Z",
        "date_last_push": "2024-06-14T11:54:55Z",
        "owner": "kubernetes",
        "forks_count": "38735",
        "stars_count": "107856",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "BAC4DF80-12A5-482D-88C8-1939A015FBE4",
            "versionStartIncluding": "1.17.0",
            "versionEndIncluding": "1.17.13"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "57F3AFC9-8D1D-4870-B40E-5A2CFEB2388E",
            "versionStartIncluding": "1.18.0",
            "versionEndIncluding": "1.18.10"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "13CE6526-CD5D-4B0D-AE8C-20E113F2D412",
            "versionStartIncluding": "1.19.0",
            "versionEndIncluding": "1.19.3"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0064",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}