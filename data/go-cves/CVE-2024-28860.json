{
  "schema_version": "1.6.3",
  "id": "CVE-2024-28860",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-04-16T17:25:46Z",
  "aliases": [
    "GHSA-pwqm-x5x6-5586",
    "GO-2024-2666"
  ],
  "related": [],
  "summary": "Insecure IPsec transparent encryption in github.com/cilium/cilium. Cilium is a networking, observability, and security solution with an eBPF-based dataplane. Users of IPsec transparent encryption in Cilium may be vulnerable to cryptographic attacks that render the transparent encryption ineffective. In particular, Cilium is vulnerable to chosen plaintext, key recovery, replay attacks by a man-in-the-middle attacker. These attacks are possible due to an ESP sequence number collision when multiple nodes are configured with the same key. Fixed versions of Cilium use unique keys for each IPsec tunnel established between nodes, resolving all of the above attacks. This vulnerability is fixed in 1.13.13, 1.14.9, and 1.15.3. Cilium es una solución de redes, observabilidad y seguridad con un plano de datos basado en eBPF. Los usuarios de cifrado transparente IPsec en Cilium pueden ser vulnerables a ataques criptográficos que hagan que el cifrado transparente sea ineficaz. En particular, Cilium es vulnerable a texto plano elegido, recuperación de claves y ataques de repetición por parte de un atacante intermediario. Estos ataques son posibles debido a una colisión del número de secuencia ESP cuando se configuran varios nodos con la misma clave. Las versiones fijas de Cilium utilizan claves únicas para cada túnel IPsec establecido entre nodos, resolviendo todos los ataques anteriores. Esta vulnerabilidad se solucionó en 1.13.13, 1.14.9 y 1.15.3",
  "details": "Insecure IPsec transparent encryption in github.com/cilium/cilium",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "8.0"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/cilium/cilium"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.13.14"
            },
            {
              "introduced": "1.14.0"
            },
            {
              "fixed": "1.14.9"
            },
            {
              "introduced": "1.15.0"
            },
            {
              "fixed": "1.15.3"
            }
          ]
        }
      ],
      "ecosystem_specific": {}
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/cilium/cilium/security/advisories/GHSA-pwqm-x5x6-5586"
    },
    {
      "type": "WEB",
      "url": "https://docs.cilium.io/en/stable/security/network/encryption-ipsec"
    },
    {
      "type": "WEB",
      "url": "https://github.com/cilium/cilium/commit/311fbce5280491cddceab178d83b06fa23688c72"
    },
    {
      "type": "WEB",
      "url": "https://github.com/cilium/cilium/commit/a1742b478306fa256cd27df1039dfae0537b4149"
    },
    {
      "type": "WEB",
      "url": "https://github.com/cilium/cilium/commit/a652c123331852cca90c74202f993d4170fd37fa"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N",
            "attackVector": "ADJACENT_NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 8.0,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.6,
          "impactScore": 5.8
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-326",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/cilium/cilium",
        "name": "cilium/cilium",
        "description": "eBPF-based Networking, Security, and Observability",
        "date_created": "2015-12-16T12:33:31Z",
        "date_last_push": "2024-06-24T09:56:22Z",
        "owner": "cilium",
        "forks_count": "2772",
        "stars_count": "19133",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/cilium/cilium",
        "name": "cilium/cilium",
        "description": "eBPF-based Networking, Security, and Observability",
        "date_created": "2015-12-16T12:33:31Z",
        "date_last_push": "2024-06-24T09:56:22Z",
        "owner": "cilium",
        "forks_count": "2772",
        "stars_count": "19133",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/cilium/cilium",
        "name": "cilium/cilium",
        "description": "eBPF-based Networking, Security, and Observability",
        "date_created": "2015-12-16T12:33:31Z",
        "date_last_push": "2024-06-24T09:56:22Z",
        "owner": "cilium",
        "forks_count": "2772",
        "stars_count": "19133",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2666",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}