{
  "schema_version": "1.6.3",
  "id": "CVE-2023-45683",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-10-24T16:45:15Z",
  "aliases": [
    "GO-2023-2114",
    "GHSA-267v-3v32-g6q5"
  ],
  "related": [],
  "summary": "Cross-site scripting via missing binding syntax validation in github.com/crewjam/saml. github.com/crewjam/saml is a saml library for the go language. In affected versions the package does not validate the ACS Location URI according to the SAML binding being parsed. If abused, this flaw allows attackers to register malicious Service Providers at the IdP and inject Javascript in the ACS endpoint definition, achieving Cross-Site-Scripting (XSS) in the IdP context during the redirection at the end of a SAML SSO Flow. Consequently, an attacker may perform any authenticated action as the victim once the victim’s browser loaded the SAML IdP initiated SSO link for the malicious service provider. Note: SP registration is commonly an unrestricted operation in IdPs, hence not requiring particular permissions or publicly accessible to ease the IdP interoperability. This issue is fixed in version 0.4.14. Users unable to upgrade may perform external validation of URLs provided in SAML metadata, or restrict the ability for end-users to upload arbitrary metadata. github.com/crewjam/saml es una librería saml para el lenguaje go. En las versiones afectadas, el paquete no valida el URI de ubicación ACS según el enlace SAML que se analiza. Si se abusa de ella, esta falla permite a los atacantes registrar proveedores de servicios maliciosos en el IdP e inyectar Javascript en la definición del endpoint ACS, logrando Cross-Site-Scripting (XSS) en el contexto del IdP durante la redirección al final de un flujo SSO SAML. En consecuencia, un atacante puede realizar cualquier acción autenticada como víctima una vez que el navegador de la víctima cargó el enlace SSO iniciado por el IdP SAML para el proveedor de servicios malicioso. Nota: El registro de SP suele ser una operación sin restricciones en los IdP, por lo que no requiere permisos particulares ni es de acceso público para facilitar la interoperabilidad del IdP. Este problema se solucionó en la versión 0.4.14. Los usuarios que no puedan actualizar pueden realizar una validación externa de las URL proporcionadas en los metadatos SAML o restringir la capacidad de los usuarios finales de cargar metadatos arbitrarios",
  "details": "The package does not validate the ACS Location URI according to the SAML binding being parsed. If abused, this flaw allows attackers to register malicious Service Providers at the IdP and inject Javascript in the ACS endpoint definition, achieving Cross-Site-Scripting (XSS) in the IdP context during the redirection at the end of a SAML SSO Flow. Consequently, an attacker may perform any authenticated action as the victim once the victim's browser loads the SAML IdP initiated SSO link for the malicious service provider",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "6.1"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/crewjam/saml"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.4.14"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/crewjam/saml"
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/crewjam/saml/security/advisories/GHSA-267v-3v32-g6q5"
    },
    {
      "type": "WEB",
      "url": "https://github.com/crewjam/saml/commit/b07b16cf83c4171d16da4d85608cb827f183cd79"
    }
  ],
  "credits": [
    {
      "name": "Francesco Lacerenza from Doyensec"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 6.1,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 2.7
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "LOW",
            "baseScore": 7.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.7
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-79",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/crewjam/saml",
        "name": "crewjam/saml",
        "description": "SAML library for go",
        "date_created": "2015-11-30T04:42:00Z",
        "date_last_push": "2024-05-17T10:10:15Z",
        "owner": "crewjam",
        "forks_count": "420",
        "stars_count": "930",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:saml_project:saml:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "0962FF33-8E54-4E11-8D06-11F261059453",
            "versionEndExcluding": "0.4.14"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2114",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}