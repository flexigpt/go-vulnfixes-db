{
  "schema_version": "1.6.3",
  "id": "CVE-2023-37896",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-08-23T14:38:50Z",
  "aliases": [
    "GO-2023-1998",
    "GHSA-2xx4-jj5v-6mff"
  ],
  "related": [],
  "summary": "Improper path sanitization in sandbox mode in github.com/projectdiscovery/nuclei/v2. Nuclei is a vulnerability scanner. Prior to version 2.9.9, a security issue in the Nuclei project affected users utilizing Nuclei as Go code (SDK) running custom templates. This issue did not affect CLI users. The problem was related to sanitization issues with payload loading in sandbox mode. There was a potential risk with payloads loading in sandbox mode. The issue occurred due to relative paths not being converted to absolute paths before doing the check for `sandbox` flag allowing arbitrary files to be read on the filesystem in certain cases when using Nuclei from `Go` SDK implementation. \n\nThis issue has been fixed in version 2.9.9. The maintainers have also enabled sandbox by default for filesystem loading. This can be optionally disabled if required. The `-sandbox` option has been deprecated and is now divided into two new options: `-lfa` (allow local file access) which is enabled by default and `-lna` (restrict local network access) which can be enabled by users optionally. The `-lfa` allows file (payload) access anywhere on the system (disabling sandbox effectively), and `-lna` blocks connections to the local/private network. \"Nuclei es un escáner de vulnerabilidades. Antes de la versión 2.9.9, un problema de seguridad en el proyecto Nuclei afectaba a los usuarios que utilizaban Nuclei como código Go (SDK) ejecutando plantillas personalizadas. Este problema no afectaba a los usuarios de CLI. El problema estaba relacionado con problemas de sanitización con la carga de payload en modo sandbox. Existía un riesgo potencial con la carga de payloads en modo sandbox. El problema se debía a que las rutas relativas no se convertían en rutas absolutas antes de realizar la comprobación del indicador `sandbox`, lo que permitía la lectura de archivos arbitrarios en el sistema de archivos en determinados casos cuando se utilizaba la implementación del SDK Nuclei from `Go`. \n\nEste problema se ha solucionado en la versión 2.9.9. Los mantenedores también han habilitado sandbox por defecto para la carga del sistema de archivos. Esto se puede desactivar opcionalmente si es necesario. La opción `-sandbox` ha quedado obsoleta y ahora se divide en dos nuevas opciones: `-lfa` (permitir el acceso local a ficheros) que está activada por defecto y `-lna` (restringir el acceso local a la red) que puede ser activada por los usuarios opcionalmente. El `-lfa` permite el acceso a archivos (payload) en cualquier parte del sistema (deshabilitando efectivamente el sandbox), y `-lna` bloquea las conexiones a la red local/privada.\"",
  "details": "Improper path sanitization in sandbox mode in github.com/projectdiscovery/nuclei/v2",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/projectdiscovery/nuclei/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.9.9"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/projectdiscovery/nuclei/v2/cmd/nuclei",
            "symbols": [
              "init#1",
              "main",
              "readConfig"
            ]
          },
          {
            "path": "github.com/projectdiscovery/nuclei/v2/pkg/protocols/common/generators",
            "symbols": [
              "New",
              "PayloadGenerator.loadPayloads"
            ]
          },
          {
            "path": "github.com/projectdiscovery/nuclei/v2/pkg/protocols/common/protocolstate",
            "symbols": [
              "Init"
            ]
          },
          {
            "path": "github.com/projectdiscovery/nuclei/v2/pkg/protocols/dns",
            "symbols": [
              "Request.Compile"
            ]
          },
          {
            "path": "github.com/projectdiscovery/nuclei/v2/pkg/protocols/http",
            "symbols": [
              "Request.Compile"
            ]
          },
          {
            "path": "github.com/projectdiscovery/nuclei/v2/pkg/protocols/headless",
            "symbols": [
              "Request.Compile"
            ]
          },
          {
            "path": "github.com/projectdiscovery/nuclei/v2/pkg/protocols/network",
            "symbols": [
              "Request.Compile"
            ]
          },
          {
            "path": "github.com/projectdiscovery/nuclei/v2/pkg/protocols/websocket",
            "symbols": [
              "Request.Compile"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/projectdiscovery/nuclei/security/advisories/GHSA-2xx4-jj5v-6mff"
    },
    {
      "type": "WEB",
      "url": "https://github.com/projectdiscovery/nuclei/pull/3927"
    },
    {
      "type": "WEB",
      "url": "https://github.com/projectdiscovery/nuclei/releases/tag/v2.9.9"
    }
  ],
  "credits": [
    {
      "name": "keomutchoiboi"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-22",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:projectdiscovery:nuclei:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "645B1A56-6CB4-40CC-B443-38CB78CA657B",
            "versionEndExcluding": "2.9.9"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-1998",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}