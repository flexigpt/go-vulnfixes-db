{
  "schema_version": "1.6.3",
  "id": "CVE-2022-24968",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-29T20:00:14Z",
  "aliases": [
    "GO-2022-0370",
    "GHSA-h289-x5wc-xcv8",
    "GHSA-m658-p24x-p74r"
  ],
  "related": [],
  "summary": "Man-in-the-middle attack due to improper validation of certificate in mellium.im/xmpp. In Mellium mellium.im/xmpp through 0.21.0, an attacker capable of spoofing DNS TXT records can redirect a WebSocket connection request to a server under their control without causing TLS certificate verification to fail. This occurs because the wrong host name is selected during this verification. En Mellium mellium.im/xmpp versiones hasta 0.21.0, un atacante capaz de falsificar los registros TXT de DNS puede redirigir una petici贸n de conexi贸n WebSocket a un servidor bajo su control sin causar que falle la verificaci贸n del certificado TLS. Esto ocurre porque es seleccionado el nombre de host equivocado durante esta verificaci贸n",
  "details": "Websocket client connections are vulnerable to man-in-the-middle attacks via DNS spoofing.\n\nWhen looking up a WSS endpoint using a DNS TXT record, the server TLS certificate is incorrectly validated using the name of the server returned by the TXT record request, not the name of the the server being connected to. This permits any attacker that can spoof a DNS record to redirect the user to a server of their choosing.\n\nProviding a *tls.Config with a ServerName field set to the correct destination hostname will avoid this issue",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.3"
    },
    {
      "type": "CVSS_V3",
      "score": "5.9"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "mellium.im/xmpp"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.18.0"
            },
            {
              "fixed": "0.21.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "mellium.im/xmpp/websocket",
            "symbols": [
              "Dial",
              "DialDirect",
              "DialSession",
              "Dialer.Dial",
              "Dialer.DialDirect",
              "Dialer.config",
              "NewClient"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://mellium.im/cve/cve-2022-24968/"
    },
    {
      "type": "FIX",
      "url": "https://github.com/mellium/xmpp/pull/260"
    },
    {
      "type": "FIX",
      "url": "https://github.com/mellium/xmpp/commit/0d92aa486da69b71f2f4a30e62aa722c711b98ac"
    },
    {
      "type": "REPORT",
      "url": "https://mellium.im/issue/259"
    },
    {
      "type": "WEB",
      "url": "https://mellium.im/xmpp/"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 4.3
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-295",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/mellium/xmpp",
        "name": "mellium/xmpp",
        "description": "An implementation of the Extensible Messaging and Presence Protocol (XMPP) in Go.",
        "date_created": "2018-02-24T19:19:45Z",
        "date_last_push": "2023-08-27T12:38:11Z",
        "owner": "mellium",
        "forks_count": "21",
        "stars_count": "113",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:mellium:xmpp:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "A1A8F9E5-E5EF-481D-96C7-6461EBE64071",
            "versionStartIncluding": "0.18.0",
            "versionEndExcluding": "0.21.1"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0370",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}