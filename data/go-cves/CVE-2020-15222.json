{
  "schema_version": "1.6.3",
  "id": "CVE-2020-15222",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-07-28T18:08:05Z",
  "aliases": [
    "GO-2021-0110",
    "GHSA-v3q9-2p3m-7g43"
  ],
  "related": [],
  "summary": "Token reuse in github.com/ory/fosite. In ORY Fosite (the security first OAuth2 & OpenID Connect framework for Go) before version 0.31.0, when using \"private_key_jwt\" authentication the uniqueness of the `jti` value is not checked. When using client authentication method \"private_key_jwt\", OpenId specification says the following about assertion `jti`: \"A unique identifier for the token, which can be used to prevent reuse of the token. These tokens MUST only be used once, unless conditions for reuse were negotiated between the parties\". Hydra does not seem to check the uniqueness of this `jti` value. This problem is fixed in version 0.31.0. En ORY Fosite (el primer framework de seguridad OAuth2 &amp; OpenID Connect para Go) anterior a la versión 0.31.0, cuando se usa la autenticación \"private_key_jwt\", no se verifica la unicidad del valor \"jti\".&#xa0;Cuando se usa el método de autenticación de cliente \"private_key_jwt\", la especificación de OpenId dice lo siguiente sobre la aserción de \"jti\": \"Un identificador único para el token, que se puede usar para impedir la reutilización del token. Estos tokens DEBEN serán usados una sola vez, a menos que existan condiciones para la reutilización se negociaba entre las partes\".&#xa0;Hydra no parece comprobar la unicidad de este valor \"jti\".&#xa0;Este problema se corrigió en la versión 0.31.0. CWE-345",
  "details": "Uniqueness of JWT IDs (jti) are not checked, allowing the JWT to be replayed. In ORY Fosite (the security first OAuth2 & OpenID Connect framework for Go) before version 0.31.0, when using \"private_key_jwt\" authentication the uniqueness of the `jti` value is not checked. When using client authentication method \"private_key_jwt\", OpenId specification says the following about assertion `jti`: \"A unique identifier for the token, which can be used to prevent reuse of the token. These tokens MUST only be used once, unless conditions for reuse were negotiated between the parties\". Hydra does not seem to check the uniqueness of this `jti` value. This problem is fixed in version 0.31.0",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "5.8"
    },
    {
      "type": "CVSS_V3",
      "score": "8.1"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "ory/fosite",
        "purl": "https://github.com/ory/fosite"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "fixed": "0.31.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ory/fosite/commit/0c9e0f6d654913ad57c507dd9a36631e1858a3e9"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ory/fosite/security/advisories/GHSA-v3q9-2p3m-7g43"
    },
    {
      "type": "WEB",
      "url": "https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication"
    }
  ],
  "credits": [
    {
      "name": "Patrik",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 8.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.2
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 8.1,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.2
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 5.8
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 4.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": true
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-345",
        "url": ""
      },
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-287",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/ory/fosite",
        "name": "ory/fosite",
        "description": "Extensible security first OAuth 2.0 and OpenID Connect SDK for Go.",
        "date_created": "2015-12-25 14:23:27",
        "date_last_push": "2022-08-26 16:33:59",
        "owner": "ory",
        "forks_count": "256.0",
        "stars_count": "1898.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:ory:fosite:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "542BA3D2-FDFC-43AA-B209-BC9780EDAB7D",
            "versionEndExcluding": "0.31.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0110",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}