{
  "schema_version": "1.6.3",
  "id": "CVE-2021-32690",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-15T23:29:45Z",
  "aliases": [
    "GHSA-56hp-xqp3-w2jf",
    "GHSA-7jr6-prv4-5wf5",
    "GO-2022-0384"
  ],
  "related": [],
  "summary": "Repository credentials passed to alternate domain in helm.sh/helm/v3. Helm is a tool for managing Charts (packages of pre-configured Kubernetes resources). In versions of helm prior to 3.6.1, a vulnerability exists where the username and password credentials associated with a Helm repository could be passed on to another domain referenced by that Helm repository. This issue has been resolved in 3.6.1. There is a workaround through which one may check for improperly passed credentials. One may use a username and password for a Helm repository and may audit the Helm repository in order to check for another domain being used that could have received the credentials. In the `index.yaml` file for that repository, one may look for another domain in the `urls` list for the chart versions. If there is another domain found and that chart version was pulled or installed, the credentials would be passed on. Helm es una herramienta para gestionar Charts (paquetes de recursos Kubernetes preconfigurados). En versiones de Helm anteriores a 3.6.1, se presenta una vulnerabilidad en la que las credenciales de nombre de usuario y contraseña asociadas a un repositorio de Helm podrían ser pasadas a otro dominio referenciado por ese repositorio de Helm. Este problema ha sido resuelto en versión 3.6.1. Se presenta una solución que permite comprobar credenciales pasadas inapropiadamente. Puede usar un nombre de usuario y una contraseña para un repositorio Helm y puede auditar el repositorio Helm para comprobar si se está utilizando otro dominio que podría haber recibido las credenciales. En el archivo \"index.yaml\" para ese repositorio, uno puede buscar otro dominio en la lista de \"urls\" para las versiones del gráfico. Si se encuentra otro dominio y esa versión del gráfico fue extraída o instalada, las credenciales se pasarían",
  "details": "The username and password credentials associated with a Helm repository can be passed to another domain referenced by that Helm repository.\n\nIf the index.yaml for a Helm repository is hosted on one domain and references a chart archive on a different domain, Helm will provide the credentials for the index.yaml's domain when fetching those archives",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "5.0"
    },
    {
      "type": "CVSS_V3",
      "score": "8.6"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "helm.sh/helm/v3"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "3.6.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "helm.sh/helm/v3/pkg/downloader",
            "symbols": [
              "ChartDownloader.DownloadTo",
              "ChartDownloader.ResolveChartVersion",
              "Manager.Build",
              "Manager.Update"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/advisories/GHSA-56hp-xqp3-w2jf"
    },
    {
      "type": "FIX",
      "url": "https://github.com/helm/helm/commit/61d8e8c4a6f95540c15c6a65f36a6dd0a45e7a2f"
    },
    {
      "type": "WEB",
      "url": "https://github.com/helm/helm/releases/tag/v3.6.1"
    },
    {
      "type": "WEB",
      "url": "https://github.com/helm/helm/security/advisories/GHSA-56hp-xqp3-w2jf"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 8.6,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 4.0
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 6.8,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 4.0
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.0
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 10.0,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "NVD-CWE-Other",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-200",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/helm/helm",
        "name": "helm/helm",
        "description": "The Kubernetes Package Manager",
        "date_created": "2015-10-06T01:07:32Z",
        "date_last_push": "2024-06-22T08:24:06Z",
        "owner": "helm",
        "forks_count": "6992",
        "stars_count": "26274",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:helm:helm:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "415DB92F-620D-4399-A9BB-0FF0BBF1F942",
            "versionEndExcluding": "3.6.1"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0384",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}