{
  "schema_version": "1.6.3",
  "id": "CVE-2021-23772",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-15T23:08:12Z",
  "aliases": [
    "GHSA-jcxc-rh6w-wf49",
    "GO-2022-0272"
  ],
  "related": [],
  "summary": "Directory traversal in github.com/kataras/iris and github.com/kataras/iris/v12. This affects all versions of package github.com/kataras/iris; all versions of package github.com/kataras/iris/v12. The unsafe handling of file names during upload using UploadFormFiles method may enable attackers to write to arbitrary locations outside the designated target folder. Esto afecta a todas las versiones del paquete github.com/kataras/iris; todas las versiones del paquete github.com/kataras/iris/v12. Un manejo no seguro de los nombres de archivo durante la carga usando el método UploadFormFiles puede permitir a atacantes escribir en ubicaciones arbitrarias fuera de la carpeta de destino designada. CWE-59",
  "details": "The Context.UploadFormFiles function is vulnerable to directory traversal attacks, and can be made to write to arbitrary locations outside the destination directory.\n\nThis vulnerability only occurs when built with Go versions prior to 1.17. Go 1.17 and later strip directory paths from filenames returned by \"mime/multipart\".Part.FileName, which avoids this issue. This affects all versions of package github.com/kataras/iris; all versions of package github.com/kataras/iris/v12. The unsafe handling of file names during upload using UploadFormFiles method may enable attackers to write to arbitrary locations outside the designated target folder",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "6.8"
    },
    {
      "type": "CVSS_V3",
      "score": "8.8"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "kataras/iris",
        "purl": "https://github.com/kataras/iris"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": []
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/kataras/iris/commit/e213dba0d32ff66653e0ef124bc5088817264b08"
    },
    {
      "type": "WEB",
      "url": "https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRIS-2325169"
    },
    {
      "type": "WEB",
      "url": "https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRISV12-2325170"
    }
  ],
  "credits": [
    {
      "name": "Snyk Security Team"
    },
    {
      "name": "Gerasimos (Makis) Maropoulos",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.9
        },
        {
          "source": "report@snyk.io",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.6,
          "impactScore": 5.9
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 6.8
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-59",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/kataras/iris",
        "name": "kataras/iris",
        "description": "The fastest HTTP/2 Go Web Framework. Easy to learn. Fast development with Code you control. Unbeatable cost-performance ratio :leaves: :rocket: | 谢谢 |",
        "date_created": "2016-01-30 04:36:48",
        "date_last_push": "2022-08-26 21:22:44",
        "owner": "kataras",
        "forks_count": "2417.0",
        "stars_count": "22815.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": false,
            "criteria": "cpe:2.3:a:golang:go:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "355C01B5-DC2D-4992-BCD9-B22E68BC7858",
            "versionEndExcluding": "1.7.5"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:iris-go:iris:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "EA26C17D-DFA8-4AB5-9E4C-6D5E0A375F6E",
            "versionEndIncluding": "12.1.8"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:iris-go:iris:12.2.0:alpha:*:*:*:go:*:*",
            "matchCriteriaId": "36735110-76CB-42E1-A4DC-E75FF8D35844"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:iris-go:iris:12.2.0:alpha2:*:*:*:go:*:*",
            "matchCriteriaId": "4801442A-7188-4FBB-B699-569B7EAC0FC8"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:iris-go:iris:12.2.0:alpha3:*:*:*:go:*:*",
            "matchCriteriaId": "911993F3-EC67-4E85-A0B2-598CA8CB3B14"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:iris-go:iris:12.2.0:alpha4:*:*:*:go:*:*",
            "matchCriteriaId": "4ED1FF1C-46DA-4E7B-BC42-00847843A82A"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:iris-go:iris:12.2.0:alpha5:*:*:*:go:*:*",
            "matchCriteriaId": "CA784B81-3C4F-4253-92C9-0B16431BE486"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0272",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}