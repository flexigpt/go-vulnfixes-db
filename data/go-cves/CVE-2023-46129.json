{
  "schema_version": "1.6.3",
  "id": "CVE-2023-46129",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-11-02T21:47:24Z",
  "aliases": [
    "GHSA-mr45-rx8q-wcm9",
    "GO-2023-2163"
  ],
  "related": [],
  "summary": "Curve KeyPairs fail to encrypt in github.com/nats-io/nkeys. NATS.io is a high performance open source pub-sub distributed communication technology, built for the cloud, on-premise, IoT, and edge computing. The cryptographic key handling library, nkeys, recently gained support for encryption, not just for signing/authentication. This is used in nats-server 2.10 (Sep 2023) and newer for authentication callouts. In nkeys versions 0.4.0 through 0.4.5, corresponding with NATS server versions 2.10.0 through 2.10.3, the nkeys library's `xkeys` encryption handling logic mistakenly passed an array by value into an internal function, where the function mutated that buffer to populate the encryption key to use. As a result, all encryption was actually to an all-zeros key. This affects encryption only, not signing.  \nFIXME: FILL IN IMPACT ON NATS-SERVER AUTH CALLOUT SECURITY. nkeys Go library 0.4.6, corresponding with NATS Server 2.10.4, has a patch for this issue. No known workarounds are available. For any application handling auth callouts in Go, if using the nkeys library, update the dependency, recompile and deploy that in lockstep. NATS.io es una tecnología de comunicación distribuida pub-sub de código abierto de alto rendimiento, creada para la nube, local, IoT y computación de borde. La librería de manejo de claves criptográficas, nkeys, recientemente obtuvo soporte para cifrado, no solo para firma/autenticación. Esto se utiliza en nats-server 2.10 (septiembre de 2023) y versiones posteriores para llamadas de autenticación. En las versiones 0.4.0 a 0.4.5 de nkeys, correspondientes a las versiones 2.10.0 a 2.10.3 del servidor NATS, la lógica de manejo de cifrado `xkeys` de la librería nkeys pasó por error una matriz por valor a una función interna, donde la función mutó ese búfer. para completar la clave de cifrado que se utilizará. Como resultado, todo el cifrado se realizó en realidad con una clave de todos ceros. Esto afecta únicamente al cifrado, no a la firma. SOLUCIÓN: COMPLETE EL IMPACTO EN LA SEGURIDAD DE LA LLAMADA DE AUTENCIÓN DEL SERVIDOR NATS. La librería nkeys Go 0.4.6, correspondiente a NATS Server 2.10.4, tiene un parche para este problema. No hay workarounds conocidos disponibles. Para cualquier aplicación que maneje llamadas de autenticación en Go, si usa la librería nkeys, actualice la dependencia, vuelva a compilarla e implementarla al mismo tiempo",
  "details": "Curve KeyPairs always use the same (all-zeros) key to encrypt data, and provide no security",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/nats-io/nkeys"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.4.0"
            },
            {
              "fixed": "0.4.6"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/nats-io/nkeys",
            "symbols": [
              "ckp.Open",
              "ckp.Seal",
              "ckp.SealWithRand",
              "decodePubCurveKey"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/nats-io/nkeys/security/advisories/GHSA-mr45-rx8q-wcm9"
    },
    {
      "type": "FIX",
      "url": "https://github.com/nats-io/nkeys/commit/58fb9d69f42ea73fffad1d14e5914dc666f3daa1"
    },
    {
      "type": "WEB",
      "url": "http://www.openwall.com/lists/oss-security/2023/10/31/1"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R3UETKPUB3V5JS5TLZOF3SMTGT5K5APS/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ULQQONMSCQSH5Z5OWFFQHCGEZ3NL4DRJ/"
    }
  ],
  "credits": [
    {
      "name": "Quentin Matillat (GitHub @tinou98)"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-321 CWE-325",
        "name": "Primary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/nats-io/nkeys",
        "name": "nats-io/nkeys",
        "description": "NATS Keys",
        "date_created": "2018-02-27T03:37:56Z",
        "date_last_push": "2024-01-21T09:23:55Z",
        "owner": "nats-io",
        "forks_count": "31",
        "stars_count": "127",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:nats:nats_server:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "BBB8F9C2-3395-4D22-BA0C-8462D6E076A6",
            "versionStartIncluding": "2.10.0",
            "versionEndExcluding": "2.10.4"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:nats:nkeys:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "EBAF8F73-D62A-4371-916F-0296A4B975B5",
            "versionStartIncluding": "0.4.0",
            "versionEndExcluding": "0.4.6"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2163",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}