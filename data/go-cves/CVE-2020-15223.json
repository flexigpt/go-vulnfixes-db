{
  "schema_version": "1.6.3",
  "id": "CVE-2020-15223",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-07-28T18:08:05Z",
  "aliases": [
    "GO-2021-0109",
    "GHSA-7mqr-2v3q-v2wm"
  ],
  "related": [],
  "summary": "Improper handling of token revocation in github.com/ory/fosite. In ORY Fosite (the security first OAuth2 & OpenID Connect framework for Go) before version 0.34.0, the `TokenRevocationHandler` ignores errors coming from the storage. This can lead to unexpected 200 status codes indicating successful revocation while the token is still valid. Whether an attacker can use this for her advantage depends on the ability to trigger errors in the store. This is fixed in version 0.34.0 En ORY Fosite (el primer framework de seguridad OAuth2 &amp; OpenID Connect para Go) anterior a la versión 0.34.0, el \"TokenRevocationHandler\" ignora los errores provenientes del almacenamiento.&#xa0;Esto puede conllevar a 200 códigos de estado no previstos que indican una revocación exitosa mientras el token aún es válido.&#xa0;Si un atacante puede usar esto para su favor depende de la capacidad de desencadenar errores en la tienda.&#xa0;Esto se corrigió en la versión 0.34.0. CWE-755",
  "details": "Due to improper error handling, an error with the underlying token storage may cause a user to believe a token has been successfully revoked when it is in fact still valid. An attackers ability to exploit this relies on an ability to trigger errors in the underlying storage. In ORY Fosite (the security first OAuth2 & OpenID Connect framework for Go) before version 0.34.0, the `TokenRevocationHandler` ignores errors coming from the storage. This can lead to unexpected 200 status codes indicating successful revocation while the token is still valid. Whether an attacker can use this for her advantage depends on the ability to trigger errors in the store. This is fixed in version 0.34.0",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.0"
    },
    {
      "type": "CVSS_V3",
      "score": "8.0"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "ory/fosite",
        "purl": "https://github.com/ory/fosite"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "fixed": "0.34.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ory/fosite/commit/03dd55813f5521985f7dd64277b7ba0cf1441319"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ory/fosite/security/advisories/GHSA-7mqr-2v3q-v2wm"
    },
    {
      "type": "WEB",
      "url": "https://tools.ietf.org/html/rfc7009#section-2.2.1"
    }
  ],
  "credits": [
    {
      "name": "Patrik",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 8.0,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.6,
          "impactScore": 5.8
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 8.0,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.6,
          "impactScore": 5.8
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:H/Au:N/C:P/I:P/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "HIGH",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 4.0
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 4.9,
          "impactScore": 4.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": true
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-754",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-755",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/ory/fosite",
        "name": "ory/fosite",
        "description": "Extensible security first OAuth 2.0 and OpenID Connect SDK for Go.",
        "date_created": "2015-12-25 14:23:27",
        "date_last_push": "2022-08-26 16:33:59",
        "owner": "ory",
        "forks_count": "256.0",
        "stars_count": "1898.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:ory:fosite:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "80E07C30-E0A1-456A-B3E8-A0015EB05A66",
            "versionEndExcluding": "0.34.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0109",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}