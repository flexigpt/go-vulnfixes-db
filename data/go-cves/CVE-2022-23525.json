{
  "schema_version": "1.6.3",
  "id": "CVE-2022-23525",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-12-22T23:11:46Z",
  "aliases": [
    "GO-2022-1165",
    "GHSA-53c4-hhmh-vw5q"
  ],
  "related": [],
  "summary": "Denial of service via repository index file in helm.sh/helm/v3. Helm is a tool for managing Charts, pre-configured Kubernetes resources. Versions prior to 3.10.3 are subject to NULL Pointer Dereference in the _repo_package. The _repo_ package contains a handler that processes the index file of a repository. For example, the Helm client adds references to chart repositories where charts are managed. The _repo_ package parses the index file of the repository and loads it into structures Go can work with. Some index files can cause array data structures to be created causing a memory violation. Applications that use the _repo_ package in the Helm SDK to parse an index file can suffer a Denial of Service when that input causes a panic that cannot be recovered from. The Helm Client will panic with an index file that causes a memory violation panic. Helm is not a long running service so the panic will not affect future uses of the Helm client. This issue has been patched in 3.10.3. SDK users can validate index files that are correctly formatted before passing them to the _repo_ functions. Helm es una herramienta para gestionar gráficos, recursos de Kubernetes preconfigurados. Las versiones anteriores a la 3.10.3 están sujetas a la desreferencia de puntero NULL en el _repo_package. El _repo_package contiene un controlador que procesa el archivo de índice de un repositorio. Por ejemplo, el cliente Helm agrega referencias a repositorios de gráficos donde se administran los gráficos. El _repo_package analiza el archivo de índice del repositorio y lo carga en estructuras con las que Go puede trabajar. Algunos archivos de índice pueden provocar la creación de estructuras de datos de matriz, lo que provoca una violación de la memoria. Las aplicaciones que utilizan el _repo_package en el SDK de Helm para analizar un archivo de índice pueden sufrir una Denegación de Servicio (DoS) cuando esa entrada provoca un pánico del que no se puede recuperar. El cliente Helm entrará en pánico con un archivo de índice que provocará una violación de memoria. Helm no es un servicio de larga duración, por lo que el pánico no afectará los usos futuros del cliente Helm. Este problema se solucionó en 3.10.3. Los usuarios del SDK pueden validar los archivos de índice que estén formateados correctamente antes de pasarlos a las funciones _repo_",
  "details": "Applications that use the repo package in the Helm SDK to parse an index file can suffer a Denial of Service when that input causes a panic that cannot be recovered from.\n\nThe repo package contains a handler that processes the index file of a repository. For example, the Helm client adds references to chart repositories where charts are managed. The repo package parses the index file of the repository and loads it into memory. Some index files can cause array data structures to be created causing a memory violation.\n\nThe Helm Client will panic with an index file that causes a memory violation panic. Helm is not a long running service so the panic will not affect future uses of the Helm client",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "helm.sh/helm/v3"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "3.10.3"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "helm.sh/helm/v3/pkg/repo",
            "symbols": [
              "ChartRepository.DownloadIndexFile",
              "ChartRepository.Index",
              "ChartRepository.Load",
              "File.Remove",
              "FindChartInAuthAndTLSAndPassRepoURL",
              "FindChartInAuthAndTLSRepoURL",
              "FindChartInAuthRepoURL",
              "FindChartInRepoURL",
              "IndexDirectory",
              "IndexFile.Add",
              "IndexFile.MustAdd",
              "LoadIndexFile",
              "loadIndex"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/helm/helm/security/advisories/GHSA-53c4-hhmh-vw5q"
    },
    {
      "type": "WEB",
      "url": "https://github.com/helm/helm/commit/638ebffbc2e445156f3978f02fd83d9af1e56f5b"
    }
  ],
  "credits": [
    {
      "name": "Ada Logics, in a fuzzing audit sponsored by CNCF"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "LOW",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-476",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-476",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/helm/helm",
        "name": "helm/helm",
        "description": "The Kubernetes Package Manager",
        "date_created": "2015-10-06T01:07:32Z",
        "date_last_push": "2024-06-22T08:24:06Z",
        "owner": "helm",
        "forks_count": "6992",
        "stars_count": "26274",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:helm:helm:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "135AAD77-267A-4119-877F-60195A002775",
            "versionStartIncluding": "3.0.0",
            "versionEndExcluding": "3.10.3"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1165",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}