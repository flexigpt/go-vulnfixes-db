{
  "schema_version": "1.6.3",
  "id": "CVE-2022-0317",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-15T23:27:21Z",
  "aliases": [
    "GHSA-99cg-575x-774p",
    "GO-2022-0294"
  ],
  "related": [],
  "summary": "Improper input validation in github.com/google/go-attestation. An improper input validation vulnerability in go-attestation before 0.3.3 allows local users to provide a maliciously-formed Quote over no/some PCRs, causing AKPublic.Verify to succeed despite the inconsistency. Subsequent use of the same set of PCR values in Eventlog.Verify lacks the authentication performed by quote verification, meaning a local attacker could couple this vulnerability with a maliciously-crafted TCG log in Eventlog.Verify to spoof events in the TCG log, hence defeating remotely-attested measured-boot. We recommend upgrading to Version 0.4.0 or above. Una vulnerabilidad de Comprobación de Entrada Inapropiada en go-attestation versiones anteriores a 0.3.3, permite a usuarios locales proporcionar una cita con forma maliciosa sobre no/algunas PCR, causando que AKPublic.Verify tenga éxito a pesar de la inconsistencia. El uso posterior del mismo conjunto de valores de PCR en Eventlog.Verify carece de la autenticación llevada a cabo por la verificación de citas, lo que significa que un atacante local podría acoplar esta vulnerabilidad con un registro TCG diseñado de forma maliciosa en Eventlog.Verify para falsificar eventos en el registro TCG, derrotando así el arranque medido comprobado de forma remota. Recomendamos actualizar a la versión 0.4.0 o superior",
  "details": "A local attacker can defeat remotely-attested measured boot.\n\nImproper input validation in AKPublic.Verify can cause it to succeed when provided with a maliciously-formed Quote over no/some PCRs. Subsequent use of the same set of PCR values in Eventlog.Verify lacks the authentication performed by quote verification, meaning a local attacker can couple this vulnerability with a maliciously-formed TCG log in Eventlog.Verify to spoof events in the TCG log, defeating remotely-attested measured-boot",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "2.1"
    },
    {
      "type": "CVSS_V3",
      "score": "3.3"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/google/go-attestation"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.4.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/google/go-attestation/attest",
            "symbols": [
              "AKPublic.Verify",
              "AKPublic.validate12Quote",
              "AKPublic.validate20Quote",
              "TPM.AttestPlatform"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/google/go-attestation/commit/82f2c9c2c76e1d3691d17ee78116d1d93a123788"
    },
    {
      "type": "WEB",
      "url": "https://github.com/google/go-attestation/security/advisories/GHSA-99cg-575x-774p"
    }
  ],
  "credits": [
    {
      "name": "Nikki VonHollen"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 3.3,
            "baseSeverity": "LOW"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 1.4
        },
        {
          "source": "cve-coordination@google.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 4.0,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.5,
          "impactScore": 1.4
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:L/Au:N/C:N/I:P/A:N",
            "accessVector": "LOCAL",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 2.1
          },
          "baseSeverity": "LOW",
          "exploitabilityScore": 3.9,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-20",
        "url": ""
      },
      {
        "cwe_id": "cve-coordination@google.com",
        "name": "Secondary",
        "description": "CWE-20",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/google/go-attestation",
        "name": "google/go-attestation",
        "date_created": "2019-03-28T19:42:16Z",
        "date_last_push": "2024-06-10T18:00:22Z",
        "owner": "google",
        "forks_count": "85",
        "stars_count": "337",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:google:go-attestation:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "E662172D-83A5-40CD-8EB7-44ED2E93ABD7",
            "versionEndExcluding": "0.3.3"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0294",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}