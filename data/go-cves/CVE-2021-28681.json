{
  "schema_version": "1.6.3",
  "id": "CVE-2021-28681",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2021-07-28T18:08:05Z",
  "aliases": [
    "GO-2021-0104",
    "GHSA-74xm-qj29-cq8p"
  ],
  "related": [],
  "summary": "Authorization bypass in github.com/pion/webrtc/v3. Pion WebRTC before 3.0.15 didn't properly tear down the DTLS Connection when certificate verification failed. The PeerConnectionState was set to failed, but a user could ignore that and continue to use the PeerConnection. )A WebRTC implementation shouldn't allow the user to continue if verification has failed.) Pion WebRTC versiones anteriores a 3.0.15, no eliminó apropiadamente la conexión DTLS cuando falló una comprobación del certificado.&#xa0;El PeerConnectionState se configuró para un fallo, pero un usuario podría ignorarlo y continuar usando PeerConnection.&#xa0;(Una implementación de WebRTC no debería permitir al usuario continuar si la comprobación ha fallado)",
  "details": "Due to improper error handling, DTLS connections were not killed when certificate verification failed, causing users who did not check the connection state to continue to use the connection. This could allow allow an attacker which holds the ICE password, but not a valid certificate, to bypass this restriction",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "5.0"
    },
    {
      "type": "CVSS_V3",
      "score": "5.3"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/pion/webrtc/v3"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "3.0.15"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/pion/webrtc/v3",
            "symbols": [
              "DTLSTransport.Start",
              "PeerConnection.AddTrack",
              "PeerConnection.AddTransceiverFromKind",
              "PeerConnection.AddTransceiverFromTrack",
              "PeerConnection.CreateDataChannel",
              "PeerConnection.RemoveTrack",
              "PeerConnection.SetLocalDescription",
              "PeerConnection.SetRemoteDescription",
              "operations.Done",
              "operations.Enqueue"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://github.com/pion/webrtc/pull/1709"
    },
    {
      "type": "FIX",
      "url": "https://github.com/pion/webrtc/commit/545613dcdeb5dedb01cce94175f40bcbe045df2e"
    },
    {
      "type": "WEB",
      "url": "https://github.com/pion/webrtc/issues/1708"
    },
    {
      "type": "WEB",
      "url": "https://github.com/pion/webrtc/security/advisories/GHSA-74xm-qj29-cq8p"
    }
  ],
  "credits": [
    {
      "name": "Gaukas Wang (@Gaukas)"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 5.0
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 10.0,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-863",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/pion/webrtc",
        "name": "pion/webrtc",
        "description": "Pure Go implementation of the WebRTC API",
        "date_created": "2018-05-18T23:10:05Z",
        "date_last_push": "2024-06-18T23:01:38Z",
        "owner": "pion",
        "forks_count": "1590",
        "stars_count": "13009",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:webrtc_project:webrtc:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "6268E745-4C5D-4103-AD3F-0B16DBA1B1CD",
            "versionEndExcluding": "3.0.15"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0104",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}