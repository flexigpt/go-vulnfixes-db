{
  "schema_version": "1.6.3",
  "id": "CVE-2023-22460",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-01-18T18:07:08Z",
  "aliases": [
    "GO-2023-1269",
    "GHSA-c653-6hhg-9x92"
  ],
  "related": [],
  "summary": "Panic in encoding in github.com/ipld/go-ipld-prime. go-ipld-prime is an implementation of the InterPlanetary Linked Data (IPLD) spec interfaces, a batteries-included codec implementations of IPLD for CBOR and JSON, and tooling for basic operations on IPLD objects. Encoding data which contains a Bytes kind Node will pass a Bytes token to the JSON encoder which will panic as it doesn't expect to receive Bytes tokens. Such an encode should be treated as an error, as plain JSON should not be able to encode Bytes. This only impacts uses of the `json` codec. `dag-json` is not impacted. Use of `json` as a decoder is not impacted. This issue is fixed in v0.19.0. As a workaround, one may prefer the `dag-json` codec, which has the ability to encode bytes. go-ipld-prime es una implementación de las interfaces de especificaciones de datos vinculados interplanetarios (IPLD), que incluye implementaciones de códec de IPLD para CBOR y JSON y herramientas para operaciones básicas en objetos IPLD. La codificación de datos que contiene un nodo de tipo Bytes pasará un token de Bytes al codificador JSON, lo que entrará en pánico porque no espera recibir tokens de Bytes. Dicha codificación debe tratarse como un error, ya que JSON simple no debería poder codificar bytes. Esto solo afecta los usos del códec \"json\". `dag-json` no se ve afectado. El uso de `json` como decodificador no se ve afectado. Este problema se solucionó en v0.19.0. Como workaround, se puede preferir el códec `dag-json`, que tiene la capacidad de codificar bytes",
  "details": "Encoding data using the 'json' codec which contains a 'Bytes' type Node will cause the encoder to panic. The decoder is not impacted. If the codec is used to encode user supplied data, this may be used as a vector for a denial of service attack",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/ipld/go-ipld-prime"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.19.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/ipld/go-ipld-prime/codec/dagjson",
            "symbols": [
              "Encode",
              "EncodeOptions.Encode",
              "Marshal"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ipld/go-ipld-prime/security/advisories/GHSA-c653-6hhg-9x92"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ipld/go-ipld-prime/pull/472"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ipld/go-ipld-prime/releases/tag/v0.19.0"
    }
  ],
  "credits": [
    {
      "name": "@hacdias"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-20",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:protocol:go-ipld-prime:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "75FFBC2F-60A8-4C3E-8F3D-EEBA466274D5",
            "versionEndExcluding": "0.19.0"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-1269",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}