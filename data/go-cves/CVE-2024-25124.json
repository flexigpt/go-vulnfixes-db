{
  "schema_version": "1.6.3",
  "id": "CVE-2024-25124",
  "modified": "2024-05-20T19:46:13Z",
  "published": "2024-05-20T19:46:13Z",
  "aliases": [
    "GHSA-fmg4-x8pw-hjhg",
    "GO-2024-2574"
  ],
  "related": [],
  "summary": "Insecure CORS Configuration allowing wildcard origin with credentials in github.com/gofiber/fiber/v2. Fiber is a web framework written in go. Prior to version 2.52.1, the CORS middleware allows for insecure configurations that could potentially expose the application to multiple CORS-related vulnerabilities. Specifically, it allows setting the Access-Control-Allow-Origin header to a wildcard (`*`) while also having the Access-Control-Allow-Credentials set to true, which goes against recommended security best practices. The impact of this misconfiguration is high as it can lead to unauthorized access to sensitive user data and expose the system to various types of attacks listed in the PortSwigger article linked in the references. Version 2.52.1 contains a patch for this issue. As a workaround, users may manually validate the CORS configurations in their implementation to ensure that they do not allow a wildcard origin when credentials are enabled. The browser fetch api, as well as browsers and utilities that enforce CORS policies, are not affected by this. Fiber es un framework web escrito en go. Antes de la versión 2.52.1, el middleware CORS permitía configuraciones inseguras que podrían exponer la aplicación a múltiples vulnerabilidades relacionadas con CORS. Específicamente, permite establecer el encabezado Access-Control-Allow-Origin en un comodín (`*`) y al mismo tiempo tener Access-Control-Allow-Credentials establecido en verdadero, lo que va en contra de las mejores prácticas de seguridad recomendadas. El impacto de esta mala configuración es alto, ya que puede conducir a un acceso no autorizado a datos confidenciales del usuario y exponer el sistema a varios tipos de ataques enumerados en el artículo de PortSwigger vinculado en las referencias. La versión 2.52.1 contiene un parche para este problema. Como workaround, los usuarios pueden validar manualmente las configuraciones de CORS en su implementación para asegurarse de que no permitan un origen comodín cuando las credenciales estén habilitadas. La API de recuperación del navegador, así como los navegadores y las utilidades que aplican las políticas CORS, no se ven afectados por esto",
  "details": "The CORS middleware allows for insecure configurations that could potentially expose the application to multiple CORS-related vulnerabilities. Specifically, it allows setting the Access-Control-Allow-Origin header to a wildcard (\"*\") while also having the Access-Control-Allow-Credentials set to true, which goes against recommended security best practices",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "9.4"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/gofiber/fiber/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.52.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/gofiber/fiber/v2/middleware/cors",
            "symbols": [
              "New",
              "matchSubdomain"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/gofiber/fiber/security/advisories/GHSA-fmg4-x8pw-hjhg"
    },
    {
      "type": "WEB",
      "url": "https://github.com/gofiber/fiber/commit/f0cd3b44b086544a37886232d0530601f2406c23"
    },
    {
      "type": "WEB",
      "url": "http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html"
    },
    {
      "type": "WEB",
      "url": "https://codeql.github.com/codeql-query-help/javascript/js-cors-misconfiguration-for-credentials"
    },
    {
      "type": "WEB",
      "url": "https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSNotSupportingCredentials"
    },
    {
      "type": "WEB",
      "url": "https://fetch.spec.whatwg.org/#cors-protocol-and-credentials"
    },
    {
      "type": "WEB",
      "url": "https://github.com/gofiber/fiber/releases/tag/v2.52.1"
    },
    {
      "type": "WEB",
      "url": "https://saturncloud.io/blog/cors-cannot-use-wildcard-in-accesscontrolalloworigin-when-credentials-flag-is-true"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "LOW",
            "baseScore": 9.4,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.5
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-346 CWE-942",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/gofiber/fiber",
        "name": "gofiber/fiber",
        "description": "⚡️ Express inspired web framework written in Go",
        "date_created": "2020-01-16T03:59:20Z",
        "date_last_push": "2024-06-13T12:59:27Z",
        "owner": "gofiber",
        "forks_count": "1584",
        "stars_count": "31896",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2574",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}