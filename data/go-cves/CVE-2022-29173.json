{
  "schema_version": "1.6.3",
  "id": "CVE-2022-29173",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-01T20:07:44Z",
  "aliases": [
    "GHSA-66x3-6cw3-v5gj",
    "GO-2022-0444"
  ],
  "related": [],
  "summary": "Version rollback attack in github.com/theupdateframework/go-tuf. go-tuf is a Go implementation of The Update Framework (TUF). go-tuf does not correctly implement the client workflow for updating the metadata files for roles other than the root role. Specifically, checks for rollback attacks are not implemented correctly meaning an attacker can cause clients to install software that is older than the software which the client previously knew to be available, and may include software with known vulnerabilities. In more detail, the client code of go-tuf has several issues in regards to preventing rollback attacks: 1. It does not take into account the content of any previously trusted metadata, if available, before proceeding with updating roles other than the root role (i.e., steps 5.4.3.1 and 5.5.5 of the detailed client workflow). This means that any form of version verification done on the newly-downloaded metadata is made using the default value of zero, which always passes. 2. For both timestamp and snapshot roles, go-tuf saves these metadata files as trusted before verifying if the version of the metafiles they refer to is correct (i.e., steps 5.5.4 and 5.6.4 of the detailed client workflow). A fix is available in version 0.3.0 or newer. No workarounds are known for this issue apart from upgrading. go-tuf es una implementación en Go de El Update Framework (TUF). go-tuf no implementa correctamente el flujo de trabajo del cliente para la actualización de los archivos de metadatos para los roles que no sean el rol de root. Específicamente, las comprobaciones para los ataques de retroceso no están implementadas correctamente, lo que significa que un atacante puede causar que los clientes instalen software que es más antiguo que el software que el cliente sabía previamente que estaba disponible, y puede incluir software con vulnerabilidades conocidas. En más detalle, el código del cliente de go-tuf presenta varios problemas en cuanto a la prevención de ataques de retroceso: 1. No presenta en cuenta el contenido de cualquier metadato previamente confiable, si está disponible, antes de proceder con la actualización de roles que no sean el rol root (es decir, los pasos 5.4.3.1 y 5.5.5 del flujo de trabajo detallado del cliente). Esto significa que cualquier forma de verificación de la versión realizada en los metadatos recién descargados es realizada usando el valor por defecto de cero, que siempre pasa. 2. Para los roles de marca de tiempo e instantánea, go-tuf guarda estos archivos de metadatos como confiables antes de verificar si la versión de los metaficheros a los que son referidos es correcta (es decir, los pasos 5.5.4 y 5.6.4 del flujo de trabajo detallado del cliente). Se presenta una corrección disponible en versión 0.3.0 o más reciente. No se  conocen medidas de mitigación para este problema, aparte de la actualización. CWE-354",
  "details": "The TUF client is vulnerable to rollback attacks, in which an attacker causes a client to install software older than the software the client previously knew to be available. go-tuf is a Go implementation of The Update Framework (TUF). go-tuf does not correctly implement the client workflow for updating the metadata files for roles other than the root role. Specifically, checks for rollback attacks are not implemented correctly meaning an attacker can cause clients to install software that is older than the software which the client previously knew to be available, and may include software with known vulnerabilities. In more detail, the client code of go-tuf has several issues in regards to preventing rollback attacks: 1. It does not take into account the content of any previously trusted metadata, if available, before proceeding with updating roles other than the root role (i.e., steps 5.4.3.1 and 5.5.5 of the detailed client workflow). This means that any form of version verification done on the newly-downloaded metadata is made using the default value of zero, which always passes. 2. For both timestamp and snapshot roles, go-tuf saves these metadata files as trusted before verifying if the version of the metafiles they refer to is correct (i.e., steps 5.5.4 and 5.6.4 of the detailed client workflow). A fix is available in version 0.3.0 or newer. No workarounds are known for this issue apart from upgrading",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.3"
    },
    {
      "type": "CVSS_V3",
      "score": "8.8"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "theupdateframework/go-tuf",
        "purl": "https://github.com/theupdateframework/go-tuf"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": []
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/theupdateframework/go-tuf/commit/ed6788e710fc3093a7ecc2d078bf734c0f200d8d"
    },
    {
      "type": "WEB",
      "url": "https://github.com/theupdateframework/go-tuf/security/advisories/GHSA-66x3-6cw3-v5gj"
    }
  ],
  "credits": [
    {
      "name": "Radoslav Dimitrov",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.9
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.0,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.1,
          "impactScore": 5.9
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 4.3
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": true
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-354",
        "url": ""
      },
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-354",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/theupdateframework/go-tuf",
        "name": "theupdateframework/go-tuf",
        "description": "Go implementation of The Update Framework (TUF)",
        "date_created": "2014-12-12 03:31:16",
        "date_last_push": "2022-08-27 23:45:43",
        "owner": "theupdateframework",
        "forks_count": "84.0",
        "stars_count": "493.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:theupdateframework:go-tuf:0.2.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "07B11DE6-6488-4B21-B641-A5B5BE3A5A55"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0444",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}