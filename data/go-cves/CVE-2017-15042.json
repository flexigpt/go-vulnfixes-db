{
  "schema_version": "1.6.3",
  "id": "CVE-2017-15042",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-01-07T20:35:00Z",
  "aliases": [
    "GO-2021-0178"
  ],
  "related": [],
  "summary": "Cleartext transmission of credentials in net/smtp. An unintended cleartext issue exists in Go before 1.8.4 and 1.9.x before 1.9.1. RFC 4954 requires that, during SMTP, the PLAIN auth scheme must only be used on network connections secured with TLS. The original implementation of smtp.PlainAuth in Go 1.0 enforced this requirement, and it was documented to do so. In 2013, upstream issue #5184, this was changed so that the server may decide whether PLAIN is acceptable. The result is that if you set up a man-in-the-middle SMTP server that doesn't advertise STARTTLS and does advertise that PLAIN auth is OK, the smtp.PlainAuth implementation sends the username and password. Existe un problema de texto en claro no planeado en la versión 1.8.4 y versiones 1.9.x anteriores a la 1.9.4 de Go. La RFC 4954 requiere que durante la autenticación SMTP, el esquema de autenticación PLAIN solo se use en conexiones de red protegidas con TLS. La implementación original de smtp.PlainAuth en Go 1.0 aseguraba el cumplimiento de este requisito y se documentó que esto se llevase a cabo. En 2013, problema upstream #5184, esto se modificó para que el servidor pudiera decidir si se acepta PLAIN. El resultado es que si un usuario crea un servidor SMTP Man-in-the-Middle (MitM) que no anuncia STARTTLS pero sí anuncia que la autenticación PLAIN es OK, la implementación smtp.PlainAuth envía el nombre de usuario y contraseña",
  "details": "SMTP clients using net/smtp can use the PLAIN authentication scheme on network connections not secured with TLS, exposing passwords to man-in-the-middle SMTP servers",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.3"
    },
    {
      "type": "CVSS_V3",
      "score": "5.9"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "stdlib"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.1.0-0"
            },
            {
              "fixed": "1.8.4"
            },
            {
              "introduced": "1.9.0-0"
            },
            {
              "fixed": "1.9.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "net/smtp",
            "symbols": [
              "plainAuth.Start"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://go.dev/cl/68170"
    },
    {
      "type": "FIX",
      "url": "https://go.googlesource.com/go/+/ec3b6131de8f9c9c25283260c95c616c74f6d790"
    },
    {
      "type": "REPORT",
      "url": "https://go.dev/issue/22134"
    },
    {
      "type": "WEB",
      "url": "https://groups.google.com/g/golang-dev/c/RinSE3EiJBI/m/kYL7zb07AgAJ"
    },
    {
      "type": "WEB",
      "url": "http://www.securityfocus.com/bid/101197"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2017:3463"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/errata/RHSA-2018:0878"
    },
    {
      "type": "WEB",
      "url": "https://github.com/golang/go/issues/22134"
    },
    {
      "type": "WEB",
      "url": "https://golang.org/cl/68023"
    },
    {
      "type": "WEB",
      "url": "https://golang.org/cl/68210"
    },
    {
      "type": "WEB",
      "url": "https://groups.google.com/d/msg/golang-dev/RinSE3EiJBI/kYL7zb07AgAJ"
    },
    {
      "type": "WEB",
      "url": "https://security.gentoo.org/glsa/201710-23"
    }
  ],
  "credits": [
    {
      "name": "Stevie Johnstone"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV30": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.3
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-319",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "49921821-1359-4B19-BDB2-7FBA767804A8",
            "versionEndIncluding": "1.8.3"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:golang:go:1.9:*:*:*:*:*:*:*",
            "matchCriteriaId": "7596E7CD-6863-4933-A9FB-74CF0ECF918F"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2021-0178",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}