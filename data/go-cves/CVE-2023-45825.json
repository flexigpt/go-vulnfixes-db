{
  "schema_version": "1.6.3",
  "id": "CVE-2023-45825",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2023-10-24T20:27:41Z",
  "aliases": [
    "GHSA-q24m-6h38-5xj8",
    "GO-2023-2137"
  ],
  "related": [],
  "summary": "Credentials leak in github.com/ydb-platform/ydb-go-sdk/v3. ydb-go-sdk is a pure Go native and database/sql driver for the YDB platform. Since ydb-go-sdk v3.48.6 if you use a custom credentials object (implementation of interface Credentials it may leak into logs. This happens because this object could be serialized into an error message using `fmt.Errorf(\"something went wrong (credentials: %q)\", credentials)` during connection to the YDB server. If such logging occurred, a  malicious user with access to logs could read sensitive information (i.e. credentials) information and use it to get access to the database. ydb-go-sdk contains this problem in versions from v3.48.6 to v3.53.2. The fix for this problem has been released in version v3.53.3. Users are advised to upgrade. Users unable to upgrade should implement the `fmt.Stringer` interface in your custom credentials type with explicit stringify of object state. ydb-go-sdk es un controlador de base de datos/sql y nativo de Go puro para la plataforma YDB. Desde ydb-go-sdk v3.48.6, si usa un objeto de credenciales personalizado (implementación de la interfaz Credenciales, puede filtrarse en los registros. Esto sucede porque este objeto podría serializarse en un mensaje de error usando `fmt.Errorf(\"something went wrong (credentials: %q)\", credenciales)` durante la conexión al servidor YDB. Si se produjera dicho registro, un usuario malintencionado con acceso a los registros podría leer información confidencial (es decir, credenciales) y utilizarla para obtener acceso a la base de datos. ydb- go-sdk contiene este problema en las versiones de v3.48.6 a v3.53.2. La solución para este problema se publicó en la versión v3.53.3. Se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar deben implementar la interfaz `fmt.Stringer` en su tipo de credenciales personalizadas con cadena explícita del estado del objeto",
  "details": "A custom credentials object that does not implement the fmt.Stringer interface may leak sensitive information (e.g., credentials) via logs",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/ydb-platform/ydb-go-sdk/v3"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "3.48.6"
            },
            {
              "fixed": "3.53.3"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/ydb-platform/ydb-go-sdk/v3",
            "symbols": [
              "Connector",
              "Driver.Close",
              "Driver.Coordination",
              "Driver.Discovery",
              "Driver.Ratelimiter",
              "Driver.Scheme",
              "Driver.Scripting",
              "Driver.Table",
              "Driver.Topic",
              "Driver.With",
              "IsTimeoutError",
              "IsTransportError",
              "MustConnector",
              "MustOpen",
              "New",
              "Open",
              "Unwrap",
              "WithAccessTokenCredentials",
              "WithAnonymousCredentials",
              "WithCertificatesFromFile",
              "WithRequestType",
              "WithTraceID",
              "connect",
              "initOnce.Close",
              "initOnce.Init",
              "sqlDriver.OpenConnector"
            ]
          },
          {
            "path": "github.com/ydb-platform/ydb-go-sdk/v3/credentials",
            "symbols": [
              "NewAccessTokenCredentials",
              "NewAnonymousCredentials",
              "NewStaticCredentials",
              "WithSourceInfo",
              "staticCredentialsConfig.Endpoint",
              "staticCredentialsConfig.GrpcDialOptions"
            ]
          },
          {
            "path": "github.com/ydb-platform/ydb-go-sdk/v3/internal/balancer",
            "symbols": [
              "Balancer.Invoke",
              "Balancer.NewStream",
              "Balancer.clusterDiscovery",
              "Balancer.wrapCall",
              "New"
            ]
          },
          {
            "path": "github.com/ydb-platform/ydb-go-sdk/v3/internal/conn",
            "symbols": [
              "WithAfterFunc"
            ]
          },
          {
            "path": "github.com/ydb-platform/ydb-go-sdk/v3/internal/credentials",
            "symbols": [
              "AccessToken.String",
              "Anonymous.String",
              "NewAccessTokenCredentials",
              "NewAnonymousCredentials",
              "NewStaticCredentials",
              "Static.String",
              "WithSourceInfo"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ydb-platform/ydb-go-sdk/security/advisories/GHSA-q24m-6h38-5xj8"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ydb-platform/ydb-go-sdk/pull/859"
    },
    {
      "type": "FIX",
      "url": "https://github.com/ydb-platform/ydb-go-sdk/commit/a0d92057c4e1bbdc5e85ae8d649edb0232b8fd4c"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ydb-platform/ydb-go-sdk/blob/master/credentials/credentials.go#L10"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ydb-platform/ydb-go-sdk/blob/v3.48.6/internal/balancer/balancer.go#L71"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-532",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-532",
        "name": "Secondary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/ydb-platform/ydb-go-sdk",
        "name": "ydb-platform/ydb-go-sdk",
        "description": "Pure Go native and database/sql driver for YDB",
        "date_created": "2021-08-03T09:40:19Z",
        "date_last_push": "2024-06-24T08:48:49Z",
        "owner": "ydb-platform",
        "forks_count": "69",
        "stars_count": "131",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:ydb:ydb-go-sdk:*:*:*:*:*:go:*:*",
            "matchCriteriaId": "5DEE71A5-8F9B-44E9-B983-648E88BEC94E",
            "versionStartIncluding": "3.48.6",
            "versionEndExcluding": "3.53.2"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2137",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}