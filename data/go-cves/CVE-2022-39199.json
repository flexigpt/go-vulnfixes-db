{
  "schema_version": "1.6.3",
  "id": "CVE-2022-39199",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-12-22T20:40:16Z",
  "aliases": [
    "GHSA-6cqj-6969-p57x",
    "GO-2022-1118"
  ],
  "related": [],
  "summary": "Improper validation of UUIDs in github.com/codenotary/immudb. immudb is a database with built-in cryptographic proof and verification. immudb client SDKs use server's UUID to distinguish between different server instance so that the client can connect to different immudb instances and keep the state for multiple servers. SDK does not validate this uuid and can accept any value reported by the server. A malicious server can change the reported UUID tricking the client to treat it as a different server thus accepting a state completely irrelevant to the one previously retrieved from the server. This issue has been patched in version 1.4.1. As a workaround, when initializing an immudb client object a custom state handler can be used to store the state. Providing custom implementation that ignores the server UUID can be used to ensure that even if the server changes the UUID, client will still consider it to be the same server. immudb es una base de datos con prueba y verificación criptográfica incorporada. Los SDK del cliente immudb utilizan el UUID del servidor para distinguir entre diferentes instancias de servidor, de modo que el cliente pueda conectarse a diferentes instancias de immudb y mantener el estado para múltiples servidores. El SDK no valida este uuid y puede aceptar cualquier valor informado por el servidor. Un servidor malicioso puede cambiar el UUID informado engañando al cliente para que lo trate como un servidor diferente, aceptando así un estado completamente irrelevante al que se recuperó previamente del servidor. Este problema se solucionó en la versión 1.4.1. Como workaround, al inicializar un objeto de cliente immudb se puede utilizar un controlador de estado personalizado para almacenar el estado. Se puede utilizar una implementación personalizada que ignore el UUID del servidor para garantizar que incluso si el servidor cambia el UUID, el cliente seguirá considerando que es el mismo servidor",
  "details": "A malicious server can trick a client into treating it as a different server by changing the reported UUID.\n\nimmudb client SDKs use the server's UUID to distinguish between different server instance so that the client can connect to different immudb instances and keep the state for multiple servers. The SDK does not validate this UUID and accepts any value reported by the server. A malicious server can therefore change the reported UUID and trick the client into treating it as a different server",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.9"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/codenotary/immudb"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.4.1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/codenotary/immudb/pkg/client",
            "symbols": [
              "DefaultOptions",
              "NewClient",
              "NewImmuClient",
              "immuClient.OpenSession"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/codenotary/immudb/security/advisories/GHSA-6cqj-6969-p57x"
    },
    {
      "type": "FIX",
      "url": "https://github.com/codenotary/immudb/commit/cade04756ff3f0a3b9e8d24149062744574adf5d"
    },
    {
      "type": "WEB",
      "url": "https://github.com/codenotary/immudb/releases/tag/v1.4.1"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 5.8,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.3,
          "impactScore": 4.0
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-345",
        "name": "Primary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/codenotary/immudb",
        "name": "codenotary/immudb",
        "description": "immudb - immutable database based on zero trust, SQL/Key-Value/Document model, tamperproof, data change history",
        "date_created": "2019-11-07T08:22:16Z",
        "date_last_push": "2024-06-07T14:34:30Z",
        "owner": "codenotary",
        "forks_count": "337",
        "stars_count": "8520",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:codenotary:immudb:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "0EA9B368-DD84-4E51-ABFB-7FDEF2E9807E",
            "versionEndExcluding": "1.4.1"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1118",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}