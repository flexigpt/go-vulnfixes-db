{
  "schema_version": "1.6.3",
  "id": "CVE-2023-49922",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-01-03T16:11:51Z",
  "aliases": [
    "GO-2023-2413",
    "GHSA-hj4r-2c9c-29h3"
  ],
  "related": [],
  "summary": "Sensitive information logged in github.com/elastic/beats/v7. An issue was discovered by Elastic whereby Beats and Elastic Agent would log a raw event in its own logs at the WARN or ERROR level if ingesting that event to Elasticsearch failed with any 4xx HTTP status code except 409 or 429. Depending on the nature of the event that Beats or Elastic Agent attempted to ingest, this could lead to the insertion of sensitive or private information in the Beats or Elastic Agent logs. Elastic has released 8.11.3 and 7.17.16 that prevents this issue by limiting these types of logs to DEBUG level logging, which is disabled by default. Elastic descubrió un problema por el cual Beats y Elastic Agent registraban un evento sin procesar en sus propios registros en el nivel WARN o ERROR si fallaba la ingesta de ese evento en Elasticsearch con cualquier código de estado HTTP 4xx excepto 409 o 429. Dependiendo de la naturaleza del en caso de que Beats o Elastic Agent intentaran ingerir, esto podría dar lugar a la inserción de información confidencial o privada en los registros de Beats o Elastic Agent. Elastic lanzó 8.11.3 y 7.17.16 que evitan este problema al limitar estos tipos de registros al registro de nivel DEBUG, que está deshabilitado de forma predeterminada",
  "details": "Sensitive information logged in github.com/elastic/beats/v7",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "6.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/elastic/beats/v7"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "7.17.16"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/elastic/beats/v7/libbeat/processors/script/javascript",
            "symbols": [
              "jsProcessor.Run",
              "session.runProcessFunc"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-49922"
    },
    {
      "type": "FIX",
      "url": "https://github.com/elastic/beats/commit/9bd7de84ab9c31bb4e1c0a348a7b7c26817a0996"
    },
    {
      "type": "WEB",
      "url": "https://discuss.elastic.co/t/beats-and-elastic-agent-8-11-3-7-17-16-security-update-esa-2023-30/349180"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 3.6
        },
        {
          "source": "bressers@elastic.co",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N",
            "attackVector": "ADJACENT_NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 6.8,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.3,
          "impactScore": 4.0
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-532",
        "name": "Primary",
        "description": "",
        "source": "nvd@nist.gov",
        "url": ""
      },
      {
        "cwe_id": "CWE-532",
        "name": "Secondary",
        "description": "",
        "source": "bressers@elastic.co",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/elastic/beats",
        "name": "elastic/beats",
        "description": ":tropical_fish: Beats - Lightweight shippers for Elasticsearch & Logstash ",
        "date_created": "2014-02-05T19:01:02Z",
        "date_last_push": "2024-06-24T07:51:34Z",
        "owner": "elastic",
        "forks_count": "4885",
        "stars_count": "12041",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:elastic:elastic_beats:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "45E5E452-50F8-4765-BF65-400C6EA1F358",
            "versionStartIncluding": "7.0.0",
            "versionEndExcluding": "7.17.16"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:elastic:elastic_beats:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "FD7E1624-732C-4BEB-B644-051F0A670F18",
            "versionStartIncluding": "8.0.0",
            "versionEndExcluding": "8.11.3"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2023-2413",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}