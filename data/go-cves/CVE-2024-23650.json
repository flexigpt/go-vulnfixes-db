{
  "schema_version": "1.6.3",
  "id": "CVE-2024-23650",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-02-12T18:45:38Z",
  "aliases": [
    "GHSA-9p26-698r-w4hx",
    "GO-2024-2492"
  ],
  "related": [],
  "summary": "Panic in github.com/moby/buildkit. BuildKit is a toolkit for converting source code to build artifacts in an efficient, expressive and repeatable manner. A malicious BuildKit client or frontend could craft a request that could lead to BuildKit daemon crashing with a panic. The issue has been fixed in v0.12.5. As a workaround, avoid using BuildKit frontends from untrusted sources.\n BuildKit es un conjunto de herramientas para convertir código fuente para crear artefactos de manera eficiente, expresiva y repetible. Un cliente o interfaz de BuildKit malicioso podría crear una solicitud que podría provocar que el daemon BuildKit se bloquee en pánico. El problema se solucionó en v0.12.5. Como workaround, evite utilizar interfaces BuildKit de fuentes que no sean de confianza",
  "details": "A malicious BuildKit client or frontend could craft a request that could lead to a BuildKit daemon crashing with a panic",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "5.3"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/moby/buildkit"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.12.5"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/moby/buildkit/solver/llbsolver",
            "symbols": [
              "Solver.Solve",
              "llbBridge.loadResult",
              "loadSourcePolicy"
            ]
          },
          {
            "path": "github.com/moby/buildkit/sourcepolicy",
            "symbols": [
              "match"
            ]
          },
          {
            "path": "github.com/moby/buildkit/control",
            "symbols": [
              "Controller.Solve"
            ]
          },
          {
            "path": "github.com/moby/buildkit/frontend/gateway/client",
            "symbols": [
              "AttestationFromPB"
            ]
          },
          {
            "path": "github.com/moby/buildkit/frontend/gateway",
            "symbols": [
              "llbBridgeForwarder.Solve",
              "llbBridgeForwarder.Warn"
            ]
          },
          {
            "path": "github.com/moby/buildkit/util/tracing/transform",
            "symbols": [
              "Attributes",
              "Spans",
              "arrayValues",
              "boolArray",
              "doubleArray",
              "intArray",
              "links",
              "spanEvents",
              "statusCode",
              "stringArray"
            ]
          },
          {
            "path": "github.com/moby/buildkit/exporter/containerimage/exptypes",
            "symbols": [
              "ParsePlatforms"
            ]
          },
          {
            "path": "github.com/moby/buildkit/exporter/containerimage",
            "symbols": [
              "patchImageConfig"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/moby/buildkit/pull/4601"
    },
    {
      "type": "FIX",
      "url": "https://github.com/moby/buildkit/commit/e1924dc32da35bfb0bfdbb9d0fc7bca25e552330"
    },
    {
      "type": "FIX",
      "url": "https://github.com/moby/buildkit/commit/7718bd5c3dc8fc5cd246a30cc41766e7a53c043c"
    },
    {
      "type": "FIX",
      "url": "https://github.com/moby/buildkit/commit/96663dd35bf3787d7efb1ee7fd9ac7fe533582ae"
    },
    {
      "type": "FIX",
      "url": "https://github.com/moby/buildkit/commit/481d9c45f473c58537f39694a38d7995cc656987"
    },
    {
      "type": "FIX",
      "url": "https://github.com/moby/buildkit/commit/83edaef59d545b93e2750f1f85675a3764593fee"
    },
    {
      "type": "WEB",
      "url": "https://github.com/moby/buildkit/releases/tag/v0.12.5"
    },
    {
      "type": "WEB",
      "url": "https://github.com/moby/buildkit/security/advisories/GHSA-9p26-698r-w4hx"
    }
  ],
  "credits": [
    {
      "name": "@cpuguy83"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "LOW",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "LOW",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 1.4
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-754",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/moby/buildkit",
        "name": "moby/buildkit",
        "description": "concurrent, cache-efficient, and Dockerfile-agnostic builder toolkit",
        "date_created": "2017-05-31T17:04:10Z",
        "date_last_push": "2024-06-14T06:47:13Z",
        "owner": "moby",
        "forks_count": "1082",
        "stars_count": "7783",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/moby/buildkit",
        "name": "moby/buildkit",
        "description": "concurrent, cache-efficient, and Dockerfile-agnostic builder toolkit",
        "date_created": "2017-05-31T17:04:10Z",
        "date_last_push": "2024-06-14T06:47:13Z",
        "owner": "moby",
        "forks_count": "1082",
        "stars_count": "7783",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/moby/buildkit",
        "name": "moby/buildkit",
        "description": "concurrent, cache-efficient, and Dockerfile-agnostic builder toolkit",
        "date_created": "2017-05-31T17:04:10Z",
        "date_last_push": "2024-06-14T06:47:13Z",
        "owner": "moby",
        "forks_count": "1082",
        "stars_count": "7783",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/moby/buildkit",
        "name": "moby/buildkit",
        "description": "concurrent, cache-efficient, and Dockerfile-agnostic builder toolkit",
        "date_created": "2017-05-31T17:04:10Z",
        "date_last_push": "2024-06-14T06:47:13Z",
        "owner": "moby",
        "forks_count": "1082",
        "stars_count": "7783",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/moby/buildkit",
        "name": "moby/buildkit",
        "description": "concurrent, cache-efficient, and Dockerfile-agnostic builder toolkit",
        "date_created": "2017-05-31T17:04:10Z",
        "date_last_push": "2024-06-14T06:47:13Z",
        "owner": "moby",
        "forks_count": "1082",
        "stars_count": "7783",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "0AAE2F08-4E4D-4B85-8230-8D5BA7788D3D",
            "versionEndExcluding": "0.12.5"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2492",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}