{
  "schema_version": "1.6.3",
  "id": "CVE-2024-24765",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2024-03-11T20:09:34Z",
  "aliases": [
    "GHSA-h5gf-cmm8-cg7c",
    "GO-2024-2616"
  ],
  "related": [],
  "summary": "Path traversal and user privilege escalation in github.com/IceWhaleTech/CasaOS-UserService. CasaOS-UserService provides user management functionalities to CasaOS. Prior to version 0.4.7, path filtering of the URL for user avatar image files was not strict, making it possible to get any file on the system. This could allow an unauthorized actor to access, for example, the CasaOS user database, and possibly obtain system root privileges. Version 0.4.7 fixes this issue. CasaOS-UserService proporciona funcionalidades de gestión de usuarios a CasaOS. Antes de la versión 0.4.7, el filtrado de rutas de la URL para los archivos de imágenes de avatar de usuario no era estricto, lo que hacía posible obtener cualquier archivo en el sistema. Esto podría permitir que un actor no autorizado acceda, por ejemplo, a la base de datos de usuarios de CasaOS y posiblemente obtenga privilegios de raíz del sistema. La versión 0.4.7 soluciona este problema",
  "details": "The UserService API contains a path traversal vulnerability that allows an attacker to obtain any file on the system, including the user database and system configuration. This can lead to privilege escalation and compromise of the system",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/IceWhaleTech/CasaOS-UserService"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.4.7"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/IceWhaleTech/CasaOS-UserService/route/v1",
            "symbols": [
              "GetUserImage"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/IceWhaleTech/CasaOS-UserService/security/advisories/GHSA-h5gf-cmm8-cg7c"
    },
    {
      "type": "WEB",
      "url": "https://github.com/IceWhaleTech/CasaOS-UserService/commit/3f4558e23c0a9958f9a0e20aabc64aa8fd51840e"
    },
    {
      "type": "WEB",
      "url": "https://github.com/IceWhaleTech/CasaOS-UserService/releases/tag/v0.4.7"
    }
  ],
  "credits": [
    {
      "name": "Cp0204"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Secondary",
        "description": "CWE-200",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/IceWhaleTech/CasaOS-UserService",
        "name": "IceWhaleTech/CasaOS-UserService",
        "description": "User Service provides user management functionalities to CasaOS.",
        "date_created": "2022-07-22T15:11:34Z",
        "date_last_push": "2024-06-04T02:54:04Z",
        "owner": "IceWhaleTech",
        "forks_count": "8",
        "stars_count": "10",
        "repo_language": "Go"
      }
    ],
    "nodes": [],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2024-2616",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}