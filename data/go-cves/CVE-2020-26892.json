{
  "schema_version": "1.6.3",
  "id": "CVE-2020-26892",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-15T23:29:36Z",
  "aliases": [
    "GHSA-4w5x-x539-ppf5",
    "GO-2022-0380",
    "GHSA-2c64-vj8g-vwrq"
  ],
  "related": [],
  "summary": "Incorrect handling of credential expiry in github.com/nats-io/jwt. The JWT library in NATS nats-server before 2.1.9 has Incorrect Access Control because of how expired credentials are handled. La biblioteca JWT en NATS nats-server versiones anteriores a 2.1.9, presenta un Control de Acceso Incorrecto debido a c√≥mo son manejaban las credenciales expiradas",
  "details": "The AccountClaims.IsRevoked and Export.IsRevoked functions improperly validate expired credentials using the current system time rather than the issue time of the JWT to be tested.\n\nThese functions cannot be used properly. Newer versions of the jwt package provide an IsClaimRevoked method which performs correct validation. In these versions, the IsRevoked method always return true",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "7.5"
    },
    {
      "type": "CVSS_V3",
      "score": "9.8"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/nats-io/jwt"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.1.0"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/nats-io/jwt",
            "symbols": [
              "AccountClaims.IsRevoked",
              "Export.IsRevoked"
            ]
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://advisories.nats.io/CVE/CVE-2020-26892.txt"
    },
    {
      "type": "FIX",
      "url": "https://github.com/nats-io/jwt/commit/e11ce317263cef69619fc1ca743b195d02aa1d8a"
    },
    {
      "type": "WEB",
      "url": "https://github.com/nats-io/nats-server/commits/master"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VT67XCLIIBYRT762SVFBYFFTQFVSM3SI/"
    },
    {
      "type": "WEB",
      "url": "https://www.openwall.com/lists/oss-security/2020/11/02/2"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 7.5
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 10.0,
          "impactScore": 6.4,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-798",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/nats-io/jwt",
        "name": "nats-io/jwt",
        "description": "JWT tokens signed using NKeys for Ed25519 for the NATS ecosystem.",
        "date_created": "2018-08-22T16:25:50Z",
        "date_last_push": "2024-05-09T16:09:54Z",
        "owner": "nats-io",
        "forks_count": "28",
        "stars_count": "71",
        "repo_language": "Go"
      },
      {
        "url": "https://github.com/nats-io/nats-server",
        "name": "nats-io/nats-server",
        "description": "High-Performance server for NATS.io, the cloud and edge native messaging system.",
        "date_created": "2012-10-29T16:12:24Z",
        "date_last_push": "2024-06-14T05:03:28Z",
        "owner": "nats-io",
        "forks_count": "1362",
        "stars_count": "14983",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:linuxfoundation:nats-server:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "B1FA698A-5D09-4B73-B419-D27AE7A1FA5B",
            "versionEndExcluding": "2.1.9"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*",
            "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0380",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}