{
  "schema_version": "1.6.3",
  "id": "CVE-2022-31098",
  "modified": "2022-07-11T13:54:03.967000Z",
  "published": "2022-06-27T22:15:09.180000Z",
  "aliases": [],
  "related": [],
  "summary": "Weave GitOps is a simple open source developer platform for people who want cloud native applications, without needing Kubernetes expertise. A vulnerability in the logging of Weave GitOps could allow an authenticated remote attacker to view sensitive cluster configurations, aka KubeConfg, of registered Kubernetes clusters, including the service account tokens in plain text from Weave GitOps's pod logs on the management cluster. An unauthorized remote attacker can also view these sensitive configurations from external log storage if enabled by the management cluster. This vulnerability is due to the client factory dumping cluster configurations and their service account tokens when the cluster manager tries to connect to an API server of a registered cluster, and a connection error occurs. An attacker could exploit this vulnerability by either accessing logs of a pod of Weave GitOps, or from external log storage and obtaining all cluster configurations of registered clusters. A successful exploit could allow the attacker to use those cluster configurations to manage the registered Kubernetes clusters. This vulnerability has been fixed by commit 567356f471353fb5c676c77f5abc2a04631d50ca. Users should upgrade to Weave GitOps core version v0.8.1-rc.6 or newer. There is no known workaround for this vulnerability. Weave GitOps es una sencilla plataforma de código abierto para desarrolladores que quieren aplicaciones nativas en la nube, sin necesidad de tener conocimientos de Kubernetes. Una vulnerabilidad en el registro de Weave GitOps podría permitir a un atacante remoto autenticado visualizar las configuraciones confidenciales del clúster, también conocido como KubeConfg, de los clústeres Kubernetes registrados, incluyendo los tokens de la cuenta de servicio en texto plano desde los registros de pods de Weave GitOps en el clúster de administración. Un atacante remoto no autorizado también puede visualizar estas configuraciones confidenciales desde el almacenamiento de registros externos si el clúster de administración lo permite. Esta vulnerabilidad es debido a que la fábrica de clientes vuelca las configuraciones del clúster y sus tokens de cuentas de servicio cuando el administrador del clúster intenta conectarse a un servidor API de un clúster registrado, y es producido un error de conexión. Un atacante podría explotar esta vulnerabilidad al acceder a los logs de un pod de Weave GitOps, o desde un almacenamiento de logs externo y obteniendo todas las configuraciones de cluster de los clusters registrados. Una explotación con éxito podría permitir al atacante usar esas configuraciones de clúster para administrar los clústeres Kubernetes registrados. Esta vulnerabilidad ha sido corregida por el commit 567356f471353fb5c676c77f5abc2a04631d50ca. Los usuarios deben actualizar a versión core de Weave GitOps versiones v0.8.1-rc.6 o más reciente. No se conoce ninguna mitigación para esta vulnerabilidad. CWE-532",
  "details": "Weave GitOps is a simple open source developer platform for people who want cloud native applications, without needing Kubernetes expertise. A vulnerability in the logging of Weave GitOps could allow an authenticated remote attacker to view sensitive cluster configurations, aka KubeConfg, of registered Kubernetes clusters, including the service account tokens in plain text from Weave GitOps's pod logs on the management cluster. An unauthorized remote attacker can also view these sensitive configurations from external log storage if enabled by the management cluster. This vulnerability is due to the client factory dumping cluster configurations and their service account tokens when the cluster manager tries to connect to an API server of a registered cluster, and a connection error occurs. An attacker could exploit this vulnerability by either accessing logs of a pod of Weave GitOps, or from external log storage and obtaining all cluster configurations of registered clusters. A successful exploit could allow the attacker to use those cluster configurations to manage the registered Kubernetes clusters. This vulnerability has been fixed by commit 567356f471353fb5c676c77f5abc2a04631d50ca. Users should upgrade to Weave GitOps core version v0.8.1-rc.6 or newer. There is no known workaround for this vulnerability",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "4.3"
    },
    {
      "type": "CVSS_V3",
      "score": "9.0"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "weaveworks/weave-gitops",
        "purl": "https://github.com/weaveworks/weave-gitops"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": []
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/weaveworks/weave-gitops/commit/567356f471353fb5c676c77f5abc2a04631d50ca"
    },
    {
      "type": "WEB",
      "url": "https://github.com/weaveworks/weave-gitops/security/advisories/GHSA-xggc-qprg-x6mw"
    }
  ],
  "credits": [
    {
      "name": "Stefan Prodan",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.0,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 2.3,
          "impactScore": 6.0
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.3
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "CWE-532",
        "name": "Primary",
        "description": "",
        "source": "security-advisories@github.com",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/weaveworks/weave-gitops",
        "name": "weaveworks/weave-gitops",
        "description": "Weave GitOps core",
        "date_created": "2021-02-26 13:58:44",
        "date_last_push": "2022-08-27 23:02:15",
        "owner": "weaveworks",
        "forks_count": "63.0",
        "stars_count": "373.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:weave:weave_gitops:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "53DDEDAD-3D68-43B9-8604-4AE247861015",
            "versionEndExcluding": "0.8.1"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:weave:weave_gitops:0.8.1:rc1:*:*:*:*:*:*",
            "matchCriteriaId": "7D046128-FF45-4245-A062-09F00A62C09B"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:weave:weave_gitops:0.8.1:rc2:*:*:*:*:*:*",
            "matchCriteriaId": "884C62D8-3161-4C42-8C1D-F7CBEFFF95A7"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:weave:weave_gitops:0.8.1:rc3:*:*:*:*:*:*",
            "matchCriteriaId": "CAE586FB-BC82-4EEF-A738-0CECCF151243"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:weave:weave_gitops:0.8.1:rc4:*:*:*:*:*:*",
            "matchCriteriaId": "AF888D0E-B8E2-4D18-B97B-D33EDC018941"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:weave:weave_gitops:0.8.1:rc5:*:*:*:*:*:*",
            "matchCriteriaId": "3D054881-C362-4511-BE51-34393E2A9AD5"
          }
        ]
      }
    ],
    "datasources": {
      "govuln": false,
      "nvd": true,
      "cvefixes": true
    }
  }
}