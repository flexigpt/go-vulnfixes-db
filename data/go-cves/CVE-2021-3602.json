{
  "schema_version": "1.6.3",
  "id": "CVE-2021-3602",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-07-15T23:30:21Z",
  "aliases": [
    "GHSA-7638-r9r3-rmjj",
    "GO-2022-0345"
  ],
  "related": [],
  "summary": "Environment variable leakage in github.com/containers/buildah. An information disclosure flaw was found in Buildah, when building containers using chroot isolation. Running processes in container builds (e.g. Dockerfile RUN commands) can access environment variables from parent and grandparent processes. When run in a container in a CI/CD environment, environment variables may include sensitive information that was shared with the container in order to be used only by Buildah itself (e.g. container registry credentials). Se ha encontrado un fallo de divulgaci贸n de informaci贸n en Buildah, cuando son construidos contenedores usando el aislamiento chroot. Los procesos que son ejecutados en las construcciones de contenedores (por ejemplo, los comandos RUN de Dockerfile) pueden acceder a las variables de entorno de los procesos padres y abuelos. Cuando es ejecutado en un contenedor en un entorno CI/CD, las variables de entorno pueden incluir informaci贸n confidencial que fue compartida con el contenedor para ser usada s贸lo por el propio Buildah (por ejemplo, las credenciales del registro del contenedor). CWE-200",
  "details": "The RunUsingChroot function unintentionally propagates environment variables from the current process to the child process. An information disclosure flaw was found in Buildah, when building containers using chroot isolation. Running processes in container builds (e.g. Dockerfile RUN commands) can access environment variables from parent and grandparent processes. When run in a container in a CI/CD environment, environment variables may include sensitive information that was shared with the container in order to be used only by Buildah itself (e.g. container registry credentials)",
  "severity": [
    {
      "type": "CVSS_V2",
      "score": "1.9"
    },
    {
      "type": "CVSS_V3",
      "score": "5.5"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "containers/buildah",
        "purl": "https://github.com/containers/buildah"
      },
      "severity": [],
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.21.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/containers/buildah/commit/a468ce0ffd347035d53ee0e26c205ef604097fb0"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1969264"
    },
    {
      "type": "WEB",
      "url": "https://github.com/containers/buildah/security/advisories/GHSA-7638-r9r3-rmjj"
    },
    {
      "type": "WEB",
      "url": "https://ubuntu.com/security/CVE-2021-3602"
    }
  ],
  "credits": [
    {
      "name": "Nalin Dahyabhai",
      "type": "REMEDIATION_DEVELOPER"
    }
  ],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 3.6
        }
      ],
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:M/Au:N/C:P/I:N/A:N",
            "accessVector": "LOCAL",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 1.9
          },
          "baseSeverity": "LOW",
          "exploitabilityScore": 3.4,
          "impactScore": 2.9,
          "acInsufInfo": false,
          "obtainAllPrivilege": false,
          "obtainUserPrivilege": false,
          "obtainOtherPrivilege": false,
          "userInteractionRequired": false
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Primary",
        "description": "CWE-212",
        "url": ""
      },
      {
        "cwe_id": "secalert@redhat.com",
        "name": "Secondary",
        "description": "CWE-200",
        "url": ""
      }
    ],
    "repositories": [
      {
        "url": "https://github.com/containers/buildah",
        "name": "containers/buildah",
        "description": "A tool that facilitates building OCI images.",
        "date_created": "2017-01-26 16:59:13",
        "date_last_push": "2022-08-27 12:26:32",
        "owner": "containers",
        "forks_count": "626.0",
        "stars_count": "5600.0",
        "repo_language": "Go"
      }
    ],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:buildah_project:buildah:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "0CE147BD-61D6-43D8-86A8-3C3CB16D200F",
            "versionEndExcluding": "1.16.8"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:buildah_project:buildah:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "F6A83393-DA38-4D39-93E0-D238F6955564",
            "versionStartIncluding": "1.17.0",
            "versionEndExcluding": "1.17.2"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:buildah_project:buildah:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "06B356AF-631F-4568-B0A1-D43673CD212D",
            "versionStartIncluding": "1.19.0",
            "versionEndExcluding": "1.19.9"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:buildah_project:buildah:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "69D2AE6F-D695-4079-82CF-0C9E532484B5",
            "versionStartIncluding": "1.21.0",
            "versionEndExcluding": "1.21.3"
          }
        ]
      },
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems:8.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "87C21FE1-EA5C-498F-9C6C-D05F91A88217"
          },
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian:8.0:*:*:*:*:*:*:*",
            "matchCriteriaId": "47811209-5CE5-4375-8391-B0A7F6A0E420"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-0345",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": true
    }
  }
}