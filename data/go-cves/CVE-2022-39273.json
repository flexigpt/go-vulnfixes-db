{
  "schema_version": "1.6.3",
  "id": "CVE-2022-39273",
  "modified": "2024-05-20T16:03:47Z",
  "published": "2022-10-31T17:09:13Z",
  "aliases": [
    "GO-2022-1043",
    "GHSA-67x4-qr35-qvrm"
  ],
  "related": [],
  "summary": "Hardcoded hashed password in github.com/flyteorg/flyteadmin. FlyteAdmin is the control plane for the data processing platform Flyte. Users who enable the default Flyte’s authorization server without changing the default clientid hashes will be exposed to the public internet. In an effort to make enabling authentication easier for Flyte administrators, the default configuration for Flyte Admin allows access for Flyte Propeller even after turning on authentication via a hardcoded hashed password. This password is also set on the default Flyte Propeller configmap in the various Flyte Helm charts. Users who enable auth but do not override this setting in Flyte Admin’s configuration may unbeknownst to them be allowing public traffic in by way of this default password with attackers effectively impersonating propeller. This only applies to users who have not specified the ExternalAuthorizationServer setting. Usage of an external auth server automatically turns off this default configuration and are not susceptible to this vulnerability. This issue has been addressed in version 1.1.44. Users should manually set the staticClients in the selfAuthServer section of their configuration if they intend to rely on Admin’s internal auth server. Again, users who use an external auth server are automatically protected from this vulnerability. FlyteAdmin es el plano de control de la plataforma de procesamiento de datos Flyte. Los usuarios que habiliten el servidor de autorización de Flyte por defecto sin cambiar los hashes clientid por defecto estarán expuestos a la Internet pública. En un esfuerzo por hacer más fácil la habilitación de la autenticación para los administradores de Flyte, la configuración por defecto para Flyte Admin permite el acceso para Flyte Propeller incluso después de activar la autenticación por medio de una contraseña hash embebida. Esta contraseña también es establecido en el mapa de configuración por defecto de Flyte Propeller en los distintos cuadros de Flyte Helm. Los usuarios que habilitan la autenticación pero no anulan este ajuste en la configuración de Flyte Admin pueden, sin saberlo, estar permitiendo la entrada de tráfico público mediante esta contraseña por defecto con atacantes suplantando efectivamente a Propeller. Esto sólo es aplicado a usuarios que no han especificado la configuración de ExternalAuthorizationServer. El uso de un servidor de autenticación externo desactiva automáticamente esta configuración por defecto y no son susceptibles de esta vulnerabilidad. Este problema ha sido abordado en versión 1.1.44. Los usuarios deben establecer manualmente los staticClients en la sección selfAuthServer de su configuración si pretenden confiar en el servidor de autenticación interno de Admin. De nuevo, los usuarios que usan un servidor de autenticación externo están automáticamente protegidos de esta vulnerabilidad",
  "details": "Default authorization server's configuration settings contain a known hardcoded hashed password.\n\nUsers who enable auth but do not override this setting may unknowingly allow public traffic in by way of this default password with attackers effectively impersonating propeller",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "7.5"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/flyteorg/flyteadmin"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.0.0"
            },
            {
              "fixed": "1.1.44"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "imports": [
          {
            "path": "github.com/flyteorg/flyteadmin/auth/config"
          }
        ]
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/advisories/GHSA-67x4-qr35-qvrm"
    },
    {
      "type": "WEB",
      "url": "https://github.com/flyteorg/flyteadmin/pull/478"
    },
    {
      "type": "WEB",
      "url": "https://docs.flyte.org/en/latest/deployment/cluster_config/auth_setup.html#oauth2-authorization-server"
    },
    {
      "type": "WEB",
      "url": "https://github.com/flyteorg/flyteadmin/security/advisories/GHSA-67x4-qr35-qvrm"
    }
  ],
  "credits": [],
  "database_specific": {
    "metrics": {
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 3.6
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 4.8,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.2,
          "impactScore": 2.5
        }
      ]
    },
    "cwe_details": [
      {
        "cwe_id": "security-advisories@github.com",
        "name": "Primary",
        "description": "CWE-798",
        "url": ""
      },
      {
        "cwe_id": "nvd@nist.gov",
        "name": "Secondary",
        "description": "NVD-CWE-noinfo",
        "url": ""
      }
    ],
    "repositories": [],
    "nodes": [
      {
        "operator": "OR",
        "negate": false,
        "cpeMatch": [
          {
            "vulnerable": true,
            "criteria": "cpe:2.3:a:flyte:flyteadmin:*:*:*:*:*:*:*:*",
            "matchCriteriaId": "D6C9DF17-FAEE-4B41-8305-F2E15C61D678",
            "versionEndExcluding": "1.1.44"
          }
        ]
      }
    ],
    "vulndb_data": {
      "url": "https://pkg.go.dev/vuln/GO-2022-1043",
      "review_status": "REVIEWED"
    },
    "datasources": {
      "govuln": true,
      "nvd": true,
      "cvefixes": false
    }
  }
}